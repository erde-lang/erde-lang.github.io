/*! For license information please see 308.661c3317.js.LICENSE.txt */
(self.webpackChunkerde_lang_github_io=self.webpackChunkerde_lang_github_io||[]).push([[308],{5007:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}}function f(e){return function t(){for(var n=this,r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return a.length>=e.length?e.apply(this,a):function(){for(var e=arguments.length,r=new Array(e),u=0;u<e;u++)r[u]=arguments[u];return t.apply(n,[].concat(a,r))}}}function _(e){return{}.toString.call(e).includes("Object")}function p(e){return"function"==typeof e}n.d(t,{ZP:function(){return fe}});var d=f((function(e,t){throw new Error(e[t]||e.default)}))({initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"}),h={changes:function(e,t){return _(t)||d("changeType"),Object.keys(t).some((function(t){return n=e,r=t,!Object.prototype.hasOwnProperty.call(n,r);var n,r}))&&d("changeField"),t},selector:function(e){p(e)||d("selectorType")},handler:function(e){p(e)||_(e)||d("handlerType"),_(e)&&Object.values(e).some((function(e){return!p(e)}))&&d("handlersType")},initial:function(e){var t;e||d("initialIsRequired"),_(e)||d("initialType"),t=e,Object.keys(t).length||d("initialContent")}};function L(e,t){return p(t)?t(e.current):t}function g(e,t){return e.current=i(i({},e.current),t),t}function A(e,t,n){return p(t)?t(e.current):Object.keys(n).forEach((function(n){var r;return null===(r=t[n])||void 0===r?void 0:r.call(t,e.current[n])})),n}var T={create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h.initial(e),h.handler(t);var n={current:e},r=f(A)(n,t),a=f(g)(n),u=f(h.changes)(e),l=f(L)(n);function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e};return h.selector(e),e(n.current)}function o(e){c(r,a,u,l)(e)}return[s,o]}},b=T,x={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.28.1/min/vs"}};var O=function(e){return function t(){for(var n=this,r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return a.length>=e.length?e.apply(this,a):function(){for(var e=arguments.length,r=new Array(e),u=0;u<e;u++)r[u]=arguments[u];return t.apply(n,[].concat(a,r))}}};var k=function(e){return{}.toString.call(e).includes("Object")};var v={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:"Deprecation warning!\n    You are using deprecated way of configuration.\n\n    Instead of using\n      monaco.config({ urls: { monacoBase: '...' } })\n    use\n      monaco.config({ paths: { vs: '...' } })\n\n    For more please check the link https://github.com/suren-atoyan/monaco-loader#config\n  "},E=O((function(e,t){throw new Error(e[t]||e.default)}))(v),m={config:function(e){return e||E("configIsRequired"),k(e)||E("configType"),e.urls?(console.warn(v.deprecation),{paths:{vs:e.urls.monacoBase}}):e}},R=m,U=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduceRight((function(e,t){return t(e)}),e)}};var N=function e(t,n){return Object.keys(n).forEach((function(r){n[r]instanceof Object&&t[r]&&Object.assign(n[r],e(t[r],n[r]))})),u(u({},t),n)},w={type:"cancelation",msg:"operation is manually canceled"};var S,y,I=function(e){var t=!1,n=new Promise((function(n,r){e.then((function(e){return t?r(w):n(e)})),e.catch(r)}));return n.cancel=function(){return t=!0},n},M=b.create({config:x,isInitialized:!1,resolve:null,reject:null,monaco:null}),P=(y=2,function(e){if(Array.isArray(e))return e}(S=M)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,u=void 0;try{for(var l,s=e[Symbol.iterator]();!(r=(l=s.next()).done)&&(n.push(l.value),!t||n.length!==t);r=!0);}catch(o){a=!0,u=o}finally{try{r||null==s.return||s.return()}finally{if(a)throw u}}return n}}(S,y)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(S,y)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),C=P[0],D=P[1];function V(e){return document.body.appendChild(e)}function B(e){var t,n,r=C((function(e){return{config:e.config,reject:e.reject}})),a=(t="".concat(r.config.paths.vs,"/loader.js"),n=document.createElement("script"),t&&(n.src=t),n);return a.onload=function(){return e()},a.onerror=r.reject,a}function G(){var e=C((function(e){return{config:e.config,resolve:e.resolve,reject:e.reject}})),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],(function(t){K(t),e.resolve(t)}),(function(t){e.reject(t)}))}function K(e){C().monaco||D({monaco:e})}var j=new Promise((function(e,t){return D({resolve:e,reject:t})})),F={config:function(e){D((function(t){return{config:N(t.config,R.config(e))}}))},init:function(){if(!C((function(e){return{isInitialized:e.isInitialized}})).isInitialized){if(window.monaco&&window.monaco.editor)return K(window.monaco),I(Promise.resolve(window.monaco));U(V,B)(G),D({isInitialized:!0})}return I(j)},__getMonacoInstance:function(){return C((function(e){return e.monaco}))}},H=F,X=n(7294),z=n(5697),Y=n.n(z);function J(){return J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},J.apply(this,arguments)}const q={display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"};var Z=function({content:e}){return X.createElement("div",{style:q},e)};var W={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}};function Q({width:e,height:t,isEditorReady:n,loading:r,_ref:a,className:u,wrapperProps:l}){return X.createElement("section",J({style:{...W.wrapper,width:e,height:t}},l),!n&&X.createElement(Z,{content:r}),X.createElement("div",{ref:a,style:{...W.fullWidth,...!n&&W.hide},className:u}))}Q.propTypes={width:Y().oneOfType([Y().number,Y().string]).isRequired,height:Y().oneOfType([Y().number,Y().string]).isRequired,loading:Y().oneOfType([Y().element,Y().string]).isRequired,isEditorReady:Y().bool.isRequired,className:Y().string,wrapperProps:Y().object};var $=Q,ee=(0,X.memo)($);var te=function(e){(0,X.useEffect)(e,[])};var ne=function(e,t,n=!0){const r=(0,X.useRef)(!0);(0,X.useEffect)(r.current||!n?()=>{r.current=!1}:e,t)};function re(){}function ae(e,t,n,r){return function(e,t){return e.editor.getModel(ue(e,t))}(e,r)||function(e,t,n,r){return e.editor.createModel(t,n,r&&ue(e,r))}(e,t,n,r)}function ue(e,t){return e.Uri.parse(t)}function le({original:e,modified:t,language:n,originalLanguage:r,modifiedLanguage:a,originalModelPath:u,modifiedModelPath:l,keepCurrentOriginalModel:s,keepCurrentModifiedModel:o,theme:i,loading:c,options:f,height:_,width:p,className:d,wrapperProps:h,beforeMount:L,onMount:g}){const[A,T]=(0,X.useState)(!1),[b,x]=(0,X.useState)(!0),O=(0,X.useRef)(null),k=(0,X.useRef)(null),v=(0,X.useRef)(null),E=(0,X.useRef)(g),m=(0,X.useRef)(L);te((()=>{const e=H.init();return e.then((e=>(k.current=e)&&x(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>O.current?function(){const e=O.current.getModel();var t,n;s||null===(t=e.original)||void 0===t||t.dispose();o||null===(n=e.modified)||void 0===n||n.dispose();O.current.dispose()}():e.cancel()})),ne((()=>{const e=O.current.getModifiedEditor();e.getOption(k.current.editor.EditorOption.readOnly)?e.setValue(t):t!==e.getValue()&&(e.executeEdits("",[{range:e.getModel().getFullModelRange(),text:t,forceMoveMarkers:!0}]),e.pushUndoStop())}),[t],A),ne((()=>{O.current.getModel().original.setValue(e)}),[e],A),ne((()=>{const{original:e,modified:t}=O.current.getModel();k.current.editor.setModelLanguage(e,r||n),k.current.editor.setModelLanguage(t,a||n)}),[n,r,a],A),ne((()=>{k.current.editor.setTheme(i)}),[i],A),ne((()=>{O.current.updateOptions(f)}),[f],A);const R=(0,X.useCallback)((()=>{m.current(k.current);const s=ae(k.current,e,r||n,u),o=ae(k.current,t,a||n,l);O.current.setModel({original:s,modified:o})}),[n,t,a,e,r,u,l]),U=(0,X.useCallback)((()=>{O.current=k.current.editor.createDiffEditor(v.current,{automaticLayout:!0,...f}),R(),k.current.editor.setTheme(i),T(!0)}),[f,i,R]);return(0,X.useEffect)((()=>{A&&E.current(O.current,k.current)}),[A]),(0,X.useEffect)((()=>{!b&&!A&&U()}),[b,A,U]),X.createElement(ee,{width:p,height:_,isEditorReady:A,loading:c,_ref:v,className:d,wrapperProps:h})}le.propTypes={original:Y().string,modified:Y().string,language:Y().string,originalLanguage:Y().string,modifiedLanguage:Y().string,originalModelPath:Y().string,modifiedModelPath:Y().string,keepCurrentOriginalModel:Y().bool,keepCurrentModifiedModel:Y().bool,theme:Y().string,loading:Y().oneOfType([Y().element,Y().string]),options:Y().object,width:Y().oneOfType([Y().number,Y().string]),height:Y().oneOfType([Y().number,Y().string]),className:Y().string,wrapperProps:Y().object,beforeMount:Y().func,onMount:Y().func},le.defaultProps={theme:"light",loading:"Loading...",options:{},keepCurrentOriginalModel:!1,keepCurrentModifiedModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:re,onMount:re};var se=function(e){const t=(0,X.useRef)();return(0,X.useEffect)((()=>{t.current=e}),[e]),t.current};const oe=new Map;function ie({defaultValue:e,defaultLanguage:t,defaultPath:n,value:r,language:a,path:u,theme:l,line:s,loading:o,options:i,overrideServices:c,saveViewState:f,keepCurrentModel:_,width:p,height:d,className:h,wrapperProps:L,beforeMount:g,onMount:A,onChange:T,onValidate:b}){const[x,O]=(0,X.useState)(!1),[k,v]=(0,X.useState)(!0),E=(0,X.useRef)(null),m=(0,X.useRef)(null),R=(0,X.useRef)(null),U=(0,X.useRef)(A),N=(0,X.useRef)(g),w=(0,X.useRef)(null),S=(0,X.useRef)(r),y=se(u);te((()=>{const e=H.init();return e.then((e=>(E.current=e)&&v(!1))).catch((e=>"cancelation"!==(null==e?void 0:e.type)&&console.error("Monaco initialization: error:",e))),()=>m.current?function(){var e,t;null===(e=w.current)||void 0===e||e.dispose(),_?f&&oe.set(u,m.current.saveViewState()):null===(t=m.current.getModel())||void 0===t||t.dispose();m.current.dispose()}():e.cancel()})),ne((()=>{const n=ae(E.current,e||r,t||a,u);n!==m.current.getModel()&&(f&&oe.set(y,m.current.saveViewState()),m.current.setModel(n),f&&m.current.restoreViewState(oe.get(u)))}),[u],x),ne((()=>{m.current.updateOptions(i)}),[i],x),ne((()=>{m.current.getOption(E.current.editor.EditorOption.readOnly)?m.current.setValue(r):r!==m.current.getValue()&&(m.current.executeEdits("",[{range:m.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),m.current.pushUndoStop())}),[r],x),ne((()=>{E.current.editor.setModelLanguage(m.current.getModel(),a)}),[a],x),ne((()=>{void 0!==s&&m.current.revealLine(s)}),[s],x),ne((()=>{E.current.editor.setTheme(l)}),[l],x);const I=(0,X.useCallback)((()=>{N.current(E.current);const s=u||n,o=ae(E.current,r||e,t||a,s);m.current=E.current.editor.create(R.current,{model:o,automaticLayout:!0,...i},c),f&&m.current.restoreViewState(oe.get(s)),E.current.editor.setTheme(l),O(!0)}),[e,t,n,r,a,u,i,c,f,l]);return(0,X.useEffect)((()=>{x&&U.current(m.current,E.current)}),[x]),(0,X.useEffect)((()=>{!k&&!x&&I()}),[k,x,I]),S.current=r,(0,X.useEffect)((()=>{var e,t;x&&T&&(null===(e=w.current)||void 0===e||e.dispose(),w.current=null===(t=m.current)||void 0===t?void 0:t.onDidChangeModelContent((e=>{const t=m.current.getValue();S.current!==t&&T(t,e)})))}),[x,T]),(0,X.useEffect)((()=>{if(x){const e=E.current.editor.onDidChangeMarkers((e=>{var t;const n=null===(t=m.current.getModel())||void 0===t?void 0:t.uri;if(n){if(e.find((e=>e.path===n.path))){const e=E.current.editor.getModelMarkers({resource:n});null==b||b(e)}}}));return()=>{null==e||e.dispose()}}}),[x,b]),X.createElement(ee,{width:p,height:d,isEditorReady:x,loading:o,_ref:R,className:h,wrapperProps:L})}ie.propTypes={defaultValue:Y().string,defaultPath:Y().string,defaultLanguage:Y().string,value:Y().string,language:Y().string,path:Y().string,theme:Y().string,line:Y().number,loading:Y().oneOfType([Y().element,Y().string]),options:Y().object,overrideServices:Y().object,saveViewState:Y().bool,keepCurrentModel:Y().bool,width:Y().oneOfType([Y().number,Y().string]),height:Y().oneOfType([Y().number,Y().string]),className:Y().string,wrapperProps:Y().object,beforeMount:Y().func,onMount:Y().func,onChange:Y().func,onValidate:Y().func},ie.defaultProps={theme:"light",loading:"Loading...",options:{},overrideServices:{},saveViewState:!0,keepCurrentModel:!1,width:"100%",height:"100%",wrapperProps:{},beforeMount:re,onMount:re,onValidate:re};var ce=ie,fe=(0,X.memo)(ce)},3163:function(e){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=34)}([function(e,t,n){"use strict";const r=n(5);e.exports.FENGARI_AUTHORS=r.FENGARI_AUTHORS,e.exports.FENGARI_COPYRIGHT=r.FENGARI_COPYRIGHT,e.exports.FENGARI_RELEASE=r.FENGARI_RELEASE,e.exports.FENGARI_VERSION=r.FENGARI_VERSION,e.exports.FENGARI_VERSION_MAJOR=r.FENGARI_VERSION_MAJOR,e.exports.FENGARI_VERSION_MINOR=r.FENGARI_VERSION_MINOR,e.exports.FENGARI_VERSION_NUM=r.FENGARI_VERSION_NUM,e.exports.FENGARI_VERSION_RELEASE=r.FENGARI_VERSION_RELEASE,e.exports.luastring_eq=r.luastring_eq,e.exports.luastring_indexOf=r.luastring_indexOf,e.exports.luastring_of=r.luastring_of,e.exports.to_jsstring=r.to_jsstring,e.exports.to_luastring=r.to_luastring,e.exports.to_uristring=r.to_uristring;const a=n(3),u=n(2),l=n(7),s=n(17);e.exports.luaconf=a,e.exports.lua=u,e.exports.lauxlib=l,e.exports.lualib=s},function(e,t,n){"use strict";let r,a,u;if(r="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):function(e){let t=0,n=e.length,r=new Uint8Array(n);for(;n>t;)r[t]=e[t++];return r},"function"==typeof(new Uint8Array).indexOf)a=function(e,t,n){return e.indexOf(t,n)};else{let e=[].indexOf;if(0!==e.call(new Uint8Array(1),0))throw Error("missing .indexOf");a=function(t,n,r){return e.call(t,n,r)}}u="function"==typeof Uint8Array.of?Uint8Array.of.bind(Uint8Array):function(){return r(arguments)};const l=function(e){return e instanceof Uint8Array},s="cannot convert invalid utf8 to javascript string",o=";,/?:@&=+$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789,-_.!~*'()#".split("").reduce((function(e,t){return e[t.charCodeAt(0)]=!0,e}),{}),i={},c=function(e,t){if("string"!=typeof e)throw new TypeError("to_luastring expects a javascript string");if(t){let t=i[e];if(l(t))return t}let n=e.length,a=Array(n),u=0;for(let r=0;r<n;++r){let t=e.charCodeAt(r);if(t<=127)a[u++]=t;else if(t<=2047)a[u++]=192|t>>6,a[u++]=128|63&t;else{if(t>=55296&&t<=56319&&r+1<n){let n=e.charCodeAt(r+1);n>=56320&&n<=57343&&(r++,t=1024*(t-55296)+n+9216)}t<=65535?(a[u++]=224|t>>12,a[u++]=128|t>>6&63,a[u++]=128|63&t):(a[u++]=240|t>>18,a[u++]=128|t>>12&63,a[u++]=128|t>>6&63,a[u++]=128|63&t)}}return a=r(a),t&&(i[e]=a),a};e.exports.luastring_from=r,e.exports.luastring_indexOf=a,e.exports.luastring_of=u,e.exports.is_luastring=l,e.exports.luastring_eq=function(e,t){if(e!==t){let n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1}return!0},e.exports.to_jsstring=function(e,t,n,r){if(!l(e))throw new TypeError("to_jsstring expects a Uint8Array");n=void 0===n?e.length:Math.min(e.length,n);let a="";for(let u=void 0!==t?t:0;u<n;){let t=e[u++];if(t<128)a+=String.fromCharCode(t);else if(t<194||t>244){if(!r)throw RangeError(s);a+="\ufffd"}else if(t<=223){if(u>=n){if(!r)throw RangeError(s);a+="\ufffd";continue}let l=e[u++];if(128!=(192&l)){if(!r)throw RangeError(s);a+="\ufffd";continue}a+=String.fromCharCode(((31&t)<<6)+(63&l))}else if(t<=239){if(u+1>=n){if(!r)throw RangeError(s);a+="\ufffd";continue}let l=e[u++];if(128!=(192&l)){if(!r)throw RangeError(s);a+="\ufffd";continue}let o=e[u++];if(128!=(192&o)){if(!r)throw RangeError(s);a+="\ufffd";continue}let i=((15&t)<<12)+((63&l)<<6)+(63&o);if(i<=65535)a+=String.fromCharCode(i);else{let e=55296+((i-=65536)>>10),t=i%1024+56320;a+=String.fromCharCode(e,t)}}else{if(u+2>=n){if(!r)throw RangeError(s);a+="\ufffd";continue}let l=e[u++];if(128!=(192&l)){if(!r)throw RangeError(s);a+="\ufffd";continue}let o=e[u++];if(128!=(192&o)){if(!r)throw RangeError(s);a+="\ufffd";continue}let i=e[u++];if(128!=(192&i)){if(!r)throw RangeError(s);a+="\ufffd";continue}let c=((7&t)<<18)+((63&l)<<12)+((63&o)<<6)+(63&i),f=55296+((c-=65536)>>10),_=c%1024+56320;a+=String.fromCharCode(f,_)}}return a},e.exports.to_uristring=function(e){if(!l(e))throw new TypeError("to_uristring expects a Uint8Array");let t="";for(let n=0;n<e.length;n++){let r=e[n];o[r]?t+=String.fromCharCode(r):t+="%"+(r<16?"0":"")+r.toString(16)}return t},e.exports.to_luastring=c,e.exports.from_userstring=function(e){if(!l(e)){if("string"!=typeof e)throw new TypeError("expects an array of bytes or javascript string");e=c(e)}return e};const f=c("\x1bLua");e.exports.LUA_SIGNATURE=f,e.exports.LUA_VERSION_MAJOR="5",e.exports.LUA_VERSION_MINOR="3",e.exports.LUA_VERSION_NUM=503,e.exports.LUA_VERSION_RELEASE="4",e.exports.LUA_VERSION="Lua 5.3",e.exports.LUA_RELEASE="Lua 5.3.4",e.exports.LUA_COPYRIGHT="Lua 5.3.4  Copyright (C) 1994-2017 Lua.org, PUC-Rio",e.exports.LUA_AUTHORS="R. Ierusalimschy, L. H. de Figueiredo, W. Celes";const _={LUA_TNONE:-1,LUA_TNIL:0,LUA_TBOOLEAN:1,LUA_TLIGHTUSERDATA:2,LUA_TNUMBER:3,LUA_TSTRING:4,LUA_TTABLE:5,LUA_TFUNCTION:6,LUA_TUSERDATA:7,LUA_TTHREAD:8,LUA_NUMTAGS:9};_.LUA_TSHRSTR=0|_.LUA_TSTRING,_.LUA_TLNGSTR=16|_.LUA_TSTRING,_.LUA_TNUMFLT=0|_.LUA_TNUMBER,_.LUA_TNUMINT=16|_.LUA_TNUMBER,_.LUA_TLCL=0|_.LUA_TFUNCTION,_.LUA_TLCF=16|_.LUA_TFUNCTION,_.LUA_TCCL=32|_.LUA_TFUNCTION;const{LUAI_MAXSTACK:p}=n(3),d=-p-1e3;e.exports.LUA_HOOKCALL=0,e.exports.LUA_HOOKCOUNT=3,e.exports.LUA_HOOKLINE=2,e.exports.LUA_HOOKRET=1,e.exports.LUA_HOOKTAILCALL=4,e.exports.LUA_MASKCALL=1,e.exports.LUA_MASKCOUNT=8,e.exports.LUA_MASKLINE=4,e.exports.LUA_MASKRET=2,e.exports.LUA_MINSTACK=20,e.exports.LUA_MULTRET=-1,e.exports.LUA_OPADD=0,e.exports.LUA_OPBAND=7,e.exports.LUA_OPBNOT=13,e.exports.LUA_OPBOR=8,e.exports.LUA_OPBXOR=9,e.exports.LUA_OPDIV=5,e.exports.LUA_OPEQ=0,e.exports.LUA_OPIDIV=6,e.exports.LUA_OPLE=2,e.exports.LUA_OPLT=1,e.exports.LUA_OPMOD=3,e.exports.LUA_OPMUL=2,e.exports.LUA_OPPOW=4,e.exports.LUA_OPSHL=10,e.exports.LUA_OPSHR=11,e.exports.LUA_OPSUB=1,e.exports.LUA_OPUNM=12,e.exports.LUA_REGISTRYINDEX=d,e.exports.LUA_RIDX_GLOBALS=2,e.exports.LUA_RIDX_LAST=2,e.exports.LUA_RIDX_MAINTHREAD=1,e.exports.constant_types=_,e.exports.lua_Debug=class{constructor(){this.event=NaN,this.name=null,this.namewhat=null,this.what=null,this.source=null,this.currentline=NaN,this.linedefined=NaN,this.lastlinedefined=NaN,this.nups=NaN,this.nparams=NaN,this.isvararg=NaN,this.istailcall=NaN,this.short_src=null,this.i_ci=null}},e.exports.lua_upvalueindex=function(e){return d-e},e.exports.thread_status={LUA_OK:0,LUA_YIELD:1,LUA_ERRRUN:2,LUA_ERRSYNTAX:3,LUA_ERRMEM:4,LUA_ERRGCMM:5,LUA_ERRERR:6}},function(e,t,n){"use strict";const r=n(1),a=n(18),u=n(11),l=n(8),s=n(12);e.exports.LUA_AUTHORS=r.LUA_AUTHORS,e.exports.LUA_COPYRIGHT=r.LUA_COPYRIGHT,e.exports.LUA_ERRERR=r.thread_status.LUA_ERRERR,e.exports.LUA_ERRGCMM=r.thread_status.LUA_ERRGCMM,e.exports.LUA_ERRMEM=r.thread_status.LUA_ERRMEM,e.exports.LUA_ERRRUN=r.thread_status.LUA_ERRRUN,e.exports.LUA_ERRSYNTAX=r.thread_status.LUA_ERRSYNTAX,e.exports.LUA_HOOKCALL=r.LUA_HOOKCALL,e.exports.LUA_HOOKCOUNT=r.LUA_HOOKCOUNT,e.exports.LUA_HOOKLINE=r.LUA_HOOKLINE,e.exports.LUA_HOOKRET=r.LUA_HOOKRET,e.exports.LUA_HOOKTAILCALL=r.LUA_HOOKTAILCALL,e.exports.LUA_MASKCALL=r.LUA_MASKCALL,e.exports.LUA_MASKCOUNT=r.LUA_MASKCOUNT,e.exports.LUA_MASKLINE=r.LUA_MASKLINE,e.exports.LUA_MASKRET=r.LUA_MASKRET,e.exports.LUA_MINSTACK=r.LUA_MINSTACK,e.exports.LUA_MULTRET=r.LUA_MULTRET,e.exports.LUA_NUMTAGS=r.constant_types.LUA_NUMTAGS,e.exports.LUA_OK=r.thread_status.LUA_OK,e.exports.LUA_OPADD=r.LUA_OPADD,e.exports.LUA_OPBAND=r.LUA_OPBAND,e.exports.LUA_OPBNOT=r.LUA_OPBNOT,e.exports.LUA_OPBOR=r.LUA_OPBOR,e.exports.LUA_OPBXOR=r.LUA_OPBXOR,e.exports.LUA_OPDIV=r.LUA_OPDIV,e.exports.LUA_OPEQ=r.LUA_OPEQ,e.exports.LUA_OPIDIV=r.LUA_OPIDIV,e.exports.LUA_OPLE=r.LUA_OPLE,e.exports.LUA_OPLT=r.LUA_OPLT,e.exports.LUA_OPMOD=r.LUA_OPMOD,e.exports.LUA_OPMUL=r.LUA_OPMUL,e.exports.LUA_OPPOW=r.LUA_OPPOW,e.exports.LUA_OPSHL=r.LUA_OPSHL,e.exports.LUA_OPSHR=r.LUA_OPSHR,e.exports.LUA_OPSUB=r.LUA_OPSUB,e.exports.LUA_OPUNM=r.LUA_OPUNM,e.exports.LUA_REGISTRYINDEX=r.LUA_REGISTRYINDEX,e.exports.LUA_RELEASE=r.LUA_RELEASE,e.exports.LUA_RIDX_GLOBALS=r.LUA_RIDX_GLOBALS,e.exports.LUA_RIDX_LAST=r.LUA_RIDX_LAST,e.exports.LUA_RIDX_MAINTHREAD=r.LUA_RIDX_MAINTHREAD,e.exports.LUA_SIGNATURE=r.LUA_SIGNATURE,e.exports.LUA_TNONE=r.constant_types.LUA_TNONE,e.exports.LUA_TNIL=r.constant_types.LUA_TNIL,e.exports.LUA_TBOOLEAN=r.constant_types.LUA_TBOOLEAN,e.exports.LUA_TLIGHTUSERDATA=r.constant_types.LUA_TLIGHTUSERDATA,e.exports.LUA_TNUMBER=r.constant_types.LUA_TNUMBER,e.exports.LUA_TSTRING=r.constant_types.LUA_TSTRING,e.exports.LUA_TTABLE=r.constant_types.LUA_TTABLE,e.exports.LUA_TFUNCTION=r.constant_types.LUA_TFUNCTION,e.exports.LUA_TUSERDATA=r.constant_types.LUA_TUSERDATA,e.exports.LUA_TTHREAD=r.constant_types.LUA_TTHREAD,e.exports.LUA_VERSION=r.LUA_VERSION,e.exports.LUA_VERSION_MAJOR=r.LUA_VERSION_MAJOR,e.exports.LUA_VERSION_MINOR=r.LUA_VERSION_MINOR,e.exports.LUA_VERSION_NUM=r.LUA_VERSION_NUM,e.exports.LUA_VERSION_RELEASE=r.LUA_VERSION_RELEASE,e.exports.LUA_YIELD=r.thread_status.LUA_YIELD,e.exports.lua_Debug=r.lua_Debug,e.exports.lua_upvalueindex=r.lua_upvalueindex,e.exports.lua_absindex=a.lua_absindex,e.exports.lua_arith=a.lua_arith,e.exports.lua_atpanic=a.lua_atpanic,e.exports.lua_atnativeerror=a.lua_atnativeerror,e.exports.lua_call=a.lua_call,e.exports.lua_callk=a.lua_callk,e.exports.lua_checkstack=a.lua_checkstack,e.exports.lua_close=s.lua_close,e.exports.lua_compare=a.lua_compare,e.exports.lua_concat=a.lua_concat,e.exports.lua_copy=a.lua_copy,e.exports.lua_createtable=a.lua_createtable,e.exports.lua_dump=a.lua_dump,e.exports.lua_error=a.lua_error,e.exports.lua_gc=a.lua_gc,e.exports.lua_getallocf=a.lua_getallocf,e.exports.lua_getextraspace=a.lua_getextraspace,e.exports.lua_getfield=a.lua_getfield,e.exports.lua_getglobal=a.lua_getglobal,e.exports.lua_gethook=u.lua_gethook,e.exports.lua_gethookcount=u.lua_gethookcount,e.exports.lua_gethookmask=u.lua_gethookmask,e.exports.lua_geti=a.lua_geti,e.exports.lua_getinfo=u.lua_getinfo,e.exports.lua_getlocal=u.lua_getlocal,e.exports.lua_getmetatable=a.lua_getmetatable,e.exports.lua_getstack=u.lua_getstack,e.exports.lua_gettable=a.lua_gettable,e.exports.lua_gettop=a.lua_gettop,e.exports.lua_getupvalue=a.lua_getupvalue,e.exports.lua_getuservalue=a.lua_getuservalue,e.exports.lua_insert=a.lua_insert,e.exports.lua_isboolean=a.lua_isboolean,e.exports.lua_iscfunction=a.lua_iscfunction,e.exports.lua_isfunction=a.lua_isfunction,e.exports.lua_isinteger=a.lua_isinteger,e.exports.lua_islightuserdata=a.lua_islightuserdata,e.exports.lua_isnil=a.lua_isnil,e.exports.lua_isnone=a.lua_isnone,e.exports.lua_isnoneornil=a.lua_isnoneornil,e.exports.lua_isnumber=a.lua_isnumber,e.exports.lua_isproxy=a.lua_isproxy,e.exports.lua_isstring=a.lua_isstring,e.exports.lua_istable=a.lua_istable,e.exports.lua_isthread=a.lua_isthread,e.exports.lua_isuserdata=a.lua_isuserdata,e.exports.lua_isyieldable=l.lua_isyieldable,e.exports.lua_len=a.lua_len,e.exports.lua_load=a.lua_load,e.exports.lua_newstate=s.lua_newstate,e.exports.lua_newtable=a.lua_newtable,e.exports.lua_newthread=s.lua_newthread,e.exports.lua_newuserdata=a.lua_newuserdata,e.exports.lua_next=a.lua_next,e.exports.lua_pcall=a.lua_pcall,e.exports.lua_pcallk=a.lua_pcallk,e.exports.lua_pop=a.lua_pop,e.exports.lua_pushboolean=a.lua_pushboolean,e.exports.lua_pushcclosure=a.lua_pushcclosure,e.exports.lua_pushcfunction=a.lua_pushcfunction,e.exports.lua_pushfstring=a.lua_pushfstring,e.exports.lua_pushglobaltable=a.lua_pushglobaltable,e.exports.lua_pushinteger=a.lua_pushinteger,e.exports.lua_pushjsclosure=a.lua_pushjsclosure,e.exports.lua_pushjsfunction=a.lua_pushjsfunction,e.exports.lua_pushlightuserdata=a.lua_pushlightuserdata,e.exports.lua_pushliteral=a.lua_pushliteral,e.exports.lua_pushlstring=a.lua_pushlstring,e.exports.lua_pushnil=a.lua_pushnil,e.exports.lua_pushnumber=a.lua_pushnumber,e.exports.lua_pushstring=a.lua_pushstring,e.exports.lua_pushthread=a.lua_pushthread,e.exports.lua_pushvalue=a.lua_pushvalue,e.exports.lua_pushvfstring=a.lua_pushvfstring,e.exports.lua_rawequal=a.lua_rawequal,e.exports.lua_rawget=a.lua_rawget,e.exports.lua_rawgeti=a.lua_rawgeti,e.exports.lua_rawgetp=a.lua_rawgetp,e.exports.lua_rawlen=a.lua_rawlen,e.exports.lua_rawset=a.lua_rawset,e.exports.lua_rawseti=a.lua_rawseti,e.exports.lua_rawsetp=a.lua_rawsetp,e.exports.lua_register=a.lua_register,e.exports.lua_remove=a.lua_remove,e.exports.lua_replace=a.lua_replace,e.exports.lua_resume=l.lua_resume,e.exports.lua_rotate=a.lua_rotate,e.exports.lua_setallof=l.lua_setallof,e.exports.lua_setfield=a.lua_setfield,e.exports.lua_setglobal=a.lua_setglobal,e.exports.lua_sethook=u.lua_sethook,e.exports.lua_seti=a.lua_seti,e.exports.lua_setlocal=u.lua_setlocal,e.exports.lua_setmetatable=a.lua_setmetatable,e.exports.lua_settable=a.lua_settable,e.exports.lua_settop=a.lua_settop,e.exports.lua_setupvalue=a.lua_setupvalue,e.exports.lua_setuservalue=a.lua_setuservalue,e.exports.lua_status=a.lua_status,e.exports.lua_stringtonumber=a.lua_stringtonumber,e.exports.lua_toboolean=a.lua_toboolean,e.exports.lua_todataview=a.lua_todataview,e.exports.lua_tointeger=a.lua_tointeger,e.exports.lua_tointegerx=a.lua_tointegerx,e.exports.lua_tojsstring=a.lua_tojsstring,e.exports.lua_tolstring=a.lua_tolstring,e.exports.lua_tonumber=a.lua_tonumber,e.exports.lua_tonumberx=a.lua_tonumberx,e.exports.lua_topointer=a.lua_topointer,e.exports.lua_toproxy=a.lua_toproxy,e.exports.lua_tostring=a.lua_tostring,e.exports.lua_tothread=a.lua_tothread,e.exports.lua_touserdata=a.lua_touserdata,e.exports.lua_type=a.lua_type,e.exports.lua_typename=a.lua_typename,e.exports.lua_upvalueid=a.lua_upvalueid,e.exports.lua_upvaluejoin=a.lua_upvaluejoin,e.exports.lua_version=a.lua_version,e.exports.lua_xmove=a.lua_xmove,e.exports.lua_yield=l.lua_yield,e.exports.lua_yieldk=l.lua_yieldk,e.exports.lua_tocfunction=a.lua_tocfunction},function(e,t,n){"use strict";const r={},{LUA_VERSION_MAJOR:a,LUA_VERSION_MINOR:u,to_luastring:l}=n(1);e.exports.LUA_PATH_SEP=";",e.exports.LUA_PATH_MARK="?",e.exports.LUA_EXEC_DIR="!";const s=a+"."+u;e.exports.LUA_VDIR=s;{const t="/";e.exports.LUA_DIRSEP=t;const n="./lua/"+s+"/";e.exports.LUA_LDIR=n;const r=n;e.exports.LUA_JSDIR=r;const a=l(n+"?.lua;"+n+"?/init.lua;./?.lua;./?/init.lua");e.exports.LUA_PATH_DEFAULT=a;const u=l(r+"?.js;"+r+"loadall.js;./?.js");e.exports.LUA_JSPATH_DEFAULT=u}const o=r.LUA_COMPAT_FLOATSTRING||!1,i=r.LUAI_MAXSTACK||1e6,c=r.LUA_IDSIZE||59,f=r.LUAL_BUFFERSIZE||8192,_=function(e,t){for(var n=Math.min(3,Math.ceil(Math.abs(t)/1023)),r=e,a=0;a<n;a++)r*=Math.pow(2,Math.floor((t+a)/n));return r};e.exports.LUAI_MAXSTACK=i,e.exports.LUA_COMPAT_FLOATSTRING=o,e.exports.LUA_IDSIZE=c,e.exports.LUA_INTEGER_FMT="%d",e.exports.LUA_INTEGER_FRMLEN="",e.exports.LUA_MAXINTEGER=2147483647,e.exports.LUA_MININTEGER=-2147483648,e.exports.LUA_NUMBER_FMT="%.14g",e.exports.LUA_NUMBER_FRMLEN="",e.exports.LUAL_BUFFERSIZE=f,e.exports.frexp=function(e){if(0===e)return[e,0];var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e);var n=t.getUint32(0)>>>20&2047;0===n&&(t.setFloat64(0,e*Math.pow(2,64)),n=(t.getUint32(0)>>>20&2047)-64);var r=n-1022;return[_(e,-r),r]},e.exports.ldexp=_,e.exports.lua_getlocaledecpoint=function(){return 46},e.exports.lua_integer2str=function(e){return String(e)},e.exports.lua_number2str=function(e){return String(Number(e.toPrecision(14)))},e.exports.lua_numbertointeger=function(e){return e>=-2147483648&&e<2147483648&&e},e.exports.luai_apicheck=function(e,t){if(!t)throw Error(t)}},function(e,t,n){"use strict";const{luai_apicheck:r}=n(3),a=function(e){if(!e)throw Error("assertion failed")};e.exports.lua_assert=a,e.exports.luai_apicheck=r||function(e,t){return a(t)},e.exports.api_check=function(e,t,n){return r(e,t&&n)},e.exports.LUAI_MAXCCALLS=200,e.exports.LUA_MINBUFFER=32,e.exports.luai_nummod=function(e,t,n){let r=t%n;return r*n<0&&(r+=n),r},e.exports.MAX_INT=2147483647,e.exports.MIN_INT=-2147483648},function(e,t,n){const r=n(1),a="Fengari 0.1.4  Copyright (C) 2017-2018 B. Giannangeli, Daurnimator\nBased on: "+r.LUA_COPYRIGHT;e.exports.FENGARI_AUTHORS="B. Giannangeli, Daurnimator",e.exports.FENGARI_COPYRIGHT=a,e.exports.FENGARI_RELEASE="Fengari 0.1.4",e.exports.FENGARI_VERSION="Fengari 0.1",e.exports.FENGARI_VERSION_MAJOR="0",e.exports.FENGARI_VERSION_MINOR="1",e.exports.FENGARI_VERSION_NUM=1,e.exports.FENGARI_VERSION_RELEASE="4",e.exports.is_luastring=r.is_luastring,e.exports.luastring_eq=r.luastring_eq,e.exports.luastring_from=r.luastring_from,e.exports.luastring_indexOf=r.luastring_indexOf,e.exports.luastring_of=r.luastring_of,e.exports.to_jsstring=r.to_jsstring,e.exports.to_luastring=r.to_luastring,e.exports.to_uristring=r.to_uristring,e.exports.from_userstring=r.from_userstring},function(e,t,n){"use strict";const{LUA_OPADD:r,LUA_OPBAND:a,LUA_OPBNOT:u,LUA_OPBOR:l,LUA_OPBXOR:s,LUA_OPDIV:o,LUA_OPIDIV:i,LUA_OPMOD:c,LUA_OPMUL:f,LUA_OPPOW:_,LUA_OPSHL:p,LUA_OPSHR:d,LUA_OPSUB:h,LUA_OPUNM:L,constant_types:{LUA_NUMTAGS:g,LUA_TBOOLEAN:A,LUA_TCCL:T,LUA_TFUNCTION:b,LUA_TLCF:x,LUA_TLCL:O,LUA_TLIGHTUSERDATA:k,LUA_TLNGSTR:v,LUA_TNIL:E,LUA_TNUMBER:m,LUA_TNUMFLT:R,LUA_TNUMINT:U,LUA_TSHRSTR:N,LUA_TSTRING:w,LUA_TTABLE:S,LUA_TTHREAD:y,LUA_TUSERDATA:I},from_userstring:M,luastring_indexOf:P,luastring_of:C,to_jsstring:D,to_luastring:V}=n(1),{lisdigit:B,lisprint:G,lisspace:K,lisxdigit:j}=n(22),F=n(11),H=n(8),X=n(12),{luaS_bless:z,luaS_new:Y}=n(10),J=n(9),{LUA_COMPAT_FLOATSTRING:q,ldexp:Z,lua_integer2str:W,lua_number2str:Q}=n(3),$=n(15),{MAX_INT:ee,luai_nummod:te,lua_assert:ne}=n(4),re=n(14),ae=g,ue=g+1;class le{constructor(e,t){this.type=e,this.value=t}ttype(){return 63&this.type}ttnov(){return 15&this.type}checktag(e){return this.type===e}checktype(e){return this.ttnov()===e}ttisnumber(){return this.checktype(m)}ttisfloat(){return this.checktag(R)}ttisinteger(){return this.checktag(U)}ttisnil(){return this.checktag(E)}ttisboolean(){return this.checktag(A)}ttislightuserdata(){return this.checktag(k)}ttisstring(){return this.checktype(w)}ttisshrstring(){return this.checktag(N)}ttislngstring(){return this.checktag(v)}ttistable(){return this.checktag(S)}ttisfunction(){return this.checktype(b)}ttisclosure(){return(31&this.type)===b}ttisCclosure(){return this.checktag(T)}ttisLclosure(){return this.checktag(O)}ttislcf(){return this.checktag(x)}ttisfulluserdata(){return this.checktag(I)}ttisthread(){return this.checktag(y)}ttisdeadkey(){return this.checktag(ue)}l_isfalse(){return this.ttisnil()||this.ttisboolean()&&!1===this.value}setfltvalue(e){this.type=R,this.value=e}chgfltvalue(e){ne(this.type==R),this.value=e}setivalue(e){this.type=U,this.value=e}chgivalue(e){ne(this.type==U),this.value=e}setnilvalue(){this.type=E,this.value=null}setfvalue(e){this.type=x,this.value=e}setpvalue(e){this.type=k,this.value=e}setbvalue(e){this.type=A,this.value=e}setsvalue(e){this.type=v,this.value=e}setuvalue(e){this.type=I,this.value=e}setthvalue(e){this.type=y,this.value=e}setclLvalue(e){this.type=O,this.value=e}setclCvalue(e){this.type=T,this.value=e}sethvalue(e){this.type=S,this.value=e}setdeadvalue(){this.type=ue,this.value=null}setfrom(e){this.type=e.type,this.value=e.value}tsvalue(){return ne(this.ttisstring()),this.value}svalue(){return this.tsvalue().getstr()}vslen(){return this.tsvalue().tsslen()}jsstring(e,t){return D(this.svalue(),e,t,!0)}}const se=function(e,t,n){e.stack[t].setsvalue(n)},oe=new le(E,null);Object.freeze(oe),e.exports.luaO_nilobject=oe;class ie{constructor(e,t){this.id=e.l_G.id_counter++,this.p=null,this.nupvalues=t,this.upvals=new Array(t)}}class ce{constructor(e,t,n){for(this.id=e.l_G.id_counter++,this.f=t,this.nupvalues=n,this.upvalue=new Array(n);n--;)this.upvalue[n]=new le(E,null)}}class fe{constructor(e,t){this.id=e.l_G.id_counter++,this.metatable=null,this.uservalue=new le(E,null),this.len=t,this.data=Object.create(null)}}const _e=V("..."),pe=V('[string "'),de=V('"]'),he=function(e){return B(e)?e-48:(223&e)-55},Le=function(e,t){let n=1;if(ne(t<=1114111),t<128)e[7]=t;else{let r=63;do{e[8-n++]=128|63&t,t>>=6,r>>=1}while(t>r);e[8-n]=~r<<1|t}return n},ge=[46,120,88,110,78],Ae={46:".",120:"x",88:"x",110:"n",78:"n"},Te=Math.floor(ee/10),be=ee%10,xe=function(e,t){let n;if(t.ttisinteger())n=V(W(t.value));else{let e=Q(t.value);!q&&/^[-0123456789]+$/.test(e)&&(e+=".0"),n=V(e)}t.setsvalue(z(e,n))},Oe=function(e,t){H.luaD_inctop(e),se(e,e.top-1,Y(e,t))},ke=function(e,t,n){let r,a=0,u=0,l=0;for(;-1!=(r=P(t,37,u));){switch(Oe(e,t.subarray(u,r)),t[r+1]){case 115:{let t=n[l++];if(null===t)t=V("(null)",!0);else{t=M(t);let e=P(t,0);-1!==e&&(t=t.subarray(0,e))}Oe(e,t);break}case 99:{let t=n[l++];G(t)?Oe(e,C(t)):ve(e,V("<\\%d>",!0),t);break}case 100:case 73:H.luaD_inctop(e),e.stack[e.top-1].setivalue(n[l++]),xe(e,e.stack[e.top-1]);break;case 102:H.luaD_inctop(e),e.stack[e.top-1].setfltvalue(n[l++]),xe(e,e.stack[e.top-1]);break;case 112:{let t=n[l++];if(t instanceof X.lua_State||t instanceof J.Table||t instanceof fe||t instanceof ie||t instanceof ce)Oe(e,V("0x"+t.id.toString(16)));else switch(typeof t){case"undefined":Oe(e,V("undefined"));break;case"number":Oe(e,V("Number("+t+")"));break;case"string":Oe(e,V("String("+JSON.stringify(t)+")"));break;case"boolean":Oe(e,V(t?"Boolean(true)":"Boolean(false)"));break;case"object":if(null===t){Oe(e,V("null"));break}case"function":{let n=e.l_G.ids.get(t);n||(n=e.l_G.id_counter++,e.l_G.ids.set(t,n)),Oe(e,V("0x"+n.toString(16)));break}default:Oe(e,V("<id NYI>"))}break}case 85:{let t=new Uint8Array(8),r=Le(t,n[l++]);Oe(e,t.subarray(8-r));break}case 37:Oe(e,V("%",!0));break;default:F.luaG_runerror(e,V("invalid option '%%%c' to 'lua_pushfstring'"),t[r+1])}a+=2,u=r+2}return H.luaD_checkstack(e,1),Oe(e,t.subarray(u)),a>0&&$.luaV_concat(e,a+1),e.stack[e.top-1].svalue()},ve=function(e,t,...n){return ke(e,t,n)},Ee=function(e,t,n,o){switch(t){case r:return n+o|0;case h:return n-o|0;case f:return $.luaV_imul(n,o);case c:return $.luaV_mod(e,n,o);case i:return $.luaV_div(e,n,o);case a:return n&o;case l:return n|o;case s:return n^o;case p:return $.luaV_shiftl(n,o);case d:return $.luaV_shiftl(n,-o);case L:return 0-n|0;case u:return-1^n;default:ne(0)}},me=function(e,t,n,a){switch(t){case r:return n+a;case h:return n-a;case f:return n*a;case o:return n/a;case _:return Math.pow(n,a);case i:return Math.floor(n/a);case L:return-n;case c:return te(e,n,a);default:ne(0)}};e.exports.CClosure=ce,e.exports.LClosure=ie,e.exports.LUA_TDEADKEY=ue,e.exports.LUA_TPROTO=ae,e.exports.LocVar=class{constructor(){this.varname=null,this.startpc=NaN,this.endpc=NaN}},e.exports.TValue=le,e.exports.Udata=fe,e.exports.UTF8BUFFSZ=8,e.exports.luaO_arith=function(e,t,n,i,c){let f="number"==typeof c?e.stack[c]:c;switch(t){case a:case l:case s:case p:case d:case u:{let r,a;if(!1!==(r=$.tointeger(n))&&!1!==(a=$.tointeger(i)))return void f.setivalue(Ee(e,t,r,a));break}case o:case _:{let r,a;if(!1!==(r=$.tonumber(n))&&!1!==(a=$.tonumber(i)))return void f.setfltvalue(me(e,t,r,a));break}default:{let r,a;if(n.ttisinteger()&&i.ttisinteger())return void f.setivalue(Ee(e,t,n.value,i.value));if(!1!==(r=$.tonumber(n))&&!1!==(a=$.tonumber(i)))return void f.setfltvalue(me(e,t,r,a));break}}ne(null!==e),re.luaT_trybinTM(e,n,i,c,t-r+re.TMS.TM_ADD)},e.exports.luaO_chunkid=function(e,t){let n,r=e.length;if(61===e[0])r<t?(n=new Uint8Array(r-1)).set(e.subarray(1)):(n=new Uint8Array(t)).set(e.subarray(1,t+1));else if(64===e[0])r<=t?(n=new Uint8Array(r-1)).set(e.subarray(1)):((n=new Uint8Array(t)).set(_e),t-=_e.length,n.set(e.subarray(r-t),_e.length));else{n=new Uint8Array(t);let a=P(e,10);n.set(pe);let u=pe.length;r<(t-=pe.length+_e.length+de.length)&&-1===a?(n.set(e,u),u+=e.length):(-1!==a&&(r=a),r>t&&(r=t),n.set(e.subarray(0,r),u),u+=r,n.set(_e,u),u+=_e.length),n.set(de,u),u+=de.length,n=n.subarray(0,u)}return n},e.exports.luaO_hexavalue=he,e.exports.luaO_int2fb=function(e){let t=0;if(e<8)return e;for(;e>=128;)e=e+15>>4,t+=4;for(;e>=16;)e=e+1>>1,t++;return t+1<<3|e-8},e.exports.luaO_pushfstring=ve,e.exports.luaO_pushvfstring=ke,e.exports.luaO_str2num=function(e,t){let n=function(e){let t,n=0,r=0,a=!0;for(;K(e[n]);)n++;if(((t=45===e[n])||43===e[n])&&n++,48!==e[n]||120!==e[n+1]&&88!==e[n+1])for(;n<e.length&&B(e[n]);n++){let u=e[n]-48;if(r>=Te&&(r>Te||u>be+t))return null;r=10*r+u|0,a=!1}else for(n+=2;n<e.length&&j(e[n]);n++)r=16*r+he(e[n])|0,a=!1;for(;n<e.length&&K(e[n]);)n++;return a||n!==e.length&&0!==e[n]?null:{n:0|(t?-r:r),i:n}}(e);return null!==n?(t.setivalue(n.n),n.i+1):null!==(n=function(e){let t=e.length,n=0;for(let a=0;a<t;a++){let t=e[a];if(-1!==ge.indexOf(t)){n=t;break}}let r=Ae[n];return"n"===r?null:function(e,t){let n="x"===t?function(e){let t,n=0,r=0,a=0,u=0,l=0,s=!1;for(;K(e[n]);)n++;if(((t=45===e[n])||43===e[n])&&n++,48!==e[n]||120!==e[n+1]&&88!==e[n+1])return null;for(n+=2;;n++)if(46===e[n]){if(s)break;s=!0}else{if(!j(e[n]))break;0===a&&48===e[n]?u++:++a<=30?r=16*r+he(e[n]):l++,s&&l--}if(u+a===0)return null;if(l*=4,112===e[n]||80===e[n]){let t,r=0;if(((t=45===e[++n])||43===e[n])&&n++,!B(e[n]))return null;for(;B(e[n]);)r=10*r+e[n++]-48;t&&(r=-r),l+=r}return t&&(r=-r),{n:Z(r,l),i:n}}(e):function(e){try{e=D(e)}catch(e){return null}let t=/^[\t\v\f \n\r]*[+-]?(?:[0-9]+\.?[0-9]*|\.[0-9]*)(?:[eE][+-]?[0-9]+)?/.exec(e);if(!t)return null;let n=parseFloat(t[0]);return isNaN(n)?null:{n:n,i:t[0].length}}(e);if(null===n)return null;for(;K(e[n.i]);)n.i++;return n.i===e.length||0===e[n.i]?n:null}(e,r)}(e))?(t.setfltvalue(n.n),n.i+1):0},e.exports.luaO_tostring=xe,e.exports.luaO_utf8esc=Le,e.exports.numarith=me,e.exports.pushobj2s=function(e,t){e.stack[e.top++]=new le(t.type,t.value)},e.exports.pushsvalue2s=function(e,t){e.stack[e.top++]=new le(v,t)},e.exports.setobjs2s=function(e,t,n){e.stack[t].setfrom(e.stack[n])},e.exports.setobj2s=function(e,t,n){e.stack[t].setfrom(n)},e.exports.setsvalue2s=se},function(e,t,n){"use strict";const{LUAL_BUFFERSIZE:r}=n(3),{LUA_ERRERR:a,LUA_MULTRET:u,LUA_REGISTRYINDEX:l,LUA_SIGNATURE:s,LUA_TBOOLEAN:o,LUA_TLIGHTUSERDATA:i,LUA_TNIL:c,LUA_TNONE:f,LUA_TNUMBER:_,LUA_TSTRING:p,LUA_TTABLE:d,LUA_VERSION_NUM:h,lua_Debug:L,lua_absindex:g,lua_atpanic:A,lua_call:T,lua_checkstack:b,lua_concat:x,lua_copy:O,lua_createtable:k,lua_error:v,lua_getfield:E,lua_getinfo:m,lua_getmetatable:R,lua_getstack:U,lua_gettop:N,lua_insert:w,lua_isinteger:S,lua_isnil:y,lua_isnumber:I,lua_isstring:M,lua_istable:P,lua_len:C,lua_load:D,lua_newstate:V,lua_newtable:B,lua_next:G,lua_pcall:K,lua_pop:j,lua_pushboolean:F,lua_pushcclosure:H,lua_pushcfunction:X,lua_pushfstring:z,lua_pushinteger:Y,lua_pushliteral:J,lua_pushlstring:q,lua_pushnil:Z,lua_pushstring:W,lua_pushvalue:Q,lua_pushvfstring:$,lua_rawequal:ee,lua_rawget:te,lua_rawgeti:ne,lua_rawlen:re,lua_rawseti:ae,lua_remove:ue,lua_setfield:le,lua_setglobal:se,lua_setmetatable:oe,lua_settop:ie,lua_toboolean:ce,lua_tointeger:fe,lua_tointegerx:_e,lua_tojsstring:pe,lua_tolstring:de,lua_tonumber:he,lua_tonumberx:Le,lua_topointer:ge,lua_tostring:Ae,lua_touserdata:Te,lua_type:be,lua_typename:xe,lua_version:Oe}=n(2),{from_userstring:ke,luastring_eq:ve,to_luastring:Ee,to_uristring:me}=n(5),Re=a+1,Ue=Ee("_LOADED"),Ne=Ee("_PRELOAD"),we=Ee("FILE*"),Se=Ee("__name"),ye=Ee("__tostring"),Ie=new Uint8Array(0);class Me{constructor(){this.L=null,this.b=Ie,this.n=0}}const Pe=function(e,t,n){if(0===n||!P(e,-1))return 0;for(Z(e);G(e,-2);){if(be(e,-2)===p){if(ee(e,t,-1))return j(e,1),1;if(Pe(e,t,n-1))return ue(e,-2),J(e,"."),w(e,-2),x(e,3),1}j(e,1)}return 0},Ce=function(e,t){let n=N(e);if(m(e,Ee("f"),t),E(e,l,Ue),Pe(e,n+1,2)){let t=Ae(e,-1);return 95===t[0]&&71===t[1]&&46===t[2]&&(W(e,t.subarray(3)),ue(e,-2)),O(e,-1,n+1),j(e,2),1}return ie(e,n),0},De=function(e,t){Ce(e,t)?(z(e,Ee("function '%s'"),Ae(e,-1)),ue(e,-2)):0!==t.namewhat.length?z(e,Ee("%s '%s'"),t.namewhat,t.name):t.what&&109===t.what[0]?J(e,"main chunk"):t.what&&76===t.what[0]?z(e,Ee("function <%s:%d>"),t.short_src,t.linedefined):J(e,"?")},Ve=function(e){let t="PANIC: unprotected error in call to Lua API ("+pe(e,-1)+")";throw new Error(t)},Be=function(e,t,n){let r=new L;return U(e,0,r)?(m(e,Ee("n"),r),ve(r.namewhat,Ee("method"))&&0==--t?je(e,Ee("calling '%s' on bad self (%s)"),r.name,n):(null===r.name&&(r.name=Ce(e,r)?Ae(e,-1):Ee("?")),je(e,Ee("bad argument #%d to '%s' (%s)"),t,r.name,n))):je(e,Ee("bad argument #%d (%s)"),t,n)},Ge=function(e,t,n){let r;r=ft(e,t,Se)===p?Ae(e,-1):be(e,t)===i?Ee("light userdata",!0):Ye(e,t);let a=z(e,Ee("%s expected, got %s"),n,r);return Be(e,t,a)},Ke=function(e,t){let n=new L;U(e,t,n)&&(m(e,Ee("Sl",!0),n),n.currentline>0)?z(e,Ee("%s:%d: "),n.short_src,n.currentline):W(e,Ee(""))},je=function(e,t,...n){return Ke(e,1),$(e,t,n),x(e,2),v(e)},Fe=function(e,t,n,r){if(t)return F(e,1),1;{let t,a;return Z(e),r?(t=r.message,a=-r.errno):(t="Success",a=0),n?z(e,Ee("%s: %s"),n,Ee(t)):W(e,Ee(t)),Y(e,a),3}},He=function(e,t){return E(e,l,t)},Xe=function(e,t,n){let r=Te(e,t);return null!==r&&R(e,t)?(He(e,n),ee(e,-1,-2)||(r=null),j(e,2),r):null},ze=function(e,t,n){Ge(e,t,xe(e,n))},Ye=function(e,t){return xe(e,be(e,t))},Je=function(e,t){let n=de(e,t);return null!=n||ze(e,t,p),n},qe=Je,Ze=function(e,t,n){return be(e,t)<=0?null===n?null:ke(n):Je(e,t)},We=Ze,Qe=function(e,t){let n=Le(e,t);return!1===n&&ze(e,t,_),n},$e=function(e,t){let n=_e(e,t);return!1===n&&function(e,t){I(e,t)?Be(e,t,Ee("number has no integer representation",!0)):ze(e,t,_)}(e,t),n},et=function(e,t){let n=e.n+t;if(e.b.length<n){let t=Math.max(2*e.b.length,n),r=new Uint8Array(t);r.set(e.b),e.b=r}return e.b.subarray(e.n,n)},tt=function(e,t){t.L=e,t.b=Ie},nt=function(e,t,n){n>0&&(t=ke(t),et(e,n).set(t.subarray(0,n)),ut(e,n))},rt=function(e,t){t=ke(t),nt(e,t,t.length)},at=function(e){q(e.L,e.b,e.n),e.n=0,e.b=Ie},ut=function(e,t){e.n+=t},lt=function(e,t,n,r){return be(e,n)<=0?r:t(e,n)},st=function(e,t){let n=t.string;return t.string=null,n},ot=function(e,t,n,r,a){return D(e,st,{string:t},r,a)},it=function(e,t,n,r){return ot(e,t,0,r,null)},ct=function(e,t){return it(e,t,t.length,t)},ft=function(e,t,n){if(R(e,t)){W(e,n);let t=te(e,-2);return t===c?j(e,2):ue(e,-2),t}return c},_t=function(e,t,n){return t=g(e,t),ft(e,t,n)!==c&&(Q(e,t),T(e,1,1),!0)},pt=Ee("%I"),dt=Ee("%f"),ht=function(e,t,n){var r=n>>>0,a=t.length,u=e.length+1-a;e:for(;r<u;r++){for(let n=0;n<a;n++)if(e[r+n]!==t[n])continue e;return r}return-1},Lt=function(e,t,n){return E(e,t,n)===d||(j(e,1),t=g(e,t),B(e),Q(e,-1),le(e,t,n),!1)},gt=function(e,t,n){At(e,n,Ee("too many upvalues",!0));for(let r in t){for(let t=0;t<n;t++)Q(e,-n);H(e,t[r],n),le(e,-(n+2),Ee(r))}j(e,n)},At=function(e,t,n){b(e,t)||(n?je(e,Ee("stack overflow (%s)"),n):je(e,Ee("stack overflow",!0)))},Tt=function(e,t,n,r){let a=r.message,u=Ae(e,n).subarray(1);return z(e,Ee("cannot %s %s: %s"),Ee(t),u,Ee(a)),ue(e,n),Re};let bt;const xt=[239,187,191];let Ot;{class e{constructor(){this.n=NaN,this.f=null,this.buff=new Uint8Array(1024),this.pos=0,this.err=void 0}}const t=function(e,t){let n=t;if(null!==n.f&&n.n>0){let e=n.n;return n.n=0,n.f=n.f.subarray(n.pos),n.buff.subarray(0,e)}let r=n.f;return n.f=null,r};bt=function(e){return e.pos<e.f.length?e.f[e.pos++]:null},Ot=function(n,r,a){let u=new e,l=N(n)+1;if(null===r)throw new Error("Can't read stdin in the browser");{z(n,Ee("@%s"),r);let e=me(r),t=new XMLHttpRequest;if(t.open("GET",e,!1),"undefined"==typeof window&&(t.responseType="arraybuffer"),t.send(),!(t.status>=200&&t.status<=299))return u.err=t.status,Tt(n,"open",l,{message:`${t.status}: ${t.statusText}`});"string"==typeof t.response?u.f=Ee(t.response):u.f=new Uint8Array(t.response)}let o=function(e){let t=function(e){let t;e.n=0;let n=0;do{if(null===(t=bt(e))||t!==xt[n])return t;n++,e.buff[e.n++]=t}while(n<xt.length);return e.n=0,bt(e)}(e);if(35===t){do{t=bt(e)}while(t&&10!==t);return{skipped:!0,c:bt(e)}}return{skipped:!1,c:t}}(u);o.c===s[0]&&r||o.skipped&&(u.buff[u.n++]=10),null!==o.c&&(u.buff[u.n++]=o.c);let i=D(n,t,u,Ae(n,-1),a),c=u.err;return c?(ie(n,l),Tt(n,"read",l,c)):(ue(n,l),i)}}const kt=function(e,t){return Ot(e,t,null)},vt=function(e,t,n){let r=Oe(e);72!=n&&je(e,Ee("core and library have incompatible numeric types")),r!=Oe(null)?je(e,Ee("multiple Lua VMs detected")):r!==t&&je(e,Ee("version mismatch: app. needs %f, Lua core provides %f"),t,r)};e.exports.LUA_ERRFILE=Re,e.exports.LUA_FILEHANDLE=we,e.exports.LUA_LOADED_TABLE=Ue,e.exports.LUA_NOREF=-2,e.exports.LUA_PRELOAD_TABLE=Ne,e.exports.LUA_REFNIL=-1,e.exports.luaL_Buffer=Me,e.exports.luaL_addchar=function(e,t){et(e,1),e.b[e.n++]=t},e.exports.luaL_addlstring=nt,e.exports.luaL_addsize=ut,e.exports.luaL_addstring=rt,e.exports.luaL_addvalue=function(e){let t=e.L,n=Ae(t,-1);nt(e,n,n.length),j(t,1)},e.exports.luaL_argcheck=function(e,t,n,r){t||Be(e,n,r)},e.exports.luaL_argerror=Be,e.exports.luaL_buffinit=tt,e.exports.luaL_buffinitsize=function(e,t,n){return tt(e,t),et(t,n)},e.exports.luaL_callmeta=_t,e.exports.luaL_checkany=function(e,t){be(e,t)===f&&Be(e,t,Ee("value expected",!0))},e.exports.luaL_checkinteger=$e,e.exports.luaL_checklstring=Je,e.exports.luaL_checknumber=Qe,e.exports.luaL_checkoption=function(e,t,n,r){let a=null!==n?We(e,t,n):qe(e,t);for(let u=0;r[u];u++)if(ve(r[u],a))return u;return Be(e,t,z(e,Ee("invalid option '%s'"),a))},e.exports.luaL_checkstack=At,e.exports.luaL_checkstring=qe,e.exports.luaL_checktype=function(e,t,n){be(e,t)!==n&&ze(e,t,n)},e.exports.luaL_checkudata=function(e,t,n){let r=Xe(e,t,n);return null===r&&Ge(e,t,n),r},e.exports.luaL_checkversion=function(e){vt(e,h,72)},e.exports.luaL_checkversion_=vt,e.exports.luaL_dofile=function(e,t){return kt(e,t)||K(e,0,u,0)},e.exports.luaL_dostring=function(e,t){return ct(e,t)||K(e,0,u,0)},e.exports.luaL_error=je,e.exports.luaL_execresult=function(e,t){let n,r;if(null===t)return F(e,1),J(e,"exit"),Y(e,0),3;if(t.status)n="exit",r=t.status;else{if(!t.signal)return Fe(e,0,null,t);n="signal",r=t.signal}return Z(e),J(e,n),Y(e,r),3},e.exports.luaL_fileresult=Fe,e.exports.luaL_getmetafield=ft,e.exports.luaL_getmetatable=He,e.exports.luaL_getsubtable=Lt,e.exports.luaL_gsub=function(e,t,n,r){let a,u=new Me;for(tt(e,u);(a=ht(t,n))>=0;)nt(u,t,a),rt(u,r),t=t.subarray(a+n.length);return rt(u,t),at(u),Ae(e,-1)},e.exports.luaL_len=function(e,t){C(e,t);let n=_e(e,-1);return!1===n&&je(e,Ee("object length is not an integer",!0)),j(e,1),n},e.exports.luaL_loadbuffer=it,e.exports.luaL_loadbufferx=ot,e.exports.luaL_loadfile=kt,e.exports.luaL_loadfilex=Ot,e.exports.luaL_loadstring=ct,e.exports.luaL_newlib=function(e,t){k(e),gt(e,t,0)},e.exports.luaL_newlibtable=function(e){k(e)},e.exports.luaL_newmetatable=function(e,t){return He(e,t)!==c?0:(j(e,1),k(e,0,2),W(e,t),le(e,-2,Se),Q(e,-1),le(e,l,t),1)},e.exports.luaL_newstate=function(){let e=V();return e&&A(e,Ve),e},e.exports.luaL_opt=lt,e.exports.luaL_optinteger=function(e,t,n){return lt(e,$e,t,n)},e.exports.luaL_optlstring=Ze,e.exports.luaL_optnumber=function(e,t,n){return lt(e,Qe,t,n)},e.exports.luaL_optstring=We,e.exports.luaL_prepbuffer=function(e){return et(e,r)},e.exports.luaL_prepbuffsize=et,e.exports.luaL_pushresult=at,e.exports.luaL_pushresultsize=function(e,t){ut(e,t),at(e)},e.exports.luaL_ref=function(e,t){let n;return y(e,-1)?(j(e,1),-1):(t=g(e,t),ne(e,t,0),n=fe(e,-1),j(e,1),0!==n?(ne(e,t,n),ae(e,t,0)):n=re(e,t)+1,ae(e,t,n),n)},e.exports.luaL_requiref=function(e,t,n,r){Lt(e,l,Ue),E(e,-1,t),ce(e,-1)||(j(e,1),X(e,n),W(e,t),T(e,1,1),Q(e,-1),le(e,-3,t)),ue(e,-2),r&&(Q(e,-1),se(e,t))},e.exports.luaL_setfuncs=gt,e.exports.luaL_setmetatable=function(e,t){He(e,t),oe(e,-2)},e.exports.luaL_testudata=Xe,e.exports.luaL_tolstring=function(e,t){if(_t(e,t,ye))M(e,-1)||je(e,Ee("'__tostring' must return a string"));else switch(be(e,t)){case _:S(e,t)?z(e,pt,fe(e,t)):z(e,dt,he(e,t));break;case p:Q(e,t);break;case o:J(e,ce(e,t)?"true":"false");break;case c:J(e,"nil");break;default:{let n=ft(e,t,Se),r=n===p?Ae(e,-1):Ye(e,t);z(e,Ee("%s: %p"),r,ge(e,t)),n!==c&&ue(e,-2);break}}return de(e,-1)},e.exports.luaL_traceback=function(e,t,n,r){let a=new L,u=N(e),l=function(e){let t=new L,n=1,r=1;for(;U(e,r,t);)n=r,r*=2;for(;n<r;){let a=Math.floor((n+r)/2);U(e,a,t)?n=a+1:r=a}return r-1}(t),s=l-r>21?10:-1;for(n&&z(e,Ee("%s\n"),n),At(e,10,null),J(e,"stack traceback:");U(t,r++,a);)0==s--?(J(e,"\n\t..."),r=l-11+1):(m(t,Ee("Slnt",!0),a),z(e,Ee("\n\t%s:"),a.short_src),a.currentline>0&&J(e,`${a.currentline}:`),J(e," in "),De(e,a),a.istailcall&&J(e,"\n\t(...tail calls..)"),x(e,N(e)-u));x(e,N(e)-u)},e.exports.luaL_typename=Ye,e.exports.luaL_unref=function(e,t,n){n>=0&&(t=g(e,t),ne(e,t,0),ae(e,t,n),Y(e,n),ae(e,t,0))},e.exports.luaL_where=Ke,e.exports.lua_writestringerror=function(){for(let e=0;e<arguments.length;e++){let t=arguments[e];do{let e=/([^\n]*)\n?([\d\D]*)/.exec(t);console.error(e[1]),t=e[2]}while(""!==t)}}},function(e,t,n){"use strict";const{LUA_HOOKCALL:r,LUA_HOOKRET:a,LUA_HOOKTAILCALL:u,LUA_MASKCALL:l,LUA_MASKLINE:s,LUA_MASKRET:o,LUA_MINSTACK:i,LUA_MULTRET:c,LUA_SIGNATURE:f,constant_types:{LUA_TCCL:_,LUA_TLCF:p,LUA_TLCL:d,LUA_TNIL:h},thread_status:{LUA_ERRMEM:L,LUA_ERRERR:g,LUA_ERRRUN:A,LUA_ERRSYNTAX:T,LUA_OK:b,LUA_YIELD:x},lua_Debug:O,luastring_indexOf:k,to_luastring:v}=n(1),E=n(18),m=n(11),R=n(13),{api_check:U,lua_assert:N,LUAI_MAXCCALLS:w}=n(4),S=n(6),y=n(16),I=n(23),M=n(12),{luaS_newliteral:P}=n(10),C=n(14),{LUAI_MAXSTACK:D}=n(3),V=n(36),B=n(15),{MBuffer:G}=n(19),K=function(e,t){if(e.top<t)for(;e.top<t;)e.stack[e.top++]=new S.TValue(h,null);else for(;e.top>t;)delete e.stack[--e.top]},j=function(e,t,n){let r=e.top;for(;e.top<n+1;)e.stack[e.top++]=new S.TValue(h,null);switch(t){case L:S.setsvalue2s(e,n,P(e,"not enough memory"));break;case g:S.setsvalue2s(e,n,P(e,"error in error handling"));break;default:S.setobjs2s(e,n,r-1)}for(;e.top>n+1;)delete e.stack[--e.top]},F=D+200,H=function(e,t){N(t<=D||t==F),N(e.stack_last==e.stack.length-M.EXTRA_STACK),e.stack.length=t,e.stack_last=t-M.EXTRA_STACK},X=function(e,t){let n=e.stack.length;if(n>D)ne(e,g);else{let r=e.top+t+M.EXTRA_STACK,a=2*n;a>D&&(a=D),a<r&&(a=r),a>D?(H(e,F),m.luaG_runerror(e,v("stack overflow",!0))):H(e,a)}},z=function(e,t){e.stack_last-e.top<=t&&X(e,t)},Y=function(e){let t=function(e){let t=e.top;for(let n=e.ci;null!==n;n=n.previous)t<n.top&&(t=n.top);return N(t<=e.stack_last),t+1}(e),n=t+Math.floor(t/8)+2*M.EXTRA_STACK;n>D&&(n=D),e.stack.length>D&&M.luaE_freeCI(e),t<=D-M.EXTRA_STACK&&n<e.stack.length&&H(e,n)},J=function(e,t,n){let a=e.stack[t];switch(a.type){case _:case p:{let u=a.type===_?a.value.f:a.value;z(e,i);let s=M.luaE_extendCI(e);s.funcOff=t,s.nresults=n,s.func=a,s.top=e.top+i,N(s.top<=e.stack_last),s.callstatus=0,e.hookmask&l&&W(e,r,-1);let o=u(e);if("number"!=typeof o||o<0||(0|o)!==o)throw Error("invalid return value from JS function (expected integer)");return E.api_checknelems(e,o),q(e,s,e.top-o,o),!0}case d:{let r,u=a.value.p,s=e.top-t-1,o=u.maxstacksize;if(z(e,o),u.is_vararg)r=$(e,u,s);else{for(;s<u.numparams;s++)e.stack[e.top++]=new S.TValue(h,null);r=t+1}let i=M.luaE_extendCI(e);return i.funcOff=t,i.nresults=n,i.func=a,i.l_base=r,i.top=r+o,K(e,i.top),i.l_code=u.code,i.l_savedpc=0,i.callstatus=M.CIST_LUA,e.hookmask&l&&Q(e,i),!1}default:return z(e,1),ee(e,t,a),J(e,t,n)}},q=function(e,t,n,r){let u=t.nresults;e.hookmask&(o|s)&&(e.hookmask&o&&W(e,a,-1),e.oldpc=t.previous.l_savedpc);let l=t.funcOff;return e.ci=t.previous,e.ci.next=null,Z(e,n,l,r,u)},Z=function(e,t,n,r,a){switch(a){case 0:break;case 1:0===r?e.stack[n].setnilvalue():S.setobjs2s(e,n,t);break;case c:for(let a=0;a<r;a++)S.setobjs2s(e,n+a,t+a);for(let t=e.top;t>=n+r;t--)delete e.stack[t];return e.top=n+r,!1;default:{let u;if(a<=r)for(u=0;u<a;u++)S.setobjs2s(e,n+u,t+u);else{for(u=0;u<r;u++)S.setobjs2s(e,n+u,t+u);for(;u<a;u++)n+u>=e.top?e.stack[n+u]=new S.TValue(h,null):e.stack[n+u].setnilvalue()}break}}let u=n+a;for(let l=e.top;l>=u;l--)delete e.stack[l];return e.top=u,!0},W=function(e,t,n){let r=e.hook;if(r&&e.allowhook){let a=e.ci,u=e.top,l=a.top,s=new O;s.event=t,s.currentline=n,s.i_ci=a,z(e,i),a.top=e.top+i,N(a.top<=e.stack_last),e.allowhook=0,a.callstatus|=M.CIST_HOOKED,r(e,s),N(!e.allowhook),e.allowhook=1,a.top=l,K(e,u),a.callstatus&=~M.CIST_HOOKED}},Q=function(e,t){let n=r;t.l_savedpc++,t.previous.callstatus&M.CIST_LUA&&t.previous.l_code[t.previous.l_savedpc-1].opcode==y.OpCodesI.OP_TAILCALL&&(t.callstatus|=M.CIST_TAIL,n=u),W(e,n,-1),t.l_savedpc--},$=function(e,t,n){let r,a=t.numparams,u=e.top-n,l=e.top;for(r=0;r<a&&r<n;r++)S.pushobj2s(e,e.stack[u+r]),e.stack[u+r].setnilvalue();for(;r<a;r++)e.stack[e.top++]=new S.TValue(h,null);return l},ee=function(e,t,n){let r=C.luaT_gettmbyobj(e,n,C.TMS.TM_CALL);r.ttisfunction(r)||m.luaG_typeerror(e,n,v("call",!0)),S.pushobj2s(e,e.stack[e.top-1]);for(let a=e.top-2;a>t;a--)S.setobjs2s(e,a,a-1);S.setobj2s(e,t,r)},te=function(e,t,n){++e.nCcalls>=w&&function(e){e.nCcalls===w?m.luaG_runerror(e,v("JS stack overflow",!0)):e.nCcalls>=w+(w>>3)&&ne(e,g)}(e),J(e,t,n)||B.luaV_execute(e),e.nCcalls--},ne=function(e,t){if(e.errorJmp)throw e.errorJmp.status=t,e.errorJmp;{let n=e.l_G;if(e.status=t,!n.mainthread.errorJmp){let r=n.panic;throw r&&(j(e,t,e.top),e.ci.top<e.top&&(e.ci.top=e.top),r(e)),new Error(`Aborted ${t}`)}n.mainthread.stack[n.mainthread.top++]=e.stack[e.top-1],ne(n.mainthread,t)}},re=function(e,t,n){let r=e.nCcalls,a={status:b,previous:e.errorJmp};e.errorJmp=a;try{t(e,n)}catch(t){if(a.status===b){let n=e.l_G.atnativeerror;if(n)try{if(a.status=b,E.lua_pushcfunction(e,n),E.lua_pushlightuserdata(e,t),fe(e,e.top-2,1),0!==e.errfunc){let t=e.errfunc;S.pushobj2s(e,e.stack[e.top-1]),S.setobjs2s(e,e.top-2,t),fe(e,e.top-2,1)}a.status=A}catch(e){a.status===b&&(a.status=-1)}else a.status=-1}}return e.errorJmp=a.previous,e.nCcalls=r,a.status},ae=function(e,t){let n=e.ci;N(null!==n.c_k&&0===e.nny),N(n.callstatus&M.CIST_YPCALL||t===x),n.callstatus&M.CIST_YPCALL&&(n.callstatus&=~M.CIST_YPCALL,e.errfunc=n.c_old_errfunc),n.nresults===c&&e.ci.top<e.top&&(e.ci.top=e.top);let r=(0,n.c_k)(e,t,n.c_ctx);E.api_checknelems(e,r),q(e,n,e.top-r,r)},ue=function(e,t){for(null!==t&&ae(e,t);e.ci!==e.base_ci;)e.ci.callstatus&M.CIST_LUA?(B.luaV_finishOp(e),B.luaV_execute(e)):ae(e,x)},le=function(e,t){let n=function(e){for(let t=e.ci;null!==t;t=t.previous)if(t.callstatus&M.CIST_YPCALL)return t;return null}(e);if(null===n)return 0;let r=n.extra;return R.luaF_close(e,r),j(e,t,r),e.ci=n,e.allowhook=n.callstatus&M.CIST_OAH,e.nny=0,Y(e),e.errfunc=n.c_old_errfunc,1},se=function(e,t,n){let r=P(e,t);if(0===n)S.pushsvalue2s(e,r),U(e,e.top<=e.ci.top,"stack overflow");else{for(let t=1;t<n;t++)delete e.stack[--e.top];S.setsvalue2s(e,e.top-1,r)}return A},oe=function(e,t){let n=e.top-t,r=e.ci;e.status===b?J(e,n-1,c)||B.luaV_execute(e):(N(e.status===x),e.status=b,r.funcOff=r.extra,r.func=e.stack[r.funcOff],r.callstatus&M.CIST_LUA?B.luaV_execute(e):(null!==r.c_k&&(t=r.c_k(e,x,r.c_ctx),E.api_checknelems(e,t),n=e.top-t),q(e,r,n,t)),ue(e,null))},ie=function(e,t,n,r){let a=e.ci;return E.api_checknelems(e,t),e.nny>0&&(e!==e.l_G.mainthread?m.luaG_runerror(e,v("attempt to yield across a JS-call boundary",!0)):m.luaG_runerror(e,v("attempt to yield from outside a coroutine",!0))),e.status=x,a.extra=a.funcOff,a.callstatus&M.CIST_LUA?U(e,null===r,"hooks cannot continue after yielding"):(a.c_k=r,null!==r&&(a.c_ctx=n),a.funcOff=e.top-t-1,a.func=e.stack[a.funcOff],ne(e,x)),N(a.callstatus&M.CIST_HOOKED),0},ce=function(e,t,n,r,a){let u=e.ci,l=e.allowhook,s=e.nny,o=e.errfunc;e.errfunc=a;let i=re(e,t,n);return i!==b&&(R.luaF_close(e,r),j(e,i,r),e.ci=u,e.allowhook=l,e.nny=s,Y(e)),e.errfunc=o,i},fe=function(e,t,n){e.nny++,te(e,t,n),e.nny--},_e=function(e,t,n){t&&-1===k(t,n[0])&&(S.luaO_pushfstring(e,v("attempt to load a %s chunk (mode is '%s')"),n,t),ne(e,T))},pe=function(e,t){let n,r=t.z.zgetc();r===f[0]?(_e(e,t.mode,v("binary",!0)),n=V.luaU_undump(e,t.z,t.name)):(_e(e,t.mode,v("text",!0)),n=I.luaY_parser(e,t.z,t.buff,t.dyd,t.name,r)),N(n.nupvalues===n.p.upvalues.length),R.luaF_initupvals(e,n)};e.exports.adjust_top=K,e.exports.luaD_call=te,e.exports.luaD_callnoyield=fe,e.exports.luaD_checkstack=z,e.exports.luaD_growstack=X,e.exports.luaD_hook=W,e.exports.luaD_inctop=function(e){z(e,1),e.stack[e.top++]=new S.TValue(h,null)},e.exports.luaD_pcall=ce,e.exports.luaD_poscall=q,e.exports.luaD_precall=J,e.exports.luaD_protectedparser=function(e,t,n,r){let a=new class{constructor(e,t,n){this.z=e,this.buff=new G,this.dyd=new I.Dyndata,this.mode=n,this.name=t}}(t,n,r);e.nny++;let u=ce(e,pe,a,e.top,e.errfunc);return e.nny--,u},e.exports.luaD_rawrunprotected=re,e.exports.luaD_reallocstack=H,e.exports.luaD_throw=ne,e.exports.lua_isyieldable=function(e){return 0===e.nny},e.exports.lua_resume=function(e,t,n){let r=e.nny;if(e.status===b){if(e.ci!==e.base_ci)return se(e,"cannot resume non-suspended coroutine",n)}else if(e.status!==x)return se(e,"cannot resume dead coroutine",n);if(e.nCcalls=t?t.nCcalls+1:1,e.nCcalls>=w)return se(e,"JS stack overflow",n);e.nny=0,E.api_checknelems(e,e.status===b?n+1:n);let a=re(e,oe,n);if(-1===a)a=A;else{for(;a>x&&le(e,a);)a=re(e,ue,a);a>x?(e.status=a,j(e,a,e.top),e.ci.top=e.top):N(a===e.status)}return e.nny=r,e.nCcalls--,N(e.nCcalls===(t?t.nCcalls:0)),a},e.exports.lua_yield=function(e,t){ie(e,t,0,null)},e.exports.lua_yieldk=ie},function(e,t,n){"use strict";const{constant_types:{LUA_TBOOLEAN:r,LUA_TCCL:a,LUA_TLCF:u,LUA_TLCL:l,LUA_TLIGHTUSERDATA:s,LUA_TLNGSTR:o,LUA_TNIL:i,LUA_TNUMFLT:c,LUA_TNUMINT:f,LUA_TSHRSTR:_,LUA_TTABLE:p,LUA_TTHREAD:d,LUA_TUSERDATA:h},to_luastring:L}=n(1),{lua_assert:g}=n(4),A=n(11),T=n(6),{luaS_hashlongstr:b,TString:x}=n(10),O=n(12);let k=new WeakMap;const v=function(e){let t=k.get(e);return t||(t={},k.set(e,t)),t},E=function(e,t){switch(t.type){case i:return A.luaG_runerror(e,L("table index is nil",!0));case c:if(isNaN(t.value))return A.luaG_runerror(e,L("table index is NaN",!0));case f:case r:case p:case l:case u:case a:case h:case d:return t.value;case _:case o:return b(t.tsvalue());case s:{let n=t.value;switch(typeof n){case"string":return"*"+n;case"number":return"#"+n;case"boolean":return n?"?true":"?false";case"function":return v(n);case"object":if(n instanceof O.lua_State&&n.l_G===e.l_G||n instanceof m||n instanceof T.Udata||n instanceof T.LClosure||n instanceof T.CClosure)return v(n);default:return n}}default:throw new Error("unknown key type: "+t.type)}};class m{constructor(e){this.id=e.l_G.id_counter++,this.strong=new Map,this.dead_strong=new Map,this.dead_weak=void 0,this.f=void 0,this.l=void 0,this.metatable=null,this.flags=-1}}const R=function(e,t,n,r){e.dead_strong.clear(),e.dead_weak=void 0;let a=null,u={key:n,value:r,p:a=e.l,n:void 0};e.f||(e.f=u),a&&(a.n=u),e.strong.set(t,u),e.l=u},U=function(e,t){let n=e.strong.get(t);if(n){n.key.setdeadvalue(),n.value=void 0;let r=n.n,a=n.p;n.p=void 0,a&&(a.n=r),r&&(r.p=a),e.f===n&&(e.f=r),e.l===n&&(e.l=a),e.strong.delete(t),function(e){return"object"==typeof e?null!==e:"function"==typeof e}(t)?(e.dead_weak||(e.dead_weak=new WeakMap),e.dead_weak.set(t,n)):e.dead_strong.set(t,n)}},N=function(e,t){let n=e.strong.get(t);return n?n.value:T.luaO_nilobject},w=function(e,t){return g("number"==typeof t&&(0|t)===t),N(e,t)};e.exports.invalidateTMcache=function(e){e.flags=0},e.exports.luaH_get=function(e,t,n){return g(n instanceof T.TValue),n.ttisnil()||n.ttisfloat()&&isNaN(n.value)?T.luaO_nilobject:N(t,E(e,n))},e.exports.luaH_getint=w,e.exports.luaH_getn=function(e){let t=0,n=e.strong.size+1;for(;n-t>1;){let r=Math.floor((t+n)/2);w(e,r).ttisnil()?n=r:t=r}return t},e.exports.luaH_getstr=function(e,t){return g(t instanceof x),N(e,b(t))},e.exports.luaH_setfrom=function(e,t,n,r){g(n instanceof T.TValue);let a=E(e,n);if(r.ttisnil())return void U(t,a);let u=t.strong.get(a);if(u)u.value.setfrom(r);else{let e,u=n.value;e=n.ttisfloat()&&(0|u)===u?new T.TValue(f,u):new T.TValue(n.type,u);let l=new T.TValue(r.type,r.value);R(t,a,e,l)}},e.exports.luaH_setint=function(e,t,n){g("number"==typeof t&&(0|t)===t&&n instanceof T.TValue);let r=t;if(n.ttisnil())return void U(e,r);let a=e.strong.get(r);if(a)a.value.setfrom(n);else{let a=new T.TValue(f,t),u=new T.TValue(n.type,n.value);R(e,r,a,u)}},e.exports.luaH_new=function(e){return new m(e)},e.exports.luaH_next=function(e,t,n){let r,a=e.stack[n];if(a.type===i){if(!(r=t.f))return!1}else{let n=E(e,a);if(r=t.strong.get(n)){if(!(r=r.n))return!1}else{if(!(r=t.dead_weak&&t.dead_weak.get(n)||t.dead_strong.get(n)))return A.luaG_runerror(e,L("invalid key to 'next'"));do{if(!(r=r.n))return!1}while(r.key.ttisdeadkey())}}return T.setobj2s(e,n,r.key),T.setobj2s(e,n+1,r.value),!0},e.exports.Table=m},function(e,t,n){"use strict";const{is_luastring:r,luastring_eq:a,luastring_from:u,to_luastring:l}=n(1),{lua_assert:s}=n(4);class o{constructor(e,t){this.hash=null,this.realstring=t}getstr(){return this.realstring}tsslen(){return this.realstring.length}}const i=function(e){s(r(e));let t=e.length,n="|";for(let r=0;r<t;r++)n+=e[r].toString(16);return n},c=function(e,t){return s(t instanceof Uint8Array),new o(e,t)};e.exports.luaS_eqlngstr=function(e,t){return s(e instanceof o),s(t instanceof o),e==t||a(e.realstring,t.realstring)},e.exports.luaS_hash=i,e.exports.luaS_hashlongstr=function(e){return s(e instanceof o),null===e.hash&&(e.hash=i(e.getstr())),e.hash},e.exports.luaS_bless=c,e.exports.luaS_new=function(e,t){return c(e,u(t))},e.exports.luaS_newliteral=function(e,t){return c(e,l(t))},e.exports.TString=o},function(e,t,n){"use strict";const{LUA_HOOKCOUNT:r,LUA_HOOKLINE:a,LUA_MASKCOUNT:u,LUA_MASKLINE:l,constant_types:{LUA_TBOOLEAN:s,LUA_TNIL:o,LUA_TTABLE:i},thread_status:{LUA_ERRRUN:c,LUA_YIELD:f},from_userstring:_,luastring_eq:p,luastring_indexOf:d,to_luastring:h}=n(1),{api_check:L,lua_assert:g}=n(4),{LUA_IDSIZE:A}=n(3),T=n(18),b=n(8),x=n(13),O=n(20),k=n(6),v=n(16),E=n(12),m=n(9),R=n(14),U=n(15),N=function(e){return g(e.callstatus&E.CIST_LUA),e.l_savedpc-1},w=function(e){return 0!==e.func.value.p.lineinfo.length?e.func.value.p.lineinfo[N(e)]:-1},S=function(e){if(e.status===f){let t=e.ci,n=t.funcOff;t.func=e.stack[t.extra],t.funcOff=t.extra,t.extra=n}},y=function(e,t){g(t<e.upvalues.length);let n=e.upvalues[t].name;return null===n?h("?",!0):n.getstr()},I=function(e,t,n){let r,a=null;if(t.callstatus&E.CIST_LUA){if(n<0)return function(e,t){let n=e.func.value.p.numparams;return t>=e.l_base-e.funcOff-n?null:{pos:e.funcOff+n+t,name:h("(*vararg)",!0)}}(t,-n);r=t.l_base,a=x.luaF_getlocalname(t.func.value.p,n,N(t))}else r=t.funcOff+1;if(null===a){if(!((t===e.ci?e.top:t.next.funcOff)-r>=n&&n>0))return null;a=h("(*temporary)",!0)}return{pos:r+(n-1),name:a}},M=function(e,t){if(null===t||t instanceof k.CClosure)e.source=h("=[JS]",!0),e.linedefined=-1,e.lastlinedefined=-1,e.what=h("J",!0);else{let n=t.p;e.source=n.source?n.source.getstr():h("=?",!0),e.linedefined=n.linedefined,e.lastlinedefined=n.lastlinedefined,e.what=0===e.linedefined?h("main",!0):h("Lua",!0)}e.short_src=k.luaO_chunkid(e.source,A)},P=function(e,t){let n={name:null,funcname:null};return null===t?null:t.callstatus&E.CIST_FIN?(n.name=h("__gc",!0),n.funcname=h("metamethod",!0),n):!(t.callstatus&E.CIST_TAIL)&&t.previous.callstatus&E.CIST_LUA?B(e,t.previous):null},C=function(e,t,n){let r={name:null,funcname:null};if(v.ISK(n)){let t=e.k[v.INDEXK(n)];if(t.ttisstring())return r.name=t.svalue(),r}else{let r=V(e,t,n);if(r&&99===r.funcname[0])return r}return r.name=h("?",!0),r},D=function(e,t){return e<t?-1:e},V=function(e,t,n){let r={name:x.luaF_getlocalname(e,n+1,t),funcname:null};if(r.name)return r.funcname=h("local",!0),r;let a=function(e,t,n){let r=-1,a=0,u=v.OpCodesI;for(let l=0;l<t;l++){let s=e.code[l],o=s.A;switch(s.opcode){case u.OP_LOADNIL:{let e=s.B;o<=n&&n<=o+e&&(r=D(l,a));break}case u.OP_TFORCALL:n>=o+2&&(r=D(l,a));break;case u.OP_CALL:case u.OP_TAILCALL:n>=o&&(r=D(l,a));break;case u.OP_JMP:{let e=l+1+s.sBx;l<e&&e<=t&&e>a&&(a=e);break}default:v.testAMode(s.opcode)&&n===o&&(r=D(l,a))}}return r}(e,t,n),u=v.OpCodesI;if(-1!==a){let t=e.code[a];switch(t.opcode){case u.OP_MOVE:{let n=t.B;if(n<t.A)return V(e,a,n);break}case u.OP_GETTABUP:case u.OP_GETTABLE:{let n=t.C,l=t.B,s=t.opcode===u.OP_GETTABLE?x.luaF_getlocalname(e,l+1,a):y(e,l);return r.name=C(e,a,n).name,r.funcname=s&&p(s,O.LUA_ENV)?h("global",!0):h("field",!0),r}case u.OP_GETUPVAL:return r.name=y(e,t.B),r.funcname=h("upvalue",!0),r;case u.OP_LOADK:case u.OP_LOADKX:{let n=t.opcode===u.OP_LOADK?t.Bx:e.code[a+1].Ax;if(e.k[n].ttisstring())return r.name=e.k[n].svalue(),r.funcname=h("constant",!0),r;break}case u.OP_SELF:{let n=t.C;return r.name=C(e,a,n).name,r.funcname=h("method",!0),r}}}return null},B=function(e,t){let n={name:null,funcname:null},r=0,a=t.func.value.p,u=N(t),l=a.code[u],s=v.OpCodesI;if(t.callstatus&E.CIST_HOOKED)return n.name=h("?",!0),n.funcname=h("hook",!0),n;switch(l.opcode){case s.OP_CALL:case s.OP_TAILCALL:return V(a,u,l.A);case s.OP_TFORCALL:return n.name=h("for iterator",!0),n.funcname=h("for iterator",!0),n;case s.OP_SELF:case s.OP_GETTABUP:case s.OP_GETTABLE:r=R.TMS.TM_INDEX;break;case s.OP_SETTABUP:case s.OP_SETTABLE:r=R.TMS.TM_NEWINDEX;break;case s.OP_ADD:r=R.TMS.TM_ADD;break;case s.OP_SUB:r=R.TMS.TM_SUB;break;case s.OP_MUL:r=R.TMS.TM_MUL;break;case s.OP_MOD:r=R.TMS.TM_MOD;break;case s.OP_POW:r=R.TMS.TM_POW;break;case s.OP_DIV:r=R.TMS.TM_DIV;break;case s.OP_IDIV:r=R.TMS.TM_IDIV;break;case s.OP_BAND:r=R.TMS.TM_BAND;break;case s.OP_BOR:r=R.TMS.TM_BOR;break;case s.OP_BXOR:r=R.TMS.TM_BXOR;break;case s.OP_SHL:r=R.TMS.TM_SHL;break;case s.OP_SHR:r=R.TMS.TM_SHR;break;case s.OP_UNM:r=R.TMS.TM_UNM;break;case s.OP_BNOT:r=R.TMS.TM_BNOT;break;case s.OP_LEN:r=R.TMS.TM_LEN;break;case s.OP_CONCAT:r=R.TMS.TM_CONCAT;break;case s.OP_EQ:r=R.TMS.TM_EQ;break;case s.OP_LT:r=R.TMS.TM_LT;break;case s.OP_LE:r=R.TMS.TM_LE;break;default:return null}return n.name=e.l_G.tmname[r].getstr(),n.funcname=h("metamethod",!0),n},G=function(e,t){let n=e.ci,r=null;if(n.callstatus&E.CIST_LUA){r=function(e,t,n){let r=t.func.value;for(let a=0;a<r.nupvalues;a++)if(r.upvals[a]===n)return{name:y(r.p,a),funcname:h("upvalue",!0)};return null}(0,n,t);let a=function(e,t,n){for(let r=t.l_base;r<t.top;r++)if(e.stack[r]===n)return r;return!1}(e,n,t);!r&&a&&(r=V(n.func.value.p,N(n),a-n.l_base))}return r?k.luaO_pushfstring(e,h(" (%s '%s')",!0),r.funcname,r.name):h("",!0)},K=function(e,t,n){let r=R.luaT_objtypename(e,t);F(e,h("attempt to %s a %s value%s",!0),n,r,G(e,t))},j=function(e,t,n,r){let a;return a=n?k.luaO_chunkid(n.getstr(),A):h("?",!0),k.luaO_pushfstring(e,h("%s:%d: %s",!0),a,r,t)},F=function(e,t,...n){let r=e.ci,a=k.luaO_pushvfstring(e,t,n);r.callstatus&E.CIST_LUA&&j(e,a,r.func.value.p.source,w(r)),H(e)},H=function(e){if(0!==e.errfunc){let t=e.errfunc;k.pushobj2s(e,e.stack[e.top-1]),k.setobjs2s(e,e.top-2,t),b.luaD_callnoyield(e,e.top-2,1)}b.luaD_throw(e,c)};e.exports.luaG_addinfo=j,e.exports.luaG_concaterror=function(e,t,n){(t.ttisstring()||U.cvt2str(t))&&(t=n),K(e,t,h("concatenate",!0))},e.exports.luaG_errormsg=H,e.exports.luaG_opinterror=function(e,t,n,r){!1===U.tonumber(t)&&(n=t),K(e,n,r)},e.exports.luaG_ordererror=function(e,t,n){let r=R.luaT_objtypename(e,t),a=R.luaT_objtypename(e,n);p(r,a)?F(e,h("attempt to compare two %s values",!0),r):F(e,h("attempt to compare %s with %s",!0),r,a)},e.exports.luaG_runerror=F,e.exports.luaG_tointerror=function(e,t,n){!1===U.tointeger(t)&&(n=t),F(e,h("number%s has no integer representation",!0),G(e,n))},e.exports.luaG_traceexec=function(e){let t=e.ci,n=e.hookmask,s=0==--e.hookcount&&n&u;if(s)e.hookcount=e.basehookcount;else if(!(n&l))return;if(t.callstatus&E.CIST_HOOKYIELD)t.callstatus&=~E.CIST_HOOKYIELD;else{if(s&&b.luaD_hook(e,r,-1),n&l){let n=t.func.value.p,r=t.l_savedpc-1,u=0!==n.lineinfo.length?n.lineinfo[r]:-1;(0===r||t.l_savedpc<=e.oldpc||u!==(0!==n.lineinfo.length?n.lineinfo[e.oldpc-1]:-1))&&b.luaD_hook(e,a,u)}e.oldpc=t.l_savedpc,e.status===f&&(s&&(e.hookcount=1),t.l_savedpc--,t.callstatus|=E.CIST_HOOKYIELD,t.funcOff=e.top-1,t.func=e.stack[t.funcOff],b.luaD_throw(e,f))}},e.exports.luaG_typeerror=K,e.exports.lua_gethook=function(e){return e.hook},e.exports.lua_gethookcount=function(e){return e.basehookcount},e.exports.lua_gethookmask=function(e){return e.hookmask},e.exports.lua_getinfo=function(e,t,n){let r,a,u,l;return t=_(t),S(e),62===t[0]?(u=null,l=e.stack[e.top-1],L(e,l.ttisfunction(),"function expected"),t=t.subarray(1),e.top--):(l=(u=n.i_ci).func,g(u.func.ttisfunction())),r=function(e,t,n,r,a){let u=1;for(;t.length>0;t=t.subarray(1))switch(t[0]){case 83:M(n,r);break;case 108:n.currentline=a&&a.callstatus&E.CIST_LUA?w(a):-1;break;case 117:n.nups=null===r?0:r.nupvalues,null===r||r instanceof k.CClosure?(n.isvararg=!0,n.nparams=0):(n.isvararg=r.p.is_vararg,n.nparams=r.p.numparams);break;case 116:n.istailcall=a?a.callstatus&E.CIST_TAIL:0;break;case 110:{let t=P(e,a);null===t?(n.namewhat=h("",!0),n.name=null):(n.namewhat=t.funcname,n.name=t.name);break}case 76:case 102:break;default:u=0}return u}(e,t,n,a=l.ttisclosure()?l.value:null,u),d(t,102)>=0&&(k.pushobj2s(e,l),L(e,e.top<=e.ci.top,"stack overflow")),S(e),d(t,76)>=0&&function(e,t){if(null===t||t instanceof k.CClosure)e.stack[e.top]=new k.TValue(o,null),T.api_incr_top(e);else{let n=t.p.lineinfo,r=m.luaH_new(e);e.stack[e.top]=new k.TValue(i,r),T.api_incr_top(e);let a=new k.TValue(s,!0);for(let e=0;e<n.length;e++)m.luaH_setint(r,n[e],a)}}(e,a),r},e.exports.lua_getlocal=function(e,t,n){let r;if(S(e),null===t)r=e.stack[e.top-1].ttisLclosure()?x.luaF_getlocalname(e.stack[e.top-1].value.p,n,0):null;else{let a=I(e,t.i_ci,n);a?(r=a.name,k.pushobj2s(e,e.stack[a.pos]),L(e,e.top<=e.ci.top,"stack overflow")):r=null}return S(e),r},e.exports.lua_getstack=function(e,t,n){let r,a;if(t<0)return 0;for(r=e.ci;t>0&&r!==e.base_ci;r=r.previous)t--;return 0===t&&r!==e.base_ci?(a=1,n.i_ci=r):a=0,a},e.exports.lua_sethook=function(e,t,n,r){null!==t&&0!==n||(n=0,t=null),e.ci.callstatus&E.CIST_LUA&&(e.oldpc=e.ci.l_savedpc),e.hook=t,e.basehookcount=r,e.hookcount=e.basehookcount,e.hookmask=n},e.exports.lua_setlocal=function(e,t,n){let r;S(e);let a=I(e,t.i_ci,n);return a?(r=a.name,k.setobjs2s(e,a.pos,e.top-1),delete e.stack[--e.top]):r=null,S(e),r}},function(e,t,n){"use strict";const{LUA_MINSTACK:r,LUA_RIDX_GLOBALS:a,LUA_RIDX_MAINTHREAD:u,constant_types:{LUA_NUMTAGS:l,LUA_TNIL:s,LUA_TTABLE:o,LUA_TTHREAD:i},thread_status:{LUA_OK:c}}=n(1),f=n(6),_=n(8),p=n(18),d=n(9),h=n(14),L=2*r;class g{constructor(){this.func=null,this.funcOff=NaN,this.top=NaN,this.previous=null,this.next=null,this.l_base=NaN,this.l_code=null,this.l_savedpc=NaN,this.c_k=null,this.c_old_errfunc=null,this.c_ctx=null,this.nresults=NaN,this.callstatus=NaN}}class A{constructor(e){this.id=e.id_counter++,this.base_ci=new g,this.top=NaN,this.stack_last=NaN,this.oldpc=NaN,this.l_G=e,this.stack=null,this.ci=null,this.errorJmp=null,this.nCcalls=0,this.hook=null,this.hookmask=0,this.basehookcount=0,this.allowhook=1,this.hookcount=this.basehookcount,this.nny=1,this.status=c,this.errfunc=0}}const T=function(e){e.ci.next=null},b=function(e,t){e.stack=new Array(L),e.top=0,e.stack_last=L-5;let n=e.base_ci;n.next=n.previous=null,n.callstatus=0,n.funcOff=e.top,n.func=e.stack[e.top],e.stack[e.top++]=new f.TValue(s,null),n.top=e.top+r,e.ci=n},x=function(e){e.ci=e.base_ci,T(e),e.stack=null},O=function(e){let t=e.l_G;b(e),function(e,t){let n=d.luaH_new(e);t.l_registry.sethvalue(n),d.luaH_setint(n,u,new f.TValue(i,e)),d.luaH_setint(n,a,new f.TValue(o,d.luaH_new(e)))}(e,t),h.luaT_init(e),t.version=p.lua_version(null)};e.exports.lua_State=A,e.exports.CallInfo=g,e.exports.CIST_OAH=1,e.exports.CIST_LUA=2,e.exports.CIST_HOOKED=4,e.exports.CIST_FRESH=8,e.exports.CIST_YPCALL=16,e.exports.CIST_TAIL=32,e.exports.CIST_HOOKYIELD=64,e.exports.CIST_LEQ=128,e.exports.CIST_FIN=256,e.exports.EXTRA_STACK=5,e.exports.lua_close=function(e){!function(e){x(e)}(e=e.l_G.mainthread)},e.exports.lua_newstate=function(){let e=new class{constructor(){this.id_counter=1,this.ids=new WeakMap,this.mainthread=null,this.l_registry=new f.TValue(s,null),this.panic=null,this.atnativeerror=null,this.version=null,this.tmname=new Array(h.TMS.TM_N),this.mt=new Array(l)}},t=new A(e);return e.mainthread=t,_.luaD_rawrunprotected(t,O,null)!==c&&(t=null),t},e.exports.lua_newthread=function(e){let t=e.l_G,n=new A(t);return e.stack[e.top]=new f.TValue(i,n),p.api_incr_top(e),n.hookmask=e.hookmask,n.basehookcount=e.basehookcount,n.hook=e.hook,n.hookcount=n.basehookcount,b(n),n},e.exports.luaE_extendCI=function(e){let t=new g;return e.ci.next=t,t.previous=e.ci,t.next=null,e.ci=t,t},e.exports.luaE_freeCI=T,e.exports.luaE_freethread=function(e,t){x(t)}},function(e,t,n){"use strict";const{constant_types:{LUA_TNIL:r}}=n(1),a=n(6);e.exports.MAXUPVAL=255,e.exports.Proto=class{constructor(e){this.id=e.l_G.id_counter++,this.k=[],this.p=[],this.code=[],this.cache=null,this.lineinfo=[],this.upvalues=[],this.numparams=0,this.is_vararg=!1,this.maxstacksize=0,this.locvars=[],this.linedefined=0,this.lastlinedefined=0,this.source=null}},e.exports.luaF_findupval=function(e,t){return e.stack[t]},e.exports.luaF_close=function(e,t){for(let n=t;n<e.top;n++){let t=e.stack[n];e.stack[n]=new a.TValue(t.type,t.value)}},e.exports.luaF_getlocalname=function(e,t,n){for(let r=0;r<e.locvars.length&&e.locvars[r].startpc<=n;r++)if(n<e.locvars[r].endpc&&0==--t)return e.locvars[r].varname.getstr();return null},e.exports.luaF_initupvals=function(e,t){for(let n=0;n<t.nupvalues;n++)t.upvals[n]=new a.TValue(r,null)},e.exports.luaF_newLclosure=function(e,t){return new a.LClosure(e,t)}},function(e,t,n){"use strict";const{constant_types:{LUA_TTABLE:r,LUA_TUSERDATA:a},to_luastring:u}=n(1),{lua_assert:l}=n(4),s=n(6),o=n(8),i=n(12),{luaS_bless:c,luaS_new:f}=n(10),_=n(9),p=n(11),d=n(15),h=["no value","nil","boolean","userdata","number","string","table","function","userdata","thread","proto"].map((e=>u(e))),L=function(e){return h[e+1]},g={TM_INDEX:0,TM_NEWINDEX:1,TM_GC:2,TM_MODE:3,TM_LEN:4,TM_EQ:5,TM_ADD:6,TM_SUB:7,TM_MUL:8,TM_MOD:9,TM_POW:10,TM_DIV:11,TM_IDIV:12,TM_BAND:13,TM_BOR:14,TM_BXOR:15,TM_SHL:16,TM_SHR:17,TM_UNM:18,TM_BNOT:19,TM_LT:20,TM_LE:21,TM_CONCAT:22,TM_CALL:23,TM_N:24},A=u("__name",!0),T=function(e,t,n,r,a,u){let l=e.top;if(s.pushobj2s(e,t),s.pushobj2s(e,n),s.pushobj2s(e,r),u||s.pushobj2s(e,a),e.ci.callstatus&i.CIST_LUA?o.luaD_call(e,l,u):o.luaD_callnoyield(e,l,u),u){let t=e.stack[e.top-1];delete e.stack[--e.top],a.setfrom(t)}},b=function(e,t,n,r,a){let u=O(e,t,a);return u.ttisnil()&&(u=O(e,n,a)),!u.ttisnil()&&(T(e,u,t,n,r,1),!0)},x=function(e,t,n){const r=_.luaH_getstr(e,n);return l(t<=g.TM_EQ),r.ttisnil()?(e.flags|=1<<t,null):r},O=function(e,t,n){let u;switch(t.ttnov()){case r:case a:u=t.value.metatable;break;default:u=e.l_G.mt[t.ttnov()]}return u?_.luaH_getstr(u,e.l_G.tmname[n]):s.luaO_nilobject};e.exports.fasttm=function(e,t,n){return null===t||t.flags&1<<n?null:x(t,n,e.l_G.tmname[n])},e.exports.TMS=g,e.exports.luaT_callTM=T,e.exports.luaT_callbinTM=b,e.exports.luaT_trybinTM=function(e,t,n,r,a){if(!b(e,t,n,r,a))switch(a){case g.TM_CONCAT:return p.luaG_concaterror(e,t,n);case g.TM_BAND:case g.TM_BOR:case g.TM_BXOR:case g.TM_SHL:case g.TM_SHR:case g.TM_BNOT:{let r=d.tonumber(t),a=d.tonumber(n);return!1!==r&&!1!==a?p.luaG_tointerror(e,t,n):p.luaG_opinterror(e,t,n,u("perform bitwise operation on",!0))}default:return p.luaG_opinterror(e,t,n,u("perform arithmetic on",!0))}},e.exports.luaT_callorderTM=function(e,t,n,r){let a=new s.TValue;return b(e,t,n,a,r)?!a.l_isfalse():null},e.exports.luaT_gettm=x,e.exports.luaT_gettmbyobj=O,e.exports.luaT_init=function(e){e.l_G.tmname[g.TM_INDEX]=new f(e,u("__index",!0)),e.l_G.tmname[g.TM_NEWINDEX]=new f(e,u("__newindex",!0)),e.l_G.tmname[g.TM_GC]=new f(e,u("__gc",!0)),e.l_G.tmname[g.TM_MODE]=new f(e,u("__mode",!0)),e.l_G.tmname[g.TM_LEN]=new f(e,u("__len",!0)),e.l_G.tmname[g.TM_EQ]=new f(e,u("__eq",!0)),e.l_G.tmname[g.TM_ADD]=new f(e,u("__add",!0)),e.l_G.tmname[g.TM_SUB]=new f(e,u("__sub",!0)),e.l_G.tmname[g.TM_MUL]=new f(e,u("__mul",!0)),e.l_G.tmname[g.TM_MOD]=new f(e,u("__mod",!0)),e.l_G.tmname[g.TM_POW]=new f(e,u("__pow",!0)),e.l_G.tmname[g.TM_DIV]=new f(e,u("__div",!0)),e.l_G.tmname[g.TM_IDIV]=new f(e,u("__idiv",!0)),e.l_G.tmname[g.TM_BAND]=new f(e,u("__band",!0)),e.l_G.tmname[g.TM_BOR]=new f(e,u("__bor",!0)),e.l_G.tmname[g.TM_BXOR]=new f(e,u("__bxor",!0)),e.l_G.tmname[g.TM_SHL]=new f(e,u("__shl",!0)),e.l_G.tmname[g.TM_SHR]=new f(e,u("__shr",!0)),e.l_G.tmname[g.TM_UNM]=new f(e,u("__unm",!0)),e.l_G.tmname[g.TM_BNOT]=new f(e,u("__bnot",!0)),e.l_G.tmname[g.TM_LT]=new f(e,u("__lt",!0)),e.l_G.tmname[g.TM_LE]=new f(e,u("__le",!0)),e.l_G.tmname[g.TM_CONCAT]=new f(e,u("__concat",!0)),e.l_G.tmname[g.TM_CALL]=new f(e,u("__call",!0))},e.exports.luaT_objtypename=function(e,t){let n;if(t.ttistable()&&null!==(n=t.value.metatable)||t.ttisfulluserdata()&&null!==(n=t.value.metatable)){let t=_.luaH_getstr(n,c(e,A));if(t.ttisstring())return t.svalue()}return L(t.ttnov())},e.exports.ttypename=L},function(e,t,n){"use strict";const{LUA_MASKLINE:r,LUA_MASKCOUNT:a,LUA_MULTRET:u,constant_types:{LUA_TBOOLEAN:l,LUA_TLCF:s,LUA_TLIGHTUSERDATA:o,LUA_TLNGSTR:i,LUA_TNIL:c,LUA_TNUMBER:f,LUA_TNUMFLT:_,LUA_TNUMINT:p,LUA_TSHRSTR:d,LUA_TTABLE:h,LUA_TUSERDATA:L},to_luastring:g}=n(1),{INDEXK:A,ISK:T,LFIELDS_PER_FLUSH:b,OpCodesI:{OP_ADD:x,OP_BAND:O,OP_BNOT:k,OP_BOR:v,OP_BXOR:E,OP_CALL:m,OP_CLOSURE:R,OP_CONCAT:U,OP_DIV:N,OP_EQ:w,OP_EXTRAARG:S,OP_FORLOOP:y,OP_FORPREP:I,OP_GETTABLE:M,OP_GETTABUP:P,OP_GETUPVAL:C,OP_IDIV:D,OP_JMP:V,OP_LE:B,OP_LEN:G,OP_LOADBOOL:K,OP_LOADK:j,OP_LOADKX:F,OP_LOADNIL:H,OP_LT:X,OP_MOD:z,OP_MOVE:Y,OP_MUL:J,OP_NEWTABLE:q,OP_NOT:Z,OP_POW:W,OP_RETURN:Q,OP_SELF:$,OP_SETLIST:ee,OP_SETTABLE:te,OP_SETTABUP:ne,OP_SETUPVAL:re,OP_SHL:ae,OP_SHR:ue,OP_SUB:le,OP_TAILCALL:se,OP_TEST:oe,OP_TESTSET:ie,OP_TFORCALL:ce,OP_TFORLOOP:fe,OP_UNM:_e,OP_VARARG:pe}}=n(16),{LUA_MAXINTEGER:de,LUA_MININTEGER:he,lua_numbertointeger:Le}=n(3),{lua_assert:ge,luai_nummod:Ae}=n(4),Te=n(6),be=n(13),xe=n(12),{luaS_bless:Oe,luaS_eqlngstr:ke,luaS_hashlongstr:ve}=n(10),Ee=n(8),me=n(14),Re=n(9),Ue=n(11),Ne=function(e,t,n){return t+n.A},we=function(e,t,n){return t+n.B},Se=function(e,t,n,r){return T(r.B)?n[A(r.B)]:e.stack[t+r.B]},ye=function(e,t,n,r){return T(r.C)?n[A(r.C)]:e.stack[t+r.C]},Ie=function(e,t,n,r){let a=n.A;0!==a&&be.luaF_close(e,t.l_base+a-1),t.l_savedpc+=n.sBx+r},Me=function(e,t){Ie(e,t,t.l_code[t.l_savedpc],1)},Pe=function(e,t,n){if(t.ttisnumber()&&n.ttisnumber())return je(t,n)?1:0;if(t.ttisstring()&&n.ttisstring())return He(t.tsvalue(),n.tsvalue())<0?1:0;{let r=me.luaT_callorderTM(e,t,n,me.TMS.TM_LT);return null===r&&Ue.luaG_ordererror(e,t,n),r?1:0}},Ce=function(e,t,n){let r;return t.ttisnumber()&&n.ttisnumber()?Fe(t,n)?1:0:t.ttisstring()&&n.ttisstring()?He(t.tsvalue(),n.tsvalue())<=0?1:0:null!==(r=me.luaT_callorderTM(e,t,n,me.TMS.TM_LE))?r?1:0:(e.ci.callstatus|=xe.CIST_LEQ,r=me.luaT_callorderTM(e,n,t,me.TMS.TM_LT),e.ci.callstatus^=xe.CIST_LEQ,null===r&&Ue.luaG_ordererror(e,t,n),r?0:1)},De=function(e,t,n){if(t.ttype()!==n.ttype())return t.ttnov()!==n.ttnov()||t.ttnov()!==f?0:t.value===n.value?1:0;let r;switch(t.ttype()){case c:return 1;case l:return t.value==n.value?1:0;case o:case p:case _:case s:return t.value===n.value?1:0;case d:case i:return ke(t.tsvalue(),n.tsvalue())?1:0;case L:case h:if(t.value===n.value)return 1;if(null===e)return 0;null===(r=me.fasttm(e,t.value.metatable,me.TMS.TM_EQ))&&(r=me.fasttm(e,n.value.metatable,me.TMS.TM_EQ));break;default:return t.value===n.value?1:0}if(null===r)return 0;let a=new Te.TValue;return me.luaT_callTM(e,r,t,n,a,1),a.l_isfalse()?0:1},Ve=function(e,t){let n=!1,r=Be(e,t<0?2:1);if(!1===r){let a=Ke(e);if(!1===a)return!1;0<a?(r=de,t<0&&(n=!0)):(r=he,t>=0&&(n=!0))}return{stopnow:n,ilimit:r}},Be=function(e,t){if(e.ttisfloat()){let n=e.value,r=Math.floor(n);if(n!==r){if(0===t)return!1;t>1&&(r+=1)}return Le(r)}if(e.ttisinteger())return e.value;if($e(e)){let n=new Te.TValue;if(Te.luaO_str2num(e.svalue(),n)===e.vslen()+1)return Be(n,t)}return!1},Ge=function(e){return e.ttisinteger()?e.value:Be(e,0)},Ke=function(e){if(e.ttnov()===f)return e.value;if($e(e)){let t=new Te.TValue;if(Te.luaO_str2num(e.svalue(),t)===e.vslen()+1)return t.value}return!1},je=function(e,t){return e.value<t.value},Fe=function(e,t){return e.value<=t.value},He=function(e,t){let n=ve(e),r=ve(t);return n===r?0:n<r?-1:1},Xe=function(e,t,n){let r;switch(n.ttype()){case h:{let a=n.value;if(null!==(r=me.fasttm(e,a.metatable,me.TMS.TM_LEN)))break;return void t.setivalue(Re.luaH_getn(a))}case d:case i:return void t.setivalue(n.vslen());default:(r=me.luaT_gettmbyobj(e,n,me.TMS.TM_LEN)).ttisnil()&&Ue.luaG_typeerror(e,n,g("get length of",!0))}me.luaT_callTM(e,r,n,n,t,1)},ze=Math.imul||function(e,t){let n=65535&e,r=65535&t;return n*r+((e>>>16&65535)*r+n*(t>>>16&65535)<<16>>>0)|0},Ye=function(e,t,n){return 0===n&&Ue.luaG_runerror(e,g("attempt to divide by zero")),0|Math.floor(t/n)},Je=function(e,t,n){return 0===n&&Ue.luaG_runerror(e,g("attempt to perform 'n%%0'")),t-Math.floor(t/n)*n|0},qe=function(e,t){return t<0?t<=-32?0:e>>>-t:t>=32?0:e<<t},Ze=function(e,t,n,r){let a=e.cache;if(null!==a){let u=e.upvalues,l=u.length;for(let e=0;e<l;e++){let l=u[e].instack?n[r+u[e].idx]:t[u[e].idx];if(a.upvals[e]!==l)return null}}return a},We=function(e,t,n,r,a){let u=t.upvalues.length,l=t.upvalues,s=new Te.LClosure(e,u);s.p=t,e.stack[a].setclLvalue(s);for(let o=0;o<u;o++)l[o].instack?s.upvals[o]=be.luaF_findupval(e,r+l[o].idx):s.upvals[o]=n[l[o].idx];t.cache=s},Qe=function(e){return e.ttisnumber()},$e=function(e){return e.ttisstring()},et=function(e,t){let n=e.stack[t];return!!n.ttisstring()||!!Qe(n)&&(Te.luaO_tostring(e,n),!0)},tt=function(e){return e.ttisstring()&&0===e.vslen()},nt=function(e,t,n,r){let a=0;do{let u=e.stack[t-n],l=u.vslen(),s=u.svalue();r.set(s,a),a+=l}while(--n>0)},rt=function(e,t){ge(t>=2);do{let n=e.top,r=2;if((e.stack[n-2].ttisstring()||Qe(e.stack[n-2]))&&et(e,n-1))if(tt(e.stack[n-1]))et(e,n-2);else if(tt(e.stack[n-2]))Te.setobjs2s(e,n-2,n-1);else{let a=e.stack[n-1].vslen();for(r=1;r<t&&et(e,n-r-1);r++)a+=e.stack[n-r-1].vslen();let u=new Uint8Array(a);nt(e,n,r,u);let l=Oe(e,u);Te.setsvalue2s(e,n-r,l)}else me.luaT_trybinTM(e,e.stack[n-2],e.stack[n-1],e.stack[n-2],me.TMS.TM_CONCAT);for(t-=r-1;e.top>n-(r-1);)delete e.stack[--e.top]}while(t>1)},at=function(e,t,n,r){for(let a=0;a<2e3;a++){let a;if(t.ttistable()){let u=Re.luaH_get(e,t.value,n);if(!u.ttisnil())return void Te.setobj2s(e,r,u);if(null===(a=me.fasttm(e,t.value.metatable,me.TMS.TM_INDEX)))return void e.stack[r].setnilvalue()}else(a=me.luaT_gettmbyobj(e,t,me.TMS.TM_INDEX)).ttisnil()&&Ue.luaG_typeerror(e,t,g("index",!0));if(a.ttisfunction())return void me.luaT_callTM(e,a,t,n,e.stack[r],1);t=a}Ue.luaG_runerror(e,g("'__index' chain too long; possible loop",!0))},ut=function(e,t,n,r){for(let a=0;a<2e3;a++){let a;if(t.ttistable()){let u=t.value;if(!Re.luaH_get(e,u,n).ttisnil()||null===(a=me.fasttm(e,u.metatable,me.TMS.TM_NEWINDEX)))return Re.luaH_setfrom(e,u,n,r),void Re.invalidateTMcache(u)}else(a=me.luaT_gettmbyobj(e,t,me.TMS.TM_NEWINDEX)).ttisnil()&&Ue.luaG_typeerror(e,t,g("index",!0));if(a.ttisfunction())return void me.luaT_callTM(e,a,t,n,r,0);t=a}Ue.luaG_runerror(e,g("'__newindex' chain too long; possible loop",!0))};e.exports.cvt2str=Qe,e.exports.cvt2num=$e,e.exports.luaV_gettable=at,e.exports.luaV_concat=rt,e.exports.luaV_div=Ye,e.exports.luaV_equalobj=De,e.exports.luaV_execute=function(e){let t=e.ci;t.callstatus|=xe.CIST_FRESH;e:for(;;){ge(t===e.ci);let n=t.func.value,l=n.p.k,s=t.l_base,o=t.l_code[t.l_savedpc++];e.hookmask&(r|a)&&Ue.luaG_traceexec(e);let i=Ne(0,s,o);switch(o.opcode){case Y:Te.setobjs2s(e,i,we(0,s,o));break;case j:{let t=l[o.Bx];Te.setobj2s(e,i,t);break}case F:{ge(t.l_code[t.l_savedpc].opcode===S);let n=l[t.l_code[t.l_savedpc++].Ax];Te.setobj2s(e,i,n);break}case K:e.stack[i].setbvalue(0!==o.B),0!==o.C&&t.l_savedpc++;break;case H:for(let t=0;t<=o.B;t++)e.stack[i+t].setnilvalue();break;case C:{let t=o.B;Te.setobj2s(e,i,n.upvals[t]);break}case P:{let t=n.upvals[o.B],r=ye(e,s,l,o);at(e,t,r,i);break}case M:{let t=e.stack[we(0,s,o)],n=ye(e,s,l,o);at(e,t,n,i);break}case ne:{let t=n.upvals[o.A],r=Se(e,s,l,o),a=ye(e,s,l,o);ut(e,t,r,a);break}case re:n.upvals[o.B].setfrom(e.stack[i]);break;case te:{let t=e.stack[i],n=Se(e,s,l,o),r=ye(e,s,l,o);ut(e,t,n,r);break}case q:e.stack[i].sethvalue(Re.luaH_new(e));break;case $:{let t=we(0,s,o),n=ye(e,s,l,o);Te.setobjs2s(e,i+1,t),at(e,e.stack[t],n,i);break}case x:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(r.value+a.value|0):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(t+n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_ADD);break}case le:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(r.value-a.value|0):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(t-n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_SUB);break}case J:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(ze(r.value,a.value)):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(t*n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_MUL);break}case z:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(Je(e,r.value,a.value)):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(Ae(e,t,n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_MOD);break}case W:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(Math.pow(t,n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_POW);break}case N:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(t/n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_DIV);break}case D:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);r.ttisinteger()&&a.ttisinteger()?e.stack[i].setivalue(Ye(e,r.value,a.value)):!1!==(t=Ke(r))&&!1!==(n=Ke(a))?e.stack[i].setfltvalue(Math.floor(t/n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_IDIV);break}case O:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(t&n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_BAND);break}case v:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(t|n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_BOR);break}case E:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(t^n):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_BXOR);break}case ae:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(qe(t,n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_SHL);break}case ue:{let t,n,r=Se(e,s,l,o),a=ye(e,s,l,o);!1!==(t=Ge(r))&&!1!==(n=Ge(a))?e.stack[i].setivalue(qe(t,-n)):me.luaT_trybinTM(e,r,a,e.stack[i],me.TMS.TM_SHR);break}case _e:{let t,n=e.stack[we(0,s,o)];n.ttisinteger()?e.stack[i].setivalue(0|-n.value):!1!==(t=Ke(n))?e.stack[i].setfltvalue(-t):me.luaT_trybinTM(e,n,n,e.stack[i],me.TMS.TM_UNM);break}case k:{let t=e.stack[we(0,s,o)];t.ttisinteger()?e.stack[i].setivalue(~t.value):me.luaT_trybinTM(e,t,t,e.stack[i],me.TMS.TM_BNOT);break}case Z:{let t=e.stack[we(0,s,o)];e.stack[i].setbvalue(t.l_isfalse());break}case G:Xe(e,e.stack[i],e.stack[we(0,s,o)]);break;case U:{let n=o.B,r=o.C;e.top=s+r+1,rt(e,r-n+1);let a=s+n;Te.setobjs2s(e,i,a),Ee.adjust_top(e,t.top);break}case V:Ie(e,t,o,0);break;case w:De(e,Se(e,s,l,o),ye(e,s,l,o))!==o.A?t.l_savedpc++:Me(e,t);break;case X:Pe(e,Se(e,s,l,o),ye(e,s,l,o))!==o.A?t.l_savedpc++:Me(e,t);break;case B:Ce(e,Se(e,s,l,o),ye(e,s,l,o))!==o.A?t.l_savedpc++:Me(e,t);break;case oe:(o.C?e.stack[i].l_isfalse():!e.stack[i].l_isfalse())?t.l_savedpc++:Me(e,t);break;case ie:{let n=we(0,s,o),r=e.stack[n];(o.C?r.l_isfalse():!r.l_isfalse())?t.l_savedpc++:(Te.setobjs2s(e,i,n),Me(e,t));break}case m:{let n=o.B,r=o.C-1;if(0!==n&&Ee.adjust_top(e,i+n),!Ee.luaD_precall(e,i,r)){t=e.ci;continue e}r>=0&&Ee.adjust_top(e,t.top);break}case se:{let r=o.B;if(0!==r&&Ee.adjust_top(e,i+r),!Ee.luaD_precall(e,i,u)){let r=e.ci,a=r.previous,u=r.func,l=r.funcOff,s=a.funcOff,o=r.l_base+u.value.p.numparams;n.p.p.length>0&&be.luaF_close(e,a.l_base);for(let t=0;l+t<o;t++)Te.setobjs2s(e,s+t,l+t);a.l_base=s+(r.l_base-l),a.top=s+(e.top-l),Ee.adjust_top(e,a.top),a.l_code=r.l_code,a.l_savedpc=r.l_savedpc,a.callstatus|=xe.CIST_TAIL,a.next=null,t=e.ci=a,ge(e.top===a.l_base+e.stack[s].value.p.maxstacksize);continue e}break}case Q:{n.p.p.length>0&&be.luaF_close(e,s);let r=Ee.luaD_poscall(e,t,i,0!==o.B?o.B-1:e.top-i);if(t.callstatus&xe.CIST_FRESH)return;t=e.ci,r&&Ee.adjust_top(e,t.top),ge(t.callstatus&xe.CIST_LUA),ge(t.l_code[t.l_savedpc-1].opcode===m);continue e}case y:if(e.stack[i].ttisinteger()){let n=e.stack[i+2].value,r=e.stack[i].value+n|0,a=e.stack[i+1].value;(0<n?r<=a:a<=r)&&(t.l_savedpc+=o.sBx,e.stack[i].chgivalue(r),e.stack[i+3].setivalue(r))}else{let n=e.stack[i+2].value,r=e.stack[i].value+n,a=e.stack[i+1].value;(0<n?r<=a:a<=r)&&(t.l_savedpc+=o.sBx,e.stack[i].chgfltvalue(r),e.stack[i+3].setfltvalue(r))}break;case I:{let n,r=e.stack[i],a=e.stack[i+1],u=e.stack[i+2];if(r.ttisinteger()&&u.ttisinteger()&&(n=Ve(a,u.value))){let e=n.stopnow?0:r.value;a.value=n.ilimit,r.value=e-u.value|0}else{let t,n,l;!1===(t=Ke(a))&&Ue.luaG_runerror(e,g("'for' limit must be a number",!0)),e.stack[i+1].setfltvalue(t),!1===(n=Ke(u))&&Ue.luaG_runerror(e,g("'for' step must be a number",!0)),e.stack[i+2].setfltvalue(n),!1===(l=Ke(r))&&Ue.luaG_runerror(e,g("'for' initial value must be a number",!0)),e.stack[i].setfltvalue(l-n)}t.l_savedpc+=o.sBx;break}case ce:{let n=i+3;Te.setobjs2s(e,n+2,i+2),Te.setobjs2s(e,n+1,i+1),Te.setobjs2s(e,n,i),Ee.adjust_top(e,n+3),Ee.luaD_call(e,n,o.C),Ee.adjust_top(e,t.top),o=t.l_code[t.l_savedpc++],i=Ne(0,s,o),ge(o.opcode===fe)}case fe:e.stack[i+1].ttisnil()||(Te.setobjs2s(e,i,i+1),t.l_savedpc+=o.sBx);break;case ee:{let n=o.B,r=o.C;0===n&&(n=e.top-i-1),0===r&&(ge(t.l_code[t.l_savedpc].opcode===S),r=t.l_code[t.l_savedpc++].Ax);let a=e.stack[i].value,u=(r-1)*b+n;for(;n>0;n--)Re.luaH_setint(a,u--,e.stack[i+n]);Ee.adjust_top(e,t.top);break}case R:{let t=n.p.p[o.Bx],r=Ze(t,n.upvals,e.stack,s);null===r?We(e,t,n.upvals,s,i):e.stack[i].setclLvalue(r);break}case pe:{let r,a=o.B-1,u=s-t.funcOff-n.p.numparams-1;for(u<0&&(u=0),a<0&&(a=u,Ee.luaD_checkstack(e,u),Ee.adjust_top(e,i+u)),r=0;r<a&&r<u;r++)Te.setobjs2s(e,i+r,s-u+r);for(;r<a;r++)e.stack[i+r].setnilvalue();break}case S:throw Error("invalid opcode")}}},e.exports.luaV_finishOp=function(e){let t=e.ci,n=t.l_base,r=t.l_code[t.l_savedpc-1],a=r.opcode;switch(a){case x:case le:case J:case N:case D:case O:case v:case E:case ae:case ue:case z:case W:case _e:case k:case G:case P:case M:case $:Te.setobjs2s(e,n+r.A,e.top-1),delete e.stack[--e.top];break;case B:case X:case w:{let n=!e.stack[e.top-1].l_isfalse();delete e.stack[--e.top],t.callstatus&xe.CIST_LEQ&&(ge(a===B),t.callstatus^=xe.CIST_LEQ,n=!n),ge(t.l_code[t.l_savedpc].opcode===V),n!==!!r.A&&t.l_savedpc++;break}case U:{let a=e.top-1,u=a-1-(n+r.B);Te.setobjs2s(e,a-2,a),u>1&&(e.top=a-1,rt(e,u)),Te.setobjs2s(e,t.l_base+r.A,e.top-1),Ee.adjust_top(e,t.top);break}case ce:ge(t.l_code[t.l_savedpc].opcode===fe),Ee.adjust_top(e,t.top);break;case m:r.C-1>=0&&Ee.adjust_top(e,t.top)}},e.exports.luaV_imul=ze,e.exports.luaV_lessequal=Ce,e.exports.luaV_lessthan=Pe,e.exports.luaV_mod=Je,e.exports.luaV_objlen=Xe,e.exports.luaV_rawequalobj=function(e,t){return De(null,e,t)},e.exports.luaV_shiftl=qe,e.exports.luaV_tointeger=Be,e.exports.settable=ut,e.exports.tointeger=Ge,e.exports.tonumber=Ke},function(e,t,n){"use strict";const r=[96,113,65,84,80,80,92,108,60,16,60,84,108,124,124,124,124,124,124,124,124,124,124,124,124,96,96,96,96,104,34,188,188,188,132,228,84,84,16,98,98,4,98,20,81,80,23],a=function(e,t){return~(-1<<e)<<t},u=function(e,t){return~a(e,t)},l=function(e,t,n,r){return e.code=e.code&u(r,n)|t<<n&a(r,n),o(e)},s=function(e,t){return l(e,t,14,18)},o=function(e){if("number"==typeof e)return{code:e,opcode:e>>0&a(6,0),A:e>>6&a(8,0),B:e>>23&a(9,0),C:e>>14&a(9,0),Bx:e>>14&a(18,0),Ax:e>>6&a(26,0),sBx:(e>>14&a(18,0))-131071};{let t=e.code;return e.opcode=t>>0&a(6,0),e.A=t>>6&a(8,0),e.B=t>>23&a(9,0),e.C=t>>14&a(9,0),e.Bx=t>>14&a(18,0),e.Ax=t>>6&a(26,0),e.sBx=(t>>14&a(18,0))-131071,e}};e.exports.BITRK=256,e.exports.CREATE_ABC=function(e,t,n,r){return o(e<<0|t<<6|n<<23|r<<14)},e.exports.CREATE_ABx=function(e,t,n){return o(e<<0|t<<6|n<<14)},e.exports.CREATE_Ax=function(e,t){return o(e<<0|t<<6)},e.exports.GET_OPCODE=function(e){return e.opcode},e.exports.GETARG_A=function(e){return e.A},e.exports.GETARG_B=function(e){return e.B},e.exports.GETARG_C=function(e){return e.C},e.exports.GETARG_Bx=function(e){return e.Bx},e.exports.GETARG_Ax=function(e){return e.Ax},e.exports.GETARG_sBx=function(e){return e.sBx},e.exports.INDEXK=function(e){return-257&e},e.exports.ISK=function(e){return 256&e},e.exports.LFIELDS_PER_FLUSH=50,e.exports.MAXARG_A=255,e.exports.MAXARG_Ax=67108863,e.exports.MAXARG_B=511,e.exports.MAXARG_Bx=262143,e.exports.MAXARG_C=511,e.exports.MAXARG_sBx=131071,e.exports.MAXINDEXRK=255,e.exports.NO_REG=255,e.exports.OpArgK=3,e.exports.OpArgN=0,e.exports.OpArgR=2,e.exports.OpArgU=1,e.exports.OpCodes=["MOVE","LOADK","LOADKX","LOADBOOL","LOADNIL","GETUPVAL","GETTABUP","GETTABLE","SETTABUP","SETUPVAL","SETTABLE","NEWTABLE","SELF","ADD","SUB","MUL","MOD","POW","DIV","IDIV","BAND","BOR","BXOR","SHL","SHR","UNM","BNOT","NOT","LEN","CONCAT","JMP","EQ","LT","LE","TEST","TESTSET","CALL","TAILCALL","RETURN","FORLOOP","FORPREP","TFORCALL","TFORLOOP","SETLIST","CLOSURE","VARARG","EXTRAARG"],e.exports.OpCodesI={OP_MOVE:0,OP_LOADK:1,OP_LOADKX:2,OP_LOADBOOL:3,OP_LOADNIL:4,OP_GETUPVAL:5,OP_GETTABUP:6,OP_GETTABLE:7,OP_SETTABUP:8,OP_SETUPVAL:9,OP_SETTABLE:10,OP_NEWTABLE:11,OP_SELF:12,OP_ADD:13,OP_SUB:14,OP_MUL:15,OP_MOD:16,OP_POW:17,OP_DIV:18,OP_IDIV:19,OP_BAND:20,OP_BOR:21,OP_BXOR:22,OP_SHL:23,OP_SHR:24,OP_UNM:25,OP_BNOT:26,OP_NOT:27,OP_LEN:28,OP_CONCAT:29,OP_JMP:30,OP_EQ:31,OP_LT:32,OP_LE:33,OP_TEST:34,OP_TESTSET:35,OP_CALL:36,OP_TAILCALL:37,OP_RETURN:38,OP_FORLOOP:39,OP_FORPREP:40,OP_TFORCALL:41,OP_TFORLOOP:42,OP_SETLIST:43,OP_CLOSURE:44,OP_VARARG:45,OP_EXTRAARG:46},e.exports.POS_A=6,e.exports.POS_Ax=6,e.exports.POS_B=23,e.exports.POS_Bx=14,e.exports.POS_C=14,e.exports.POS_OP=0,e.exports.RKASK=function(e){return 256|e},e.exports.SETARG_A=function(e,t){return l(e,t,6,8)},e.exports.SETARG_Ax=function(e,t){return l(e,t,6,26)},e.exports.SETARG_B=function(e,t){return l(e,t,23,9)},e.exports.SETARG_Bx=s,e.exports.SETARG_C=function(e,t){return l(e,t,14,9)},e.exports.SETARG_sBx=function(e,t){return s(e,t+131071)},e.exports.SET_OPCODE=function(e,t){return e.code=e.code&u(6,0)|t<<0&a(6,0),o(e)},e.exports.SIZE_A=8,e.exports.SIZE_Ax=26,e.exports.SIZE_B=9,e.exports.SIZE_Bx=18,e.exports.SIZE_C=9,e.exports.SIZE_OP=6,e.exports.fullins=o,e.exports.getBMode=function(e){return r[e]>>4&3},e.exports.getCMode=function(e){return r[e]>>2&3},e.exports.getOpMode=function(e){return 3&r[e]},e.exports.iABC=0,e.exports.iABx=1,e.exports.iAsBx=2,e.exports.iAx=3,e.exports.testAMode=function(e){return 64&r[e]},e.exports.testTMode=function(e){return 128&r[e]}},function(e,t,n){"use strict";const{LUA_VERSION_MAJOR:r,LUA_VERSION_MINOR:a}=n(2),u="_"+r+"_"+a;e.exports.LUA_VERSUFFIX=u,e.exports.lua_assert=function(e){},e.exports.luaopen_base=n(24).luaopen_base,e.exports.LUA_COLIBNAME="coroutine",e.exports.luaopen_coroutine=n(25).luaopen_coroutine,e.exports.LUA_TABLIBNAME="table",e.exports.luaopen_table=n(26).luaopen_table,e.exports.LUA_OSLIBNAME="os",e.exports.luaopen_os=n(27).luaopen_os,e.exports.LUA_STRLIBNAME="string",e.exports.luaopen_string=n(28).luaopen_string,e.exports.LUA_UTF8LIBNAME="utf8",e.exports.luaopen_utf8=n(29).luaopen_utf8,e.exports.LUA_BITLIBNAME="bit32",e.exports.LUA_MATHLIBNAME="math",e.exports.luaopen_math=n(30).luaopen_math,e.exports.LUA_DBLIBNAME="debug",e.exports.luaopen_debug=n(31).luaopen_debug,e.exports.LUA_LOADLIBNAME="package",e.exports.luaopen_package=n(32).luaopen_package,e.exports.LUA_FENGARILIBNAME="fengari",e.exports.luaopen_fengari=n(33).luaopen_fengari;const l=n(39);e.exports.luaL_openlibs=l.luaL_openlibs},function(e,t,n){"use strict";const{LUA_MULTRET:r,LUA_OPBNOT:a,LUA_OPEQ:u,LUA_OPLE:l,LUA_OPLT:s,LUA_OPUNM:o,LUA_REGISTRYINDEX:i,LUA_RIDX_GLOBALS:c,LUA_VERSION_NUM:f,constant_types:{LUA_NUMTAGS:_,LUA_TBOOLEAN:p,LUA_TCCL:d,LUA_TFUNCTION:h,LUA_TLCF:L,LUA_TLCL:g,LUA_TLIGHTUSERDATA:A,LUA_TLNGSTR:T,LUA_TNIL:b,LUA_TNONE:x,LUA_TNUMFLT:O,LUA_TNUMINT:k,LUA_TSHRSTR:v,LUA_TTABLE:E,LUA_TTHREAD:m,LUA_TUSERDATA:R},thread_status:{LUA_OK:U},from_userstring:N,to_luastring:w}=n(1),{api_check:S}=n(4),y=n(11),I=n(8),{luaU_dump:M}=n(37),P=n(13),C=n(6),D=n(12),{luaS_bless:V,luaS_new:B,luaS_newliteral:G}=n(10),K=n(14),{LUAI_MAXSTACK:j}=n(3),F=n(15),H=n(9),{ZIO:X}=n(19),z=C.TValue,Y=C.CClosure,J=function(e){e.top++,S(e,e.top<=e.ci.top,"stack overflow")},q=function(e,t){S(e,t<e.top-e.ci.funcOff,"not enough elements in the stack")},Z=function(e){if(!e)throw TypeError("invalid argument")},W=function(e){Z("number"==typeof e&&(0|e)===e)},Q=function(e){return e!==C.luaO_nilobject},$=function(e,t){let n=e.ci;if(t>0){let r=n.funcOff+t;return S(e,t<=n.top-(n.funcOff+1),"unacceptable index"),r>=e.top?C.luaO_nilobject:e.stack[r]}return t>i?(S(e,0!==t&&-t<=e.top,"invalid index"),e.stack[e.top+t]):t===i?e.l_G.l_registry:(S(e,(t=i-t)<=P.MAXUPVAL+1,"upvalue index too large"),n.func.ttislcf()?C.luaO_nilobject:t<=n.func.value.nupvalues?n.func.value.upvalue[t-1]:C.luaO_nilobject)},ee=function(e,t){let n=e.ci;if(t>0){let r=n.funcOff+t;return S(e,t<=n.top-(n.funcOff+1),"unacceptable index"),r>=e.top?null:r}if(t>i)return S(e,0!==t&&-t<=e.top,"invalid index"),e.top+t;throw Error("attempt to use pseudo-index")},te=function(e,t){let n,r=e.ci.funcOff;t>=0?(S(e,t<=e.stack_last-(r+1),"new top too large"),n=r+1+t):(S(e,-(t+1)<=e.top-(r+1),"invalid new top"),n=e.top+t+1),I.adjust_top(e,n)},ne=function(e,t){te(e,-t-1)},re=function(e,t,n){for(;t<n;t++,n--){let r=e.stack[t],a=new z(r.type,r.value);C.setobjs2s(e,t,n),C.setobj2s(e,n,a)}},ae=function(e,t,n){let r=e.top-1,a=ee(e,t),u=e.stack[a];S(e,Q(u)&&t>i,"index not in the stack"),S(e,(n>=0?n:-n)<=r-a+1,"invalid 'n'");let l=n>=0?r-n:a-n-1;re(e,a,l),re(e,l+1,e.top-1),re(e,a,e.top-1)},ue=function(e,t,n){let r=$(e,t);$(e,n).setfrom(r)},le=function(e,t,n){if(Z("function"==typeof t),W(n),0===n)e.stack[e.top]=new z(L,t);else{q(e,n),S(e,n<=P.MAXUPVAL,"upvalue index too large");let r=new Y(e,t,n);for(let t=0;t<n;t++)r.upvalue[t].setfrom(e.stack[e.top-n+t]);for(let t=1;t<n;t++)delete e.stack[--e.top];n>0&&--e.top,e.stack[e.top].setclCvalue(r)}J(e)},se=le,oe=function(e,t){le(e,t,0)},ie=oe,ce=function(e,t,n){let r=B(e,N(n));q(e,1),C.pushsvalue2s(e,r),S(e,e.top<=e.ci.top,"stack overflow"),F.settable(e,t,e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top],delete e.stack[--e.top]},fe=function(e,t){ce(e,H.luaH_getint(e.l_G.l_registry.value,c),t)},_e=function(e,t,n){let r=B(e,N(n));return C.pushsvalue2s(e,r),S(e,e.top<=e.ci.top,"stack overflow"),F.luaV_gettable(e,t,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},pe=function(e,t,n){let r=$(e,t);return W(n),S(e,r.ttistable(),"table expected"),C.pushobj2s(e,H.luaH_getint(r.value,n)),S(e,e.top<=e.ci.top,"stack overflow"),e.stack[e.top-1].ttnov()},de=function(e,t,n){let r=new C.TValue(E,H.luaH_new(e));e.stack[e.top]=r,J(e)},he=function(e,t,n){switch(W(n),t.ttype()){case d:{let e=t.value;return 1<=n&&n<=e.nupvalues?{name:w("",!0),val:e.upvalue[n-1]}:null}case g:{let e=t.value,r=e.p;if(!(1<=n&&n<=r.upvalues.length))return null;let a=r.upvalues[n-1].name;return{name:a?a.getstr():w("(*no name)",!0),val:e.upvals[n-1]}}default:return null}},Le=function(e,t){let n=$(e,t);if(!n.ttisstring()){if(!F.cvt2str(n))return null;C.luaO_tostring(e,n)}return n.svalue()},ge=Le,Ae=function(e,t){return F.tointeger($(e,t))},Te=function(e,t){return F.tonumber($(e,t))},be=new WeakMap,xe=function(e,t){I.luaD_callnoyield(e,t.funcOff,t.nresults)},Oe=function(e,t){let n=$(e,t);return Q(n)?n.ttnov():x},ke=w("?"),ve=function(e,t,n){S(e,n===r||e.ci.top-e.top>=n-t,"results from function overflow current stack size")},Ee=function(e,t,n,a,u){S(e,null===u||!(e.ci.callstatus&D.CIST_LUA),"cannot use continuations inside hooks"),q(e,t+1),S(e,e.status===U,"cannot do calls on non-normal thread"),ve(e,t,n);let l=e.top-(t+1);null!==u&&0===e.nny?(e.ci.c_k=u,e.ci.c_ctx=a,I.luaD_call(e,l,n)):I.luaD_callnoyield(e,l,n),n===r&&e.ci.top<e.top&&(e.ci.top=e.top)},me=function(e,t,n,a,u,l){let s,o;S(e,null===l||!(e.ci.callstatus&D.CIST_LUA),"cannot use continuations inside hooks"),q(e,t+1),S(e,e.status===U,"cannot do calls on non-normal thread"),ve(e,t,n),o=0===a?0:ee(e,a);let i=e.top-(t+1);if(null===l||e.nny>0){let t={funcOff:i,nresults:n};s=I.luaD_pcall(e,xe,t,i,o)}else{let t=e.ci;t.c_k=l,t.c_ctx=u,t.extra=i,t.c_old_errfunc=e.errfunc,e.errfunc=o,t.callstatus&=~D.CIST_OAH|e.allowhook,t.callstatus|=D.CIST_YPCALL,I.luaD_call(e,i,n),t.callstatus&=~D.CIST_YPCALL,e.errfunc=t.c_old_errfunc,s=U}return n===r&&e.ci.top<e.top&&(e.ci.top=e.top),s},Re=function(e,t,n){let r=$(e,t);S(e,r.ttisLclosure(),"Lua function expected");let a=r.value;return W(n),S(e,1<=n&&n<=a.p.upvalues.length,"invalid upvalue index"),{f:a,i:n-1}};e.exports.api_incr_top=J,e.exports.api_checknelems=q,e.exports.lua_absindex=function(e,t){return t>0||t<=i?t:e.top-e.ci.funcOff+t},e.exports.lua_arith=function(e,t){t!==o&&t!==a?q(e,2):(q(e,1),C.pushobj2s(e,e.stack[e.top-1]),S(e,e.top<=e.ci.top,"stack overflow")),C.luaO_arith(e,t,e.stack[e.top-2],e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top]},e.exports.lua_atpanic=function(e,t){let n=e.l_G.panic;return e.l_G.panic=t,n},e.exports.lua_atnativeerror=function(e,t){let n=e.l_G.atnativeerror;return e.l_G.atnativeerror=t,n},e.exports.lua_call=function(e,t,n){Ee(e,t,n,0,null)},e.exports.lua_callk=Ee,e.exports.lua_checkstack=function(e,t){let n,r=e.ci;return S(e,t>=0,"negative 'n'"),e.stack_last-e.top>t?n=!0:e.top+D.EXTRA_STACK>j-t?n=!1:(I.luaD_growstack(e,t),n=!0),n&&r.top<e.top+t&&(r.top=e.top+t),n},e.exports.lua_compare=function(e,t,n,r){let a=$(e,t),o=$(e,n),i=0;if(Q(a)&&Q(o))switch(r){case u:i=F.luaV_equalobj(e,a,o);break;case s:i=F.luaV_lessthan(e,a,o);break;case l:i=F.luaV_lessequal(e,a,o);break;default:S(e,!1,"invalid option")}return i},e.exports.lua_concat=function(e,t){q(e,t),t>=2?F.luaV_concat(e,t):0===t&&(C.pushsvalue2s(e,V(e,w("",!0))),S(e,e.top<=e.ci.top,"stack overflow"))},e.exports.lua_copy=ue,e.exports.lua_createtable=de,e.exports.lua_dump=function(e,t,n,r){q(e,1);let a=e.stack[e.top-1];return a.ttisLclosure()?M(e,a.value.p,t,n,r):1},e.exports.lua_error=function(e){q(e,1),y.luaG_errormsg(e)},e.exports.lua_gc=function(){},e.exports.lua_getallocf=function(){return console.warn("lua_getallocf is not available"),0},e.exports.lua_getextraspace=function(){return console.warn("lua_getextraspace is not available"),0},e.exports.lua_getfield=function(e,t,n){return _e(e,$(e,t),n)},e.exports.lua_getglobal=function(e,t){return _e(e,H.luaH_getint(e.l_G.l_registry.value,c),t)},e.exports.lua_geti=function(e,t,n){let r=$(e,t);return W(n),e.stack[e.top]=new z(k,n),J(e),F.luaV_gettable(e,r,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},e.exports.lua_getmetatable=function(e,t){let n,r=$(e,t),a=!1;switch(r.ttnov()){case E:case R:n=r.value.metatable;break;default:n=e.l_G.mt[r.ttnov()]}return null!=n&&(e.stack[e.top]=new z(E,n),J(e),a=!0),a},e.exports.lua_gettable=function(e,t){let n=$(e,t);return F.luaV_gettable(e,n,e.stack[e.top-1],e.top-1),e.stack[e.top-1].ttnov()},e.exports.lua_gettop=function(e){return e.top-(e.ci.funcOff+1)},e.exports.lua_getupvalue=function(e,t,n){let r=he(0,$(e,t),n);if(r){let t=r.name,n=r.val;return C.pushobj2s(e,n),S(e,e.top<=e.ci.top,"stack overflow"),t}return null},e.exports.lua_getuservalue=function(e,t){let n=$(e,t);S(e,n.ttisfulluserdata(),"full userdata expected");let r=n.value.uservalue;return e.stack[e.top]=new z(r.type,r.value),J(e),e.stack[e.top-1].ttnov()},e.exports.lua_insert=function(e,t){ae(e,t,1)},e.exports.lua_isboolean=function(e,t){return Oe(e,t)===p},e.exports.lua_iscfunction=function(e,t){let n=$(e,t);return n.ttislcf(n)||n.ttisCclosure()},e.exports.lua_isfunction=function(e,t){return Oe(e,t)===h},e.exports.lua_isinteger=function(e,t){return $(e,t).ttisinteger()},e.exports.lua_islightuserdata=function(e,t){return Oe(e,t)===A},e.exports.lua_isnil=function(e,t){return Oe(e,t)===b},e.exports.lua_isnone=function(e,t){return Oe(e,t)===x},e.exports.lua_isnoneornil=function(e,t){return Oe(e,t)<=0},e.exports.lua_isnumber=function(e,t){return!1!==F.tonumber($(e,t))},e.exports.lua_isproxy=function(e,t){let n=be.get(e);return!!n&&(null===t||t.l_G===n)},e.exports.lua_isstring=function(e,t){let n=$(e,t);return n.ttisstring()||F.cvt2str(n)},e.exports.lua_istable=function(e,t){return $(e,t).ttistable()},e.exports.lua_isthread=function(e,t){return Oe(e,t)===m},e.exports.lua_isuserdata=function(e,t){let n=$(e,t);return n.ttisfulluserdata(n)||n.ttislightuserdata()},e.exports.lua_len=function(e,t){let n=$(e,t),r=new z;F.luaV_objlen(e,r,n),e.stack[e.top]=r,J(e)},e.exports.lua_load=function(e,t,n,r,a){r=r?N(r):ke,null!==a&&(a=N(a));let u=new X(e,t,n),l=I.luaD_protectedparser(e,u,r,a);if(l===U){let t=e.stack[e.top-1].value;if(t.nupvalues>=1){let n=H.luaH_getint(e.l_G.l_registry.value,c);t.upvals[0].setfrom(n)}}return l},e.exports.lua_newtable=function(e){de(e)},e.exports.lua_newuserdata=function(e,t){let n=function(e,t){return new C.Udata(e,t)}(e,t);return e.stack[e.top]=new C.TValue(R,n),J(e),n.data},e.exports.lua_next=function(e,t){let n=$(e,t);return S(e,n.ttistable(),"table expected"),e.stack[e.top]=new z,H.luaH_next(e,n.value,e.top-1)?(J(e),1):(delete e.stack[e.top],delete e.stack[--e.top],0)},e.exports.lua_pcall=function(e,t,n,r){return me(e,t,n,r,0,null)},e.exports.lua_pcallk=me,e.exports.lua_pop=ne,e.exports.lua_pushboolean=function(e,t){e.stack[e.top]=new z(p,!!t),J(e)},e.exports.lua_pushcclosure=le,e.exports.lua_pushcfunction=oe,e.exports.lua_pushfstring=function(e,t,...n){return t=N(t),C.luaO_pushvfstring(e,t,n)},e.exports.lua_pushglobaltable=function(e){pe(e,i,c)},e.exports.lua_pushinteger=function(e,t){W(t),e.stack[e.top]=new z(k,t),J(e)},e.exports.lua_pushjsclosure=se,e.exports.lua_pushjsfunction=ie,e.exports.lua_pushlightuserdata=function(e,t){e.stack[e.top]=new z(A,t),J(e)},e.exports.lua_pushliteral=function(e,t){if(null==t)e.stack[e.top]=new z(b,null),e.top++;else{Z("string"==typeof t);let n=G(e,t);C.pushsvalue2s(e,n),t=n.getstr()}return S(e,e.top<=e.ci.top,"stack overflow"),t},e.exports.lua_pushlstring=function(e,t,n){let r;return W(n),0===n?(t=w("",!0),r=V(e,t)):(t=N(t),S(e,t.length>=n,"invalid length to lua_pushlstring"),r=B(e,t.subarray(0,n))),C.pushsvalue2s(e,r),S(e,e.top<=e.ci.top,"stack overflow"),r.value},e.exports.lua_pushnil=function(e){e.stack[e.top]=new z(b,null),J(e)},e.exports.lua_pushnumber=function(e,t){Z("number"==typeof t),e.stack[e.top]=new z(O,t),J(e)},e.exports.lua_pushstring=function(e,t){if(null==t)e.stack[e.top]=new z(b,null),e.top++;else{let n=B(e,N(t));C.pushsvalue2s(e,n),t=n.getstr()}return S(e,e.top<=e.ci.top,"stack overflow"),t},e.exports.lua_pushthread=function(e){return e.stack[e.top]=new z(m,e),J(e),e.l_G.mainthread===e},e.exports.lua_pushvalue=function(e,t){C.pushobj2s(e,$(e,t)),S(e,e.top<=e.ci.top,"stack overflow")},e.exports.lua_pushvfstring=function(e,t,n){return t=N(t),C.luaO_pushvfstring(e,t,n)},e.exports.lua_rawequal=function(e,t,n){let r=$(e,t),a=$(e,n);return Q(r)&&Q(a)?F.luaV_equalobj(null,r,a):0},e.exports.lua_rawget=function(e,t){let n=$(e,t);return S(e,n.ttistable(n),"table expected"),C.setobj2s(e,e.top-1,H.luaH_get(e,n.value,e.stack[e.top-1])),e.stack[e.top-1].ttnov()},e.exports.lua_rawgeti=pe,e.exports.lua_rawgetp=function(e,t,n){let r=$(e,t);S(e,r.ttistable(),"table expected");let a=new z(A,n);return C.pushobj2s(e,H.luaH_get(e,r.value,a)),S(e,e.top<=e.ci.top,"stack overflow"),e.stack[e.top-1].ttnov()},e.exports.lua_rawlen=function(e,t){let n=$(e,t);switch(n.ttype()){case v:case T:return n.vslen();case R:return n.value.len;case E:return H.luaH_getn(n.value);default:return 0}},e.exports.lua_rawset=function(e,t){q(e,2);let n=$(e,t);S(e,n.ttistable(),"table expected");let r=e.stack[e.top-2],a=e.stack[e.top-1];H.luaH_setfrom(e,n.value,r,a),H.invalidateTMcache(n.value),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_rawseti=function(e,t,n){W(n),q(e,1);let r=$(e,t);S(e,r.ttistable(),"table expected"),H.luaH_setint(r.value,n,e.stack[e.top-1]),delete e.stack[--e.top]},e.exports.lua_rawsetp=function(e,t,n){q(e,1);let r=$(e,t);S(e,r.ttistable(),"table expected");let a=new z(A,n),u=e.stack[e.top-1];H.luaH_setfrom(e,r.value,a,u),delete e.stack[--e.top]},e.exports.lua_register=function(e,t,n){oe(e,n),fe(e,t)},e.exports.lua_remove=function(e,t){ae(e,t,-1),ne(e,1)},e.exports.lua_replace=function(e,t){ue(e,-1,t),ne(e,1)},e.exports.lua_rotate=ae,e.exports.lua_setallocf=function(){return console.warn("lua_setallocf is not available"),0},e.exports.lua_setfield=function(e,t,n){ce(e,$(e,t),n)},e.exports.lua_setglobal=fe,e.exports.lua_seti=function(e,t,n){W(n),q(e,1);let r=$(e,t);e.stack[e.top]=new z(k,n),J(e),F.settable(e,r,e.stack[e.top-1],e.stack[e.top-2]),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_setmetatable=function(e,t){let n;q(e,1);let r=$(e,t);switch(e.stack[e.top-1].ttisnil()?n=null:(S(e,e.stack[e.top-1].ttistable(),"table expected"),n=e.stack[e.top-1].value),r.ttnov()){case R:case E:r.value.metatable=n;break;default:e.l_G.mt[r.ttnov()]=n}return delete e.stack[--e.top],!0},e.exports.lua_settable=function(e,t){q(e,2);let n=$(e,t);F.settable(e,n,e.stack[e.top-2],e.stack[e.top-1]),delete e.stack[--e.top],delete e.stack[--e.top]},e.exports.lua_settop=te,e.exports.lua_setupvalue=function(e,t,n){let r=$(e,t);q(e,1);let a=he(0,r,n);if(a){let t=a.name;return a.val.setfrom(e.stack[e.top-1]),delete e.stack[--e.top],t}return null},e.exports.lua_setuservalue=function(e,t){q(e,1);let n=$(e,t);S(e,n.ttisfulluserdata(),"full userdata expected"),n.value.uservalue.setfrom(e.stack[e.top-1]),delete e.stack[--e.top]},e.exports.lua_status=function(e){return e.status},e.exports.lua_stringtonumber=function(e,t){let n=new z,r=C.luaO_str2num(t,n);return 0!==r&&(e.stack[e.top]=n,J(e)),r},e.exports.lua_toboolean=function(e,t){return!$(e,t).l_isfalse()},e.exports.lua_tocfunction=function(e,t){let n=$(e,t);return n.ttislcf()||n.ttisCclosure()?n.value:null},e.exports.lua_todataview=function(e,t){let n=Le(e,t);return new DataView(n.buffer,n.byteOffset,n.byteLength)},e.exports.lua_tointeger=function(e,t){let n=Ae(e,t);return!1===n?0:n},e.exports.lua_tointegerx=Ae,e.exports.lua_tojsstring=function(e,t){let n=$(e,t);if(!n.ttisstring()){if(!F.cvt2str(n))return null;C.luaO_tostring(e,n)}return n.jsstring()},e.exports.lua_tolstring=Le,e.exports.lua_tonumber=function(e,t){let n=Te(e,t);return!1===n?0:n},e.exports.lua_tonumberx=Te,e.exports.lua_topointer=function(e,t){let n=$(e,t);switch(n.ttype()){case E:case g:case d:case L:case m:case R:case A:return n.value;default:return null}},e.exports.lua_toproxy=function(e,t){let n=$(e,t);return function(e,t,n){let r=function(r){S(r,r instanceof D.lua_State&&e===r.l_G,"must be from same global state"),r.stack[r.top]=new z(t,n),J(r)};return be.set(r,e),r}(e.l_G,n.type,n.value)},e.exports.lua_tostring=ge,e.exports.lua_tothread=function(e,t){let n=$(e,t);return n.ttisthread()?n.value:null},e.exports.lua_touserdata=function(e,t){let n=$(e,t);switch(n.ttnov()){case R:return n.value.data;case A:return n.value;default:return null}},e.exports.lua_type=Oe,e.exports.lua_typename=function(e,t){return S(e,x<=t&&t<_,"invalid tag"),K.ttypename(t)},e.exports.lua_upvalueid=function(e,t,n){let r=$(e,t);switch(r.ttype()){case g:{let r=Re(e,t,n);return r.f.upvals[r.i]}case d:{let t=r.value;return S(e,(0|n)===n&&n>0&&n<=t.nupvalues,"invalid upvalue index"),t.upvalue[n-1]}default:return S(e,!1,"closure expected"),null}},e.exports.lua_upvaluejoin=function(e,t,n,r,a){let u=Re(e,t,n),l=Re(e,r,a),s=l.f.upvals[l.i];u.f.upvals[u.i]=s},e.exports.lua_version=function(e){return null===e?f:e.l_G.version},e.exports.lua_xmove=function(e,t,n){if(e!==t){q(e,n),S(e,e.l_G===t.l_G,"moving among independent states"),S(e,t.ci.top-t.top>=n,"stack overflow"),e.top-=n;for(let r=0;r<n;r++)t.stack[t.top]=new C.TValue,C.setobj2s(t,t.top,e.stack[e.top+r]),delete e.stack[e.top+r],t.top++}}},function(e,t,n){"use strict";const{lua_assert:r}=n(4),a=function(e){let t=e.reader(e.L,e.data);if(null===t)return-1;r(t instanceof Uint8Array,"Should only load binary of array of bytes");let n=t.length;return 0===n?-1:(e.buffer=t,e.off=0,e.n=n-1,e.buffer[e.off++])};e.exports.EOZ=-1,e.exports.luaZ_buffer=function(e){return e.buffer.subarray(0,e.n)},e.exports.luaZ_buffremove=function(e,t){e.n-=t},e.exports.luaZ_fill=a,e.exports.luaZ_read=function(e,t,n,r){for(;r;){if(0===e.n){if(-1===a(e))return r;e.n++,e.off--}let u=r<=e.n?r:e.n;for(let r=0;r<u;r++)t[n++]=e.buffer[e.off++];e.n-=u,0===e.n&&(e.buffer=null),r-=u}return 0},e.exports.luaZ_resetbuffer=function(e){e.n=0},e.exports.luaZ_resizebuffer=function(e,t,n){let r=new Uint8Array(n);t.buffer&&r.set(t.buffer),t.buffer=r},e.exports.MBuffer=class{constructor(){this.buffer=null,this.n=0}},e.exports.ZIO=class{constructor(e,t,n){this.L=e,r("function"==typeof t,"ZIO requires a reader"),this.reader=t,this.data=n,this.n=0,this.buffer=null,this.off=0}zgetc(){return this.n-- >0?this.buffer[this.off++]:a(this)}}},function(e,t,n){"use strict";const{constant_types:{LUA_TBOOLEAN:r,LUA_TLNGSTR:a},thread_status:{LUA_ERRSYNTAX:u},to_luastring:l}=n(1),{LUA_MINBUFFER:s,MAX_INT:o,lua_assert:i}=n(4),c=n(11),f=n(8),{lisdigit:_,lislalnum:p,lislalpha:d,lisspace:h,lisxdigit:L}=n(22),g=n(6),{luaS_bless:A,luaS_hash:T,luaS_hashlongstr:b,luaS_new:x}=n(10),O=n(9),{EOZ:k,luaZ_buffer:v,luaZ_buffremove:E,luaZ_resetbuffer:m,luaZ_resizebuffer:R}=n(19),U=l("_ENV",!0),N=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","//","..","...","==",">=","<=","~=","<<",">>","::","<eof>","<number>","<integer>","<name>","<string>"].map(((e,t)=>l(e)));class w{constructor(){this.r=NaN,this.i=NaN,this.ts=null}}class S{constructor(){this.token=NaN,this.seminfo=new w}}const y=function(e,t){let n=e.buff;if(n.n+1>n.buffer.length){n.buffer.length>=o/2&&F(e,l("lexical element too long",!0),0);let t=2*n.buffer.length;R(e.L,n,t)}n.buffer[n.n++]=t<0?255+t+1:t},I=function(e,t){if(t<257)return g.luaO_pushfstring(e.L,l("'%c'",!0),t);{let n=N[t-257];return t<289?g.luaO_pushfstring(e.L,l("'%s'",!0),n):n}},M=function(e){return 10===e.current||13===e.current},P=function(e){e.current=e.z.zgetc()},C=function(e){y(e,e.current),P(e)},D=new g.TValue(r,!0),V=function(e,t){let n=e.L,r=x(n,t),u=e.h.strong.get(b(r));if(u)r=u.key.tsvalue();else{let t=new g.TValue(a,r);O.luaH_setfrom(n,e.h,t,D)}return r},B=function(e){let t=e.current;i(M(e)),P(e),M(e)&&e.current!==t&&P(e),++e.linenumber>=o&&F(e,l("chunk has too many lines",!0),0)},G=function(e,t){return e.current===t&&(P(e),!0)},K=function(e,t){return(e.current===t[0].charCodeAt(0)||e.current===t[1].charCodeAt(0))&&(C(e),!0)},j=function(e,t){let n="Ee",r=e.current;for(i(_(e.current)),C(e),48===r&&K(e,"xX")&&(n="Pp");;)if(K(e,n)&&K(e,"-+"),L(e.current))C(e);else{if(46!==e.current)break;C(e)}let a=new g.TValue;return 0===g.luaO_str2num(v(e.buff),a)&&F(e,l("malformed number",!0),290),a.ttisinteger()?(t.i=a.value,291):(i(a.ttisfloat()),t.r=a.value,290)},F=function(e,t,n){t=c.luaG_addinfo(e.L,t,e.source,e.linenumber),n&&g.luaO_pushfstring(e.L,l("%s near %s"),t,function(e,t){switch(t){case 292:case 293:case 290:case 291:return g.luaO_pushfstring(e.L,l("'%s'",!0),v(e.buff));default:return I(e,t)}}(e,n)),f.luaD_throw(e.L,u)},H=function(e){let t=0,n=e.current;for(i(91===n||93===n),C(e);61===e.current;)C(e),t++;return e.current===n?t:-t-1},X=function(e,t,n){let r=e.linenumber;C(e),M(e)&&B(e);let a=!1;for(;!a;)switch(e.current){case k:F(e,l(`unfinished long ${t?"string":"comment"} (starting at line ${r})`),289);break;case 93:H(e)===n&&(C(e),a=!0);break;case 10:case 13:y(e,10),B(e),t||m(e.buff);break;default:t?C(e):P(e)}t&&(t.ts=V(e,e.buff.buffer.subarray(2+n,e.buff.n-(2+n))))},z=function(e,t,n){t||(e.current!==k&&C(e),F(e,n,293))},Y=function(e){return C(e),z(e,L(e.current),l("hexadecimal digit expected",!0)),g.luaO_hexavalue(e.current)},J=function(e){let t=Y(e);return t=(t<<4)+Y(e),E(e.buff,2),t},q=function(e){let t=new Uint8Array(g.UTF8BUFFSZ),n=g.luaO_utf8esc(t,function(e){let t=4;C(e),z(e,123===e.current,l("missing '{'",!0));let n=Y(e);for(C(e);L(e.current);)t++,n=(n<<4)+g.luaO_hexavalue(e.current),z(e,n<=1114111,l("UTF-8 value too large",!0)),C(e);return z(e,125===e.current,l("missing '}'",!0)),P(e),E(e.buff,t),n}(e));for(;n>0;n--)y(e,t[g.UTF8BUFFSZ-n])},Z=function(e){let t,n=0;for(t=0;t<3&&_(e.current);t++)n=10*n+e.current-48,C(e);return z(e,n<=255,l("decimal escape too large",!0)),E(e.buff,t),n},W=function(e,t,n){for(C(e);e.current!==t;)switch(e.current){case k:F(e,l("unfinished string",!0),289);break;case 10:case 13:F(e,l("unfinished string",!0),293);break;case 92:{let t,n;switch(C(e),e.current){case 97:n=7,t="read_save";break;case 98:n=8,t="read_save";break;case 102:n=12,t="read_save";break;case 110:n=10,t="read_save";break;case 114:n=13,t="read_save";break;case 116:n=9,t="read_save";break;case 118:n=11,t="read_save";break;case 120:n=J(e),t="read_save";break;case 117:q(e),t="no_save";break;case 10:case 13:B(e),n=10,t="only_save";break;case 92:case 34:case 39:n=e.current,t="read_save";break;case k:t="no_save";break;case 122:for(E(e.buff,1),P(e);h(e.current);)M(e)?B(e):P(e);t="no_save";break;default:z(e,_(e.current),l("invalid escape sequence",!0)),n=Z(e),t="only_save"}"read_save"===t&&P(e),"read_save"!==t&&"only_save"!==t||(E(e.buff,1),y(e,n));break}default:C(e)}C(e),n.ts=V(e,e.buff.buffer.subarray(1,e.buff.n-1))},Q=Object.create(null);N.forEach(((e,t)=>Q[T(e)]=t));const $=function(e,t){for(m(e.buff);;)switch(i("number"==typeof e.current),e.current){case 10:case 13:B(e);break;case 32:case 12:case 9:case 11:P(e);break;case 45:if(P(e),45!==e.current)return 45;if(P(e),91===e.current){let t=H(e);if(m(e.buff),t>=0){X(e,null,t),m(e.buff);break}}for(;!M(e)&&e.current!==k;)P(e);break;case 91:{let n=H(e);return n>=0?(X(e,t,n),293):(-1!==n&&F(e,l("invalid long string delimiter",!0),293),91)}case 61:return P(e),G(e,61)?282:61;case 60:return P(e),G(e,61)?284:G(e,60)?286:60;case 62:return P(e),G(e,61)?283:G(e,62)?287:62;case 47:return P(e),G(e,47)?279:47;case 126:return P(e),G(e,61)?285:126;case 58:return P(e),G(e,58)?288:58;case 34:case 39:return W(e,e.current,t),293;case 46:return C(e),G(e,46)?G(e,46)?281:280:_(e.current)?j(e,t):46;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return j(e,t);case k:return 289;default:if(d(e.current)){do{C(e)}while(p(e.current));let n=V(e,v(e.buff));t.ts=n;let r=Q[b(n)];return void 0!==r&&r<=22?r+257:292}{let t=e.current;return P(e),t}}};e.exports.FIRST_RESERVED=257,e.exports.LUA_ENV=U,e.exports.LexState=class{constructor(){this.current=NaN,this.linenumber=NaN,this.lastline=NaN,this.t=new S,this.lookahead=new S,this.fs=null,this.L=null,this.z=null,this.buff=null,this.h=null,this.dyd=null,this.source=null,this.envn=null}},e.exports.RESERVED={TK_AND:257,TK_BREAK:258,TK_DO:259,TK_ELSE:260,TK_ELSEIF:261,TK_END:262,TK_FALSE:263,TK_FOR:264,TK_FUNCTION:265,TK_GOTO:266,TK_IF:267,TK_IN:268,TK_LOCAL:269,TK_NIL:270,TK_NOT:271,TK_OR:272,TK_REPEAT:273,TK_RETURN:274,TK_THEN:275,TK_TRUE:276,TK_UNTIL:277,TK_WHILE:278,TK_IDIV:279,TK_CONCAT:280,TK_DOTS:281,TK_EQ:282,TK_GE:283,TK_LE:284,TK_NE:285,TK_SHL:286,TK_SHR:287,TK_DBCOLON:288,TK_EOS:289,TK_FLT:290,TK_INT:291,TK_NAME:292,TK_STRING:293},e.exports.isreserved=function(e){let t=Q[b(e)];return void 0!==t&&t<=22},e.exports.luaX_lookahead=function(e){return i(289===e.lookahead.token),e.lookahead.token=$(e,e.lookahead.seminfo),e.lookahead.token},e.exports.luaX_newstring=V,e.exports.luaX_next=function(e){e.lastline=e.linenumber,289!==e.lookahead.token?(e.t.token=e.lookahead.token,e.t.seminfo.i=e.lookahead.seminfo.i,e.t.seminfo.r=e.lookahead.seminfo.r,e.t.seminfo.ts=e.lookahead.seminfo.ts,e.lookahead.token=289):e.t.token=$(e,e.t.seminfo)},e.exports.luaX_setinput=function(e,t,n,r,a){t.t={token:0,seminfo:new w},t.L=e,t.current=a,t.lookahead={token:289,seminfo:new w},t.z=n,t.fs=null,t.linenumber=1,t.lastline=1,t.source=r,t.envn=A(e,U),R(e,t.buff,s)},e.exports.luaX_syntaxerror=function(e,t){F(e,t,e.t.token)},e.exports.luaX_token2str=I,e.exports.luaX_tokens=N},function(e,t,n){"use strict";const{lua:r,lauxlib:a,lualib:u,to_luastring:l}=n(0),{LUA_MULTRET:s,LUA_OK:o,LUA_REGISTRYINDEX:i,LUA_RIDX_MAINTHREAD:c,LUA_TBOOLEAN:f,LUA_TFUNCTION:_,LUA_TLIGHTUSERDATA:p,LUA_TNIL:d,LUA_TNONE:h,LUA_TNUMBER:L,LUA_TSTRING:g,LUA_TTABLE:A,LUA_TTHREAD:T,LUA_TUSERDATA:b,lua_atnativeerror:x,lua_call:O,lua_getfield:k,lua_gettable:v,lua_gettop:E,lua_isnil:m,lua_isproxy:R,lua_newuserdata:U,lua_pcall:N,lua_pop:w,lua_pushboolean:S,lua_pushcfunction:y,lua_pushinteger:I,lua_pushlightuserdata:M,lua_pushliteral:P,lua_pushnil:C,lua_pushnumber:D,lua_pushstring:V,lua_pushvalue:B,lua_rawgeti:G,lua_rawgetp:K,lua_rawsetp:j,lua_rotate:F,lua_setfield:H,lua_settable:X,lua_settop:z,lua_toboolean:Y,lua_tojsstring:J,lua_tonumber:q,lua_toproxy:Z,lua_tothread:W,lua_touserdata:Q,lua_type:$}=r,{luaL_argerror:ee,luaL_checkany:te,luaL_checkoption:ne,luaL_checkstack:re,luaL_checkudata:ae,luaL_error:ue,luaL_getmetafield:le,luaL_newlib:se,luaL_newmetatable:oe,luaL_requiref:ie,luaL_setfuncs:ce,luaL_setmetatable:fe,luaL_testudata:_e,luaL_tolstring:pe}=a,{luaopen_base:de}=u,he="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this");let Le,ge,Ae;if("undefined"!=typeof Reflect)Le=Reflect.apply,ge=Reflect.construct,Ae=Reflect.deleteProperty;else{const e=Function.apply,t=Function.bind;Le=function(t,n,r){return e.call(t,n,r)},ge=function(e,n){switch(n.length){case 0:return new e;case 1:return new e(n[0]);case 2:return new e(n[0],n[1]);case 3:return new e(n[0],n[1],n[2]);case 4:return new e(n[0],n[1],n[2],n[3])}let r=[null];return r.push.apply(r,n),new(t.apply(e,r))},Ae=Function("t","k","delete t[k]")}const Te=String.prototype.concat.bind(""),be=function(e){return"object"==typeof e?null!==e:"function"==typeof e},xe=l("js object"),Oe=function(e,t){let n=_e(e,t,xe);return n?n.data:void 0},ke=function(e,t){return ae(e,t,xe).data},ve=function(e,t){U(e).data=t,fe(e,xe)},Ee=function(e){G(e,i,c);let t=W(e,-1);return w(e,1),t},me=new WeakMap,Re=function(e,t){switch(typeof t){case"undefined":C(e);break;case"number":D(e,t);break;case"string":V(e,l(t));break;case"boolean":S(e,t);break;case"symbol":M(e,t);break;case"function":if(R(t,e)){t(e);break}case"object":if(null===t){if(K(e,i,null)!==b)throw Error("js library not loaded into lua_State");break}default:{let n=me.get(Ee(e));if(!n)throw Error("js library not loaded into lua_State");let r=n.get(t);r?r(e):(ve(e,t),r=Z(e,-1),n.set(t,r))}}},Ue=function(e){let t=Q(e,1);return Re(e,t),1},Ne=function(e,t){switch($(e,t)){case h:case d:return;case f:return Y(e,t);case p:return Q(e,t);case L:return q(e,t);case g:return J(e,t);case b:{let n=Oe(e,t);if(void 0!==n)return n}default:return Be(e,Z(e,t))}},we=function(e,t){let n=N(e,t,1,0),r=Ne(e,-1);if(w(e,1),n===o)return r;throw r},Se=function(e,t,n,r,a){if(!be(r))throw new TypeError("`args` argument must be an object");let u=+r.length;u>=0||(u=0),re(e,2+u,null);let l=E(e);t(e),Re(e,n);for(let s=0;s<u;s++)Re(e,r[s]);if(N(e,1+u,a,0)===o){let t=E(e)-l,n=new Array(t);for(let r=0;r<t;r++)n[r]=Ne(e,l+r+1);return z(e,l),n}{let t=Ne(e,-1);throw z(e,l),t}},ye=function(e){return v(e,1),1},Ie=function(e,t,n){return re(e,3,null),y(e,ye),t(e),Re(e,n),we(e,2)},Me=function(e,t,n){if(re(e,3,null),y(e,ye),t(e),Re(e,n),N(e,2,1,0)===o){let t=m(e,-1);return w(e,1),!t}{let t=Ne(e,-1);throw w(e,1),t}},Pe=function(e,t,n,r){if(re(e,4,null),y(e,(function(e){return X(e,1),0})),t(e),Re(e,n),Re(e,r),N(e,3,0,0)!==o){let t=Ne(e,-1);throw w(e,1),t}},Ce=function(e,t,n){if(re(e,4,null),y(e,(function(e){return X(e,1),0})),t(e),Re(e,n),C(e),N(e,3,0,0)!==o){let t=Ne(e,-1);throw w(e,1),t}},De=function(e,t){return re(e,2,null),y(e,(function(e){return pe(e,1),1})),t(e),we(e,1)},Ve=function(){let e=this.L;re(e,3,null);let t=E(e);if(this.iter(e),this.state(e),this.last(e),N(e,2,s,0)===o){let n;if(this.last=Z(e,t+1),m(e,-1))n={done:!0,value:void 0};else{let r=E(e)-t,a=new Array(r);for(let n=0;n<r;n++)a[n]=Ne(e,t+n+1);n={done:!1,value:a}}return z(e,t),n}{let t=Ne(e,-1);throw w(e,1),t}},Be=function(e,t){const n=Ee(e);let r=function(){return Se(n,t,this,arguments,1)[0]};r.apply=function(e,r){return Se(n,t,e,r,1)[0]},r.invoke=function(e,r){return Se(n,t,e,r,s)},r.get=function(e){return Ie(n,t,e)},r.has=function(e){return Me(n,t,e)},r.set=function(e,r){return Pe(n,t,e,r)},r.delete=function(e){return Ce(n,t,e)},r.toString=function(){return De(n,t)},"function"==typeof Symbol&&(r[Symbol.toStringTag]="Fengari object",r[Symbol.iterator]=function(){return function(e,t){if(re(e,1,null),y(e,(function(e){return ie(e,l("_G"),de,0),k(e,-1,l("pairs")),t(e),O(e,1,3),3})),N(e,0,3,0)===o){let t=Z(e,-3),n=Z(e,-2),r=Z(e,-1);return w(e,3),{L:e,iter:t,state:n,last:r,next:Ve}}{let t=Ne(e,-1);throw w(e,1),t}}(n,t)},Symbol.toPrimitive&&(r[Symbol.toPrimitive]=function(e){if("string"===e)return De(n,t)}));let a=me.get(n);if(!a)throw Error("js library not loaded into lua_State");return a.set(r,t),r},Ge={new:function(e){let t=Ne(e,1),n=E(e)-1,r=new Array(n);for(let a=0;a<n;a++)r[a]=Ne(e,a+2);return Re(e,ge(t,r)),1},tonumber:function(e){let t=Ne(e,1);return D(e,+t),1},tostring:function(e){let t=Ne(e,1);return P(e,Te(t)),1},instanceof:function(e){let t=Ne(e,1),n=Ne(e,2);return S(e,t instanceof n),1},typeof:function(e){let t=Ne(e,1);return P(e,typeof t),1}};if("function"==typeof Symbol&&Symbol.iterator){const e=function(e,t){let n=ke(e,t),r=n[Symbol.iterator];r||ee(e,t,l("object not iterable"));let a=Le(r,n,[]);return be(a)||ee(e,t,l("Result of the Symbol.iterator method is not an object")),a},t=function(e){let t=Ne(e,1).next();return t.done?0:(Re(e,t.value),1)};Ge.of=function(n){let r=e(n,1);return y(n,t),Re(n,r),2}}if("function"==typeof Proxy&&"function"==typeof Symbol){const e=Symbol("lua_State"),t=Symbol("fengari-proxy"),n={apply:function(n,r,a){return Se(n[e],n[t],r,a,1)[0]},construct:function(n,r){let a=n[e],u=n[t],s=r.length;re(a,2+s,null),u(a);let o=E(a);if(le(a,o,l("construct"))===d)throw w(a,1),new TypeError("not a constructor");F(a,o,1);for(let e=0;e<s;e++)Re(a,r[e]);return we(a,1+s)},defineProperty:function(n,r,a){let u=n[e],s=n[t];return re(u,4,null),s(u),le(u,-1,l("defineProperty"))===d?(w(u,1),!1):(F(u,-2,1),Re(u,r),Re(u,a),we(u,3))},deleteProperty:function(n,r){return Ce(n[e],n[t],r)},get:function(n,r){return Ie(n[e],n[t],r)},getOwnPropertyDescriptor:function(n,r){let a=n[e],u=n[t];if(re(a,3,null),u(a),le(a,-1,l("getOwnPropertyDescriptor"))!==d)return F(a,-2,1),Re(a,r),we(a,2);w(a,1)},getPrototypeOf:function(n){let r=n[e],a=n[t];return re(r,2,null),a(r),le(r,-1,l("getPrototypeOf"))===d?(w(r,1),null):(F(r,-2,1),we(r,1))},has:function(n,r){return Me(n[e],n[t],r)},ownKeys:function(n){let r=n[e],a=n[t];if(re(r,2,null),a(r),le(r,-1,l("ownKeys"))===d)throw w(r,1),Error("ownKeys unknown for fengari object");return F(r,-2,1),we(r,1)},set:function(n,r,a){return Pe(n[e],n[t],r,a),!0},setPrototypeOf:function(n,r){let a=n[e],u=n[t];return re(a,3,null),u(a),le(a,-1,l("setPrototypeOf"))===d?(w(a,1),!1):(F(a,-2,1),Re(a,r),we(a,2))}},r=function(){let e=function(){}.bind();return delete e.length,delete e.name,e},a=Function("return ()=>void 0;"),u=function(){let e=a();return delete e.length,delete e.name,e},s=function(a,l,s){const o=Ee(a);let i;switch(s){case"function":i=r();break;case"arrow_function":i=u();break;case"object":i={};break;default:throw TypeError("invalid type to createproxy")}return i[t]=l,i[e]=o,new Proxy(i,n)},o=["function","arrow_function","object"],i=o.map((e=>l(e)));Ge.createproxy=function(e){te(e,1);let t=o[ne(e,2,i[0],i)],n=s(e,Z(e,1),t);return Re(e,n),1}}let Ke={__index:function(e){let t=ke(e,1),n=Ne(e,2);return Re(e,t[n]),1},__newindex:function(e){let t=ke(e,1),n=Ne(e,2),r=Ne(e,3);return void 0===r?Ae(t,n):t[n]=r,0},__tostring:function(e){let t=ke(e,1),n=Te(t);return V(e,l(n)),1},__call:function(e){let t,n=ke(e,1),r=E(e)-1,a=new Array(Math.max(0,r-1));if(r>0&&(t=Ne(e,2),r-- >0))for(let u=0;u<r;u++)a[u]=Ne(e,u+3);return Re(e,Le(n,t,a)),1},__pairs:function(e){let t,n,r,a,u=ke(e,1);if("function"!=typeof Symbol||void 0===(t=u[Symbol.for("__pairs")]))n=function(e){if(this.index>=this.keys.length)return;let t=this.keys[this.index++];return[t,this.object[t]]},r={object:u,keys:Object.keys(u),index:0};else{let s=Le(t,u,[]);void 0===s&&ue(e,l("bad '__pairs' result (object with keys 'iter', 'state', 'first' expected)")),void 0===(n=s.iter)&&ue(e,l("bad '__pairs' result (object.iter is missing)")),r=s.state,a=s.first}return y(e,(function(){let t=Ne(e,1),r=Ne(e,2),a=Le(n,t,[r]);if(void 0===a)return 0;Array.isArray(a)||ue(e,l("bad iterator result (Array or undefined expected)")),re(e,a.length,null);for(let n=0;n<a.length;n++)Re(e,a[n]);return a.length})),Re(e,r),Re(e,a),3},__len:function(e){let t,n,r=ke(e,1);return n="function"!=typeof Symbol||void 0===(t=r[Symbol.for("__len")])?r.length:Le(t,r,[]),Re(e,n),1}};e.exports.FENGARI_INTEROP_VERSION="0.1",e.exports.FENGARI_INTEROP_VERSION_NUM=1,e.exports.FENGARI_INTEROP_RELEASE="0.1.2",e.exports.checkjs=ke,e.exports.testjs=Oe,e.exports.pushjs=ve,e.exports.push=Re,e.exports.tojs=Ne,e.exports.luaopen_js=function(e){return me.set(Ee(e),new WeakMap),x(e,Ue),se(e,Ge),P(e,"0.1"),H(e,-2,l("_VERSION")),I(e,1),H(e,-2,l("_VERSION_NUM")),P(e,"0.1.2"),H(e,-2,l("_RELEASE")),oe(e,xe),ce(e,Ke,0),w(e,1),ve(e,null),B(e,-1),j(e,i,null),H(e,-2,l("null")),Re(e,he),H(e,-2,l("global")),1}},function(e,t,n){"use strict";const{luastring_of:r}=n(1),a=r(0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,22,22,22,22,22,22,22,22,22,22,4,4,4,4,4,4,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,5,4,21,21,21,21,21,21,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);e.exports.lisdigit=function(e){return 0!=(2&a[e+1])},e.exports.lislalnum=function(e){return 0!=(3&a[e+1])},e.exports.lislalpha=function(e){return 0!=(1&a[e+1])},e.exports.lisprint=function(e){return 0!=(4&a[e+1])},e.exports.lisspace=function(e){return 0!=(8&a[e+1])},e.exports.lisxdigit=function(e){return 0!=(16&a[e+1])}},function(e,t,n){"use strict";const{LUA_MULTRET:r,to_luastring:a}=n(1),{BinOpr:{OPR_ADD:u,OPR_AND:l,OPR_BAND:s,OPR_BOR:o,OPR_BXOR:i,OPR_CONCAT:c,OPR_DIV:f,OPR_EQ:_,OPR_GE:p,OPR_GT:d,OPR_IDIV:h,OPR_LE:L,OPR_LT:g,OPR_MOD:A,OPR_MUL:T,OPR_NE:b,OPR_NOBINOPR:x,OPR_OR:O,OPR_POW:k,OPR_SHL:v,OPR_SHR:E,OPR_SUB:m},UnOpr:{OPR_BNOT:R,OPR_LEN:U,OPR_MINUS:N,OPR_NOT:w,OPR_NOUNOPR:S},NO_JUMP:y,getinstruction:I,luaK_checkstack:M,luaK_codeABC:P,luaK_codeABx:C,luaK_codeAsBx:D,luaK_codek:V,luaK_concat:B,luaK_dischargevars:G,luaK_exp2RK:K,luaK_exp2anyreg:j,luaK_exp2anyregup:F,luaK_exp2nextreg:H,luaK_exp2val:X,luaK_fixline:z,luaK_getlabel:Y,luaK_goiffalse:J,luaK_goiftrue:q,luaK_indexed:Z,luaK_infix:W,luaK_intK:Q,luaK_jump:$,luaK_jumpto:ee,luaK_nil:te,luaK_patchclose:ne,luaK_patchlist:re,luaK_patchtohere:ae,luaK_posfix:ue,luaK_prefix:le,luaK_reserveregs:se,luaK_ret:oe,luaK_self:ie,luaK_setlist:ce,luaK_setmultret:fe,luaK_setoneret:_e,luaK_setreturns:pe,luaK_storevar:de,luaK_stringK:he}=n(35),Le=n(8),ge=n(13),Ae=n(20),{LUAI_MAXCCALLS:Te,MAX_INT:be,lua_assert:xe}=n(4),Oe=n(6),{OpCodesI:{OP_CALL:ke,OP_CLOSURE:ve,OP_FORLOOP:Ee,OP_FORPREP:me,OP_GETUPVAL:Re,OP_MOVE:Ue,OP_NEWTABLE:Ne,OP_SETTABLE:we,OP_TAILCALL:Se,OP_TFORCALL:ye,OP_TFORLOOP:Ie,OP_VARARG:Me},LFIELDS_PER_FLUSH:Pe,SETARG_B:Ce,SETARG_C:De,SET_OPCODE:Ve}=n(16),{luaS_eqlngstr:Be,luaS_new:Ge,luaS_newliteral:Ke}=n(10),je=n(9),Fe=ge.Proto,He=Ae.RESERVED,Xe=function(e){return e===Je.VCALL||e===Je.VVARARG},ze=function(e,t){return Be(e,t)};class Ye{constructor(){this.previous=null,this.firstlabel=NaN,this.firstgoto=NaN,this.nactvar=NaN,this.upval=NaN,this.isloop=NaN}}const Je={VVOID:0,VNIL:1,VTRUE:2,VFALSE:3,VK:4,VKFLT:5,VKINT:6,VNONRELOC:7,VLOCAL:8,VUPVAL:9,VINDEXED:10,VJMP:11,VRELOCABLE:12,VCALL:13,VVARARG:14};class qe{constructor(){this.k=NaN,this.u={ival:NaN,nval:NaN,info:NaN,ind:{idx:NaN,t:NaN,vt:NaN}},this.t=NaN,this.f=NaN}to(e){this.k=e.k,this.u=e.u,this.t=e.t,this.f=e.f}}class Ze{constructor(){this.f=null,this.prev=null,this.ls=null,this.bl=null,this.pc=NaN,this.lasttarget=NaN,this.jpc=NaN,this.nk=NaN,this.np=NaN,this.firstlocal=NaN,this.nlocvars=NaN,this.nactvar=NaN,this.nups=NaN,this.freereg=NaN}}class We{constructor(){this.arr=[],this.n=NaN,this.size=NaN}}const Qe=function(e,t){e.t.token=0,Ae.luaX_syntaxerror(e,t)},$e=function(e,t){Ae.luaX_syntaxerror(e,Oe.luaO_pushfstring(e.L,a("%s expected",!0),Ae.luaX_token2str(e,t)))},et=function(e,t,n,r){t>n&&function(e,t,n){let r=e.ls.L,u=e.f.linedefined,l=0===u?a("main function",!0):Oe.luaO_pushfstring(r,a("function at line %d",!0),u),s=Oe.luaO_pushfstring(r,a("too many %s (limit is %d) in %s",!0),n,t,l);Ae.luaX_syntaxerror(e.ls,s)}(e,n,r)},tt=function(e,t){return e.t.token===t&&(Ae.luaX_next(e),!0)},nt=function(e,t){e.t.token!==t&&$e(e,t)},rt=function(e,t){nt(e,t),Ae.luaX_next(e)},at=function(e,t,n){t||Ae.luaX_syntaxerror(e,n)},ut=function(e,t,n,r){tt(e,t)||(r===e.linenumber?$e(e,t):Ae.luaX_syntaxerror(e,Oe.luaO_pushfstring(e.L,a("%s expected (to close %s at line %d)"),Ae.luaX_token2str(e,t),Ae.luaX_token2str(e,n),r)))},lt=function(e){nt(e,He.TK_NAME);let t=e.t.seminfo.ts;return Ae.luaX_next(e),t},st=function(e,t,n){e.f=e.t=y,e.k=t,e.u.info=n},ot=function(e,t,n){st(t,Je.VK,he(e.fs,n))},it=function(e,t){ot(e,t,lt(e))},ct=function(e,t){let n=e.fs,r=e.dyd,u=function(e,t){let n=e.fs,r=n.f;return r.locvars[n.nlocvars]=new Oe.LocVar,r.locvars[n.nlocvars].varname=t,n.nlocvars++}(e,t);et(n,r.actvar.n+1-n.firstlocal,200,a("local variables",!0)),r.actvar.arr[r.actvar.n]=new class{constructor(){this.idx=NaN}},r.actvar.arr[r.actvar.n].idx=u,r.actvar.n++},ft=function(e,t){ct(e,Ae.luaX_newstring(e,a(t,!0)))},_t=function(e,t){let n=e.ls.dyd.actvar.arr[e.firstlocal+t].idx;return xe(n<e.nlocvars),e.f.locvars[n]},pt=function(e,t){let n=e.fs;for(n.nactvar=n.nactvar+t;t;t--)_t(n,n.nactvar-t).startpc=n.pc},dt=function(e,t,n){let r=e.f;return et(e,e.nups+1,ge.MAXUPVAL,a("upvalues",!0)),r.upvalues[e.nups]={instack:n.k===Je.VLOCAL,idx:n.u.info,name:t},e.nups++},ht=function(e,t,n,r){if(null===e)st(n,Je.VVOID,0);else{let a=function(e,t){for(let n=e.nactvar-1;n>=0;n--)if(ze(t,_t(e,n).varname))return n;return-1}(e,t);if(a>=0)st(n,Je.VLOCAL,a),r||function(e,t){let n=e.bl;for(;n.nactvar>t;)n=n.previous;n.upval=1}(e,a);else{let r=function(e,t){let n=e.f.upvalues;for(let r=0;r<e.nups;r++)if(ze(n[r].name,t))return r;return-1}(e,t);if(r<0){if(ht(e.prev,t,n,0),n.k===Je.VVOID)return;r=dt(e,t,n)}st(n,Je.VUPVAL,r)}}},Lt=function(e,t){let n=lt(e),r=e.fs;if(ht(r,n,t,1),t.k===Je.VVOID){let a=new qe;ht(r,e.envn,t,1),xe(t.k!==Je.VVOID),ot(e,a,n),Z(r,t,a)}},gt=function(e,t,n,r){let a=e.fs,u=t-n;if(Xe(r.k))++u<0&&(u=0),pe(a,r,u),u>1&&se(a,u-1);else if(r.k!==Je.VVOID&&H(a,r),u>0){let e=a.freereg;se(a,u),te(a,e,u)}n>t&&(e.fs.freereg-=n-t)},At=function(e){let t=e.L;++t.nCcalls,et(e.fs,t.nCcalls,Te,a("JS levels",!0))},Tt=function(e){return e.L.nCcalls--},bt=function(e,t,n){let r=e.fs,u=e.dyd.gt,l=u.arr[t];if(xe(ze(l.name,n.name)),l.nactvar<n.nactvar){let t=_t(r,l.nactvar).varname,n=Oe.luaO_pushfstring(e.L,a("<goto %s> at line %d jumps into the scope of local '%s'"),l.name.getstr(),l.line,t.getstr());Qe(e,n)}re(r,l.pc,n.pc);for(let a=t;a<u.n-1;a++)u.arr[a]=u.arr[a+1];u.n--},xt=function(e,t){let n=e.fs.bl,r=e.dyd,a=r.gt.arr[t];for(let u=n.firstlabel;u<r.label.n;u++){let l=r.label.arr[u];if(ze(l.name,a.name))return a.nactvar>l.nactvar&&(n.upval||r.label.n>n.firstlabel)&&ne(e.fs,a.pc,l.nactvar),bt(e,t,l),!0}return!1},Ot=function(e,t,n,r,a){let u=t.n;return t.arr[u]=new class{constructor(){this.name=null,this.pc=NaN,this.line=NaN,this.nactvar=NaN}},t.arr[u].name=n,t.arr[u].line=r,t.arr[u].nactvar=e.fs.nactvar,t.arr[u].pc=a,t.n=u+1,u},kt=function(e,t){let n=e.dyd.gt,r=e.fs.bl.firstgoto;for(;r<n.n;)ze(n.arr[r].name,t.name)?bt(e,r,t):r++},vt=function(e,t,n){t.isloop=n,t.nactvar=e.nactvar,t.firstlabel=e.ls.dyd.label.n,t.firstgoto=e.ls.dyd.gt.n,t.upval=0,t.previous=e.bl,e.bl=t,xe(e.freereg===e.nactvar)},Et=function(e,t,n){t.prev=e.fs,t.ls=e,e.fs=t,t.pc=0,t.lasttarget=0,t.jpc=y,t.freereg=0,t.nk=0,t.np=0,t.nups=0,t.nlocvars=0,t.nactvar=0,t.firstlocal=e.dyd.actvar.n,t.bl=null;let r=t.f;r.source=e.source,r.maxstacksize=2,vt(t,n,!1)},mt=function(e){let t=e.bl,n=e.ls;if(t.previous&&t.upval){let n=$(e);ne(e,n,t.nactvar),ae(e,n)}t.isloop&&function(e){let t=Ke(e.L,"break"),n=Ot(e,e.dyd.label,t,0,e.fs.pc);kt(e,e.dyd.label.arr[n])}(n),e.bl=t.previous,function(e,t){for(e.ls.dyd.actvar.n-=e.nactvar-t;e.nactvar>t;)_t(e,--e.nactvar).endpc=e.pc}(e,t.nactvar),xe(t.nactvar===e.nactvar),e.freereg=e.nactvar,n.dyd.label.n=t.firstlabel,t.previous?function(e,t){let n=t.firstgoto,r=e.ls.dyd.gt;for(;n<r.n;){let a=r.arr[n];a.nactvar>t.nactvar&&(t.upval&&ne(e,a.pc,t.nactvar),a.nactvar=t.nactvar),xt(e.ls,n)||n++}}(e,t):t.firstgoto<n.dyd.gt.n&&function(e,t){let n=Ae.isreserved(t.name)?"<%s> at line %d not inside a loop":"no visible label '%s' for <goto> at line %d";n=Oe.luaO_pushfstring(e.L,a(n),t.name.getstr(),t.line),Qe(e,n)}(n,n.dyd.gt.arr[t.firstgoto])},Rt=function(e){let t=e.fs;oe(t,0,0),mt(t),xe(null===t.bl),e.fs=t.prev},Ut=function(e,t){switch(e.t.token){case He.TK_ELSE:case He.TK_ELSEIF:case He.TK_END:case He.TK_EOS:return!0;case He.TK_UNTIL:return t;default:return!1}},Nt=function(e){for(;!Ut(e,1);){if(e.t.token===He.TK_RETURN)return void Qt(e);Qt(e)}},wt=function(e,t){let n=e.fs,r=new qe;F(n,t),Ae.luaX_next(e),it(e,r),Z(n,t,r)},St=function(e,t){Ae.luaX_next(e),Ft(e,t),X(e.fs,t),rt(e,93)},yt=function(e,t){let n=e.fs,r=e.fs.freereg,u=new qe,l=new qe;e.t.token===He.TK_NAME?(et(n,t.nh,be,a("items in a constructor",!0)),it(e,u)):St(e,u),t.nh++,rt(e,61);let s=K(n,u);Ft(e,l),P(n,we,t.t.u.info,s,K(n,l)),n.freereg=r},It=function(e,t){t.v.k!==Je.VVOID&&(H(e,t.v),t.v.k=Je.VVOID,t.tostore===Pe&&(ce(e,t.t.u.info,t.na,t.tostore),t.tostore=0))},Mt=function(e,t){Ft(e,t.v),et(e.fs,t.na,be,a("items in a constructor",!0)),t.na++,t.tostore++},Pt=function(e,t){switch(e.t.token){case He.TK_NAME:61!==Ae.luaX_lookahead(e)?Mt(e,t):yt(e,t);break;case 91:yt(e,t);break;default:Mt(e,t)}},Ct=function(e,t){let n=e.fs,a=e.linenumber,u=P(n,Ne,0,0,0),l=new class{constructor(){this.v=new qe,this.t=new qe,this.nh=NaN,this.na=NaN,this.tostore=NaN}};l.na=l.nh=l.tostore=0,l.t=t,st(t,Je.VRELOCABLE,u),st(l.v,Je.VVOID,0),H(e.fs,t),rt(e,123);do{if(xe(l.v.k===Je.VVOID||l.tostore>0),125===e.t.token)break;It(n,l),Pt(e,l)}while(tt(e,44)||tt(e,59));ut(e,125,123,a),function(e,t){0!==t.tostore&&(Xe(t.v.k)?(fe(e,t.v),ce(e,t.t.u.info,t.na,r),t.na--):(t.v.k!==Je.VVOID&&H(e,t.v),ce(e,t.t.u.info,t.na,t.tostore)))}(n,l),Ce(n.f.code[u],Oe.luaO_int2fb(l.na)),De(n.f.code[u],Oe.luaO_int2fb(l.nh))},Dt=function(e,t,n,r){let u=new Ze,l=new Ye;u.f=function(e){let t=e.L,n=new Fe(t),r=e.fs;return r.f.p[r.np++]=n,n}(e),u.f.linedefined=r,Et(e,u,l),rt(e,40),n&&(ft(e,"self"),pt(e,1)),function(e){let t=e.fs,n=t.f,r=0;if(n.is_vararg=!1,41!==e.t.token)do{switch(e.t.token){case He.TK_NAME:ct(e,lt(e)),r++;break;case He.TK_DOTS:Ae.luaX_next(e),n.is_vararg=!0;break;default:Ae.luaX_syntaxerror(e,a("<name> or '...' expected",!0))}}while(!n.is_vararg&&tt(e,44));pt(e,r),n.numparams=t.nactvar,se(t,t.nactvar)}(e),rt(e,41),Nt(e),u.f.lastlinedefined=e.linenumber,ut(e,He.TK_END,He.TK_FUNCTION,r),function(e,t){let n=e.fs.prev;st(t,Je.VRELOCABLE,C(n,ve,0,n.np-1)),H(n,t)}(e,t),Rt(e)},Vt=function(e,t){let n=1;for(Ft(e,t);tt(e,44);)H(e.fs,t),Ft(e,t),n++;return n},Bt=function(e,t,n){let u,l=e.fs,s=new qe;switch(e.t.token){case 40:Ae.luaX_next(e),41===e.t.token?s.k=Je.VVOID:(Vt(e,s),fe(l,s)),ut(e,41,40,n);break;case 123:Ct(e,s);break;case He.TK_STRING:ot(e,s,e.t.seminfo.ts),Ae.luaX_next(e);break;default:Ae.luaX_syntaxerror(e,a("function arguments expected",!0))}xe(t.k===Je.VNONRELOC);let o=t.u.info;Xe(s.k)?u=r:(s.k!==Je.VVOID&&H(l,s),u=l.freereg-(o+1)),st(t,Je.VCALL,P(l,ke,o,u+1,2)),z(l,n),l.freereg=o+1},Gt=function(e,t){let n=e.fs,r=e.linenumber;for(function(e,t){switch(e.t.token){case 40:{let n=e.linenumber;return Ae.luaX_next(e),Ft(e,t),ut(e,41,40,n),void G(e.fs,t)}case He.TK_NAME:return void Lt(e,t);default:Ae.luaX_syntaxerror(e,a("unexpected symbol",!0))}}(e,t);;)switch(e.t.token){case 46:wt(e,t);break;case 91:{let r=new qe;F(n,t),St(e,r),Z(n,t,r);break}case 58:{let a=new qe;Ae.luaX_next(e),it(e,a),ie(n,t,a),Bt(e,t,r);break}case 40:case He.TK_STRING:case 123:H(n,t),Bt(e,t,r);break;default:return}},Kt=[{left:10,right:10},{left:10,right:10},{left:11,right:11},{left:11,right:11},{left:14,right:13},{left:11,right:11},{left:11,right:11},{left:6,right:6},{left:4,right:4},{left:5,right:5},{left:7,right:7},{left:7,right:7},{left:9,right:8},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:3,right:3},{left:2,right:2},{left:1,right:1}],jt=function(e,t,n){At(e);let r=function(e){switch(e){case He.TK_NOT:return w;case 45:return N;case 126:return R;case 35:return U;default:return S}}(e.t.token);if(r!==S){let n=e.linenumber;Ae.luaX_next(e),jt(e,t,12),le(e.fs,r,t,n)}else!function(e,t){switch(e.t.token){case He.TK_FLT:st(t,Je.VKFLT,0),t.u.nval=e.t.seminfo.r;break;case He.TK_INT:st(t,Je.VKINT,0),t.u.ival=e.t.seminfo.i;break;case He.TK_STRING:ot(e,t,e.t.seminfo.ts);break;case He.TK_NIL:st(t,Je.VNIL,0);break;case He.TK_TRUE:st(t,Je.VTRUE,0);break;case He.TK_FALSE:st(t,Je.VFALSE,0);break;case He.TK_DOTS:{let n=e.fs;at(e,n.f.is_vararg,a("cannot use '...' outside a vararg function",!0)),st(t,Je.VVARARG,P(n,Me,0,1,0));break}case 123:return void Ct(e,t);case He.TK_FUNCTION:return Ae.luaX_next(e),void Dt(e,t,0,e.linenumber);default:return void Gt(e,t)}Ae.luaX_next(e)}(e,t);let y=function(e){switch(e){case 43:return u;case 45:return m;case 42:return T;case 37:return A;case 94:return k;case 47:return f;case He.TK_IDIV:return h;case 38:return s;case 124:return o;case 126:return i;case He.TK_SHL:return v;case He.TK_SHR:return E;case He.TK_CONCAT:return c;case He.TK_NE:return b;case He.TK_EQ:return _;case 60:return g;case He.TK_LE:return L;case 62:return d;case He.TK_GE:return p;case He.TK_AND:return l;case He.TK_OR:return O;default:return x}}(e.t.token);for(;y!==x&&Kt[y].left>n;){let n=new qe,r=e.linenumber;Ae.luaX_next(e),W(e.fs,y,t);let a=jt(e,n,Kt[y].right);ue(e.fs,y,t,n,r),y=a}return Tt(e),y},Ft=function(e,t){jt(e,t,0)},Ht=function(e){let t=e.fs,n=new Ye;vt(t,n,0),Nt(e),mt(t)};class Xt{constructor(){this.prev=null,this.v=new qe}}const zt=function(e,t,n){let r=new qe;if(at(e,function(e){return Je.VLOCAL<=e&&e<=Je.VINDEXED}(t.v.k),a("syntax error",!0)),tt(e,44)){let r=new Xt;r.prev=t,Gt(e,r.v),r.v.k!==Je.VINDEXED&&function(e,t,n){let r=e.fs,a=r.freereg,u=!1;for(;t;t=t.prev)t.v.k===Je.VINDEXED&&(t.v.u.ind.vt===n.k&&t.v.u.ind.t===n.u.info&&(u=!0,t.v.u.ind.vt=Je.VLOCAL,t.v.u.ind.t=a),n.k===Je.VLOCAL&&t.v.u.ind.idx===n.u.info&&(u=!0,t.v.u.ind.idx=a));if(u){let e=n.k===Je.VLOCAL?Ue:Re;P(r,e,a,n.u.info,0),se(r,1)}}(e,t,r.v),et(e.fs,n+e.L.nCcalls,Te,a("JS levels",!0)),zt(e,r,n+1)}else{rt(e,61);let a=Vt(e,r);if(a===n)return _e(e.fs,r),void de(e.fs,t.v,r);gt(e,n,a,r)}st(r,Je.VNONRELOC,e.fs.freereg-1),de(e.fs,t.v,r)},Yt=function(e){let t=new qe;return Ft(e,t),t.k===Je.VNIL&&(t.k=Je.VFALSE),q(e.fs,t),t.f},Jt=function(e,t){let n,r=e.linenumber;tt(e,He.TK_GOTO)?n=lt(e):(Ae.luaX_next(e),n=Ke(e.L,"break"));let a=Ot(e,e.dyd.gt,n,r,t);xt(e,a)},qt=function(e){let t=new qe;return Ft(e,t),H(e.fs,t),xe(t.k===Je.VNONRELOC),t.u.info},Zt=function(e,t,n,r,a){let u,l=new Ye,s=e.fs;pt(e,3),rt(e,He.TK_DO);let o=a?D(s,me,t,y):$(s);vt(s,l,0),pt(e,r),se(s,r),Ht(e),mt(s),ae(s,o),a?u=D(s,Ee,t,y):(P(s,ye,t,0,r),z(s,n),u=D(s,Ie,t+2,y)),re(s,u,o+1),z(s,n)},Wt=function(e,t){let n,r=new Ye,a=e.fs,u=new qe;if(Ae.luaX_next(e),Ft(e,u),rt(e,He.TK_THEN),e.t.token===He.TK_GOTO||e.t.token===He.TK_BREAK){for(J(e.fs,u),vt(a,r,!1),Jt(e,u.t);tt(e,59););if(Ut(e,0))return mt(a),t;n=$(a)}else q(e.fs,u),vt(a,r,!1),n=u.f;return Nt(e),mt(a),e.t.token!==He.TK_ELSE&&e.t.token!==He.TK_ELSEIF||(t=B(a,t,$(a))),ae(a,n),t},Qt=function(e){let t=e.linenumber;switch(At(e),e.t.token){case 59:Ae.luaX_next(e);break;case He.TK_IF:!function(e,t){let n=e.fs,r=y;for(r=Wt(e,r);e.t.token===He.TK_ELSEIF;)r=Wt(e,r);tt(e,He.TK_ELSE)&&Ht(e),ut(e,He.TK_END,He.TK_IF,t),ae(n,r)}(e,t);break;case He.TK_WHILE:!function(e,t){let n=e.fs,r=new Ye;Ae.luaX_next(e);let a=Y(n),u=Yt(e);vt(n,r,1),rt(e,He.TK_DO),Ht(e),ee(n,a),ut(e,He.TK_END,He.TK_WHILE,t),mt(n),ae(n,u)}(e,t);break;case He.TK_DO:Ae.luaX_next(e),Ht(e),ut(e,He.TK_END,He.TK_DO,t);break;case He.TK_FOR:!function(e,t){let n=e.fs,r=new Ye;vt(n,r,1),Ae.luaX_next(e);let u=lt(e);switch(e.t.token){case 61:!function(e,t,n){let r=e.fs,a=r.freereg;ft(e,"(for index)"),ft(e,"(for limit)"),ft(e,"(for step)"),ct(e,t),rt(e,61),qt(e),rt(e,44),qt(e),tt(e,44)?qt(e):(V(r,r.freereg,Q(r,1)),se(r,1)),Zt(e,a,n,1,1)}(e,u,t);break;case 44:case He.TK_IN:!function(e,t){let n=e.fs,r=new qe,a=4,u=n.freereg;for(ft(e,"(for generator)"),ft(e,"(for state)"),ft(e,"(for control)"),ct(e,t);tt(e,44);)ct(e,lt(e)),a++;rt(e,He.TK_IN);let l=e.linenumber;gt(e,3,Vt(e,r),r),M(n,3),Zt(e,u,l,a-3,0)}(e,u);break;default:Ae.luaX_syntaxerror(e,a("'=' or 'in' expected",!0))}ut(e,He.TK_END,He.TK_FOR,t),mt(n)}(e,t);break;case He.TK_REPEAT:!function(e,t){let n=e.fs,r=Y(n),a=new Ye,u=new Ye;vt(n,a,1),vt(n,u,0),Ae.luaX_next(e),Nt(e),ut(e,He.TK_UNTIL,He.TK_REPEAT,t);let l=Yt(e);u.upval&&ne(n,l,u.nactvar),mt(n),re(n,l,r),mt(n)}(e,t);break;case He.TK_FUNCTION:!function(e,t){let n=new qe,r=new qe;Ae.luaX_next(e);let a=function(e,t){let n=0;for(Lt(e,t);46===e.t.token;)wt(e,t);return 58===e.t.token&&(n=1,wt(e,t)),n}(e,n);Dt(e,r,a,t),de(e.fs,n,r),z(e.fs,t)}(e,t);break;case He.TK_LOCAL:Ae.luaX_next(e),tt(e,He.TK_FUNCTION)?function(e){let t=new qe,n=e.fs;ct(e,lt(e)),pt(e,1),Dt(e,t,0,e.linenumber),_t(n,t.u.info).startpc=n.pc}(e):function(e){let t,n=0,r=new qe;do{ct(e,lt(e)),n++}while(tt(e,44));tt(e,61)?t=Vt(e,r):(r.k=Je.VVOID,t=0),gt(e,n,t,r),pt(e,n)}(e);break;case He.TK_DBCOLON:Ae.luaX_next(e),function(e,t,n){let r,u=e.fs,l=e.dyd.label;!function(e,t,n){for(let r=e.bl.firstlabel;r<t.n;r++)if(ze(n,t.arr[r].name)){let u=Oe.luaO_pushfstring(e.ls.L,a("label '%s' already defined on line %d",!0),n.getstr(),t.arr[r].line);Qe(e.ls,u)}}(u,l,t),rt(e,He.TK_DBCOLON),r=Ot(e,l,t,n,Y(u)),function(e){for(;59===e.t.token||e.t.token===He.TK_DBCOLON;)Qt(e)}(e),Ut(e,0)&&(l.arr[r].nactvar=u.bl.nactvar),kt(e,l.arr[r])}(e,lt(e),t);break;case He.TK_RETURN:Ae.luaX_next(e),function(e){let t,n,a=e.fs,u=new qe;Ut(e,1)||59===e.t.token?t=n=0:(n=Vt(e,u),Xe(u.k)?(fe(a,u),u.k===Je.VCALL&&1===n&&(Ve(I(a,u),Se),xe(I(a,u).A===a.nactvar)),t=a.nactvar,n=r):1===n?t=j(a,u):(H(a,u),t=a.nactvar,xe(n===a.freereg-t))),oe(a,t,n),tt(e,59)}(e);break;case He.TK_BREAK:case He.TK_GOTO:Jt(e,$(e.fs));break;default:!function(e){let t=e.fs,n=new Xt;Gt(e,n.v),61===e.t.token||44===e.t.token?(n.prev=null,zt(e,n,1)):(at(e,n.v.k===Je.VCALL,a("syntax error",!0)),De(I(t,n.v),1))}(e)}xe(e.fs.f.maxstacksize>=e.fs.freereg&&e.fs.freereg>=e.fs.nactvar),e.fs.freereg=e.fs.nactvar,Tt(e)};e.exports.Dyndata=class{constructor(){this.actvar={arr:[],n:NaN,size:NaN},this.gt=new We,this.label=new We}},e.exports.expkind=Je,e.exports.expdesc=qe,e.exports.luaY_parser=function(e,t,n,r,a,u){let l=new Ae.LexState,s=new Ze,o=ge.luaF_newLclosure(e,1);return Le.luaD_inctop(e),e.stack[e.top-1].setclLvalue(o),l.h=je.luaH_new(e),Le.luaD_inctop(e),e.stack[e.top-1].sethvalue(l.h),s.f=o.p=new Fe(e),s.f.source=Ge(e,a),l.buff=n,l.dyd=r,r.actvar.n=r.gt.n=r.label.n=0,Ae.luaX_setinput(e,l,t,s.f.source,u),function(e,t){let n=new Ye,r=new qe;Et(e,t,n),t.f.is_vararg=!0,st(r,Je.VLOCAL,0),dt(t,e.envn,r),Ae.luaX_next(e),Nt(e),nt(e,He.TK_EOS),Rt(e)}(l,s),xe(!s.prev&&1===s.nups&&!l.fs),xe(0===r.actvar.n&&0===r.gt.n&&0===r.label.n),delete e.stack[--e.top],o},e.exports.vkisinreg=function(e){return e===Je.VNONRELOC||e===Je.VLOCAL}},function(e,t,n){"use strict";const{LUA_MULTRET:r,LUA_OK:a,LUA_TFUNCTION:u,LUA_TNIL:l,LUA_TNONE:s,LUA_TNUMBER:o,LUA_TSTRING:i,LUA_TTABLE:c,LUA_VERSION:f,LUA_YIELD:_,lua_call:p,lua_callk:d,lua_concat:h,lua_error:L,lua_getglobal:g,lua_geti:A,lua_getmetatable:T,lua_gettop:b,lua_insert:x,lua_isnil:O,lua_isnone:k,lua_isstring:v,lua_load:E,lua_next:m,lua_pcallk:R,lua_pop:U,lua_pushboolean:N,lua_pushcfunction:w,lua_pushglobaltable:S,lua_pushinteger:y,lua_pushliteral:I,lua_pushnil:M,lua_pushstring:P,lua_pushvalue:C,lua_rawequal:D,lua_rawget:V,lua_rawlen:B,lua_rawset:G,lua_remove:K,lua_replace:j,lua_rotate:F,lua_setfield:H,lua_setmetatable:X,lua_settop:z,lua_setupvalue:Y,lua_stringtonumber:J,lua_toboolean:q,lua_tolstring:Z,lua_tostring:W,lua_type:Q,lua_typename:$}=n(2),{luaL_argcheck:ee,luaL_checkany:te,luaL_checkinteger:ne,luaL_checkoption:re,luaL_checkstack:ae,luaL_checktype:ue,luaL_error:le,luaL_getmetafield:se,luaL_loadbufferx:oe,luaL_loadfile:ie,luaL_loadfilex:ce,luaL_optinteger:fe,luaL_optstring:_e,luaL_setfuncs:pe,luaL_tolstring:de,luaL_where:he}=n(7),{to_jsstring:Le,to_luastring:ge}=n(5);let Ae,Te;if("function"==typeof TextDecoder){let e="",t=new TextDecoder("utf-8");Ae=function(n){e+=t.decode(n,{stream:!0})};let n=new Uint8Array(0);Te=function(){e+=t.decode(n),console.log(e),e=""}}else{let e=[];Ae=function(t){try{t=Le(t)}catch(e){let r=new Uint8Array(t.length);r.set(t),t=r}e.push(t)},Te=function(){console.log.apply(console.log,e),e=[]}}const be=["stop","restart","collect","count","step","setpause","setstepmul","isrunning"].map((e=>ge(e))),xe=function(e){return ue(e,1,c),z(e,2),m(e,1)?2:(M(e),1)},Oe=function(e){let t=ne(e,2)+1;return y(e,t),A(e,1,t)===l?1:2},ke=function(e){let t=fe(e,2,1);return z(e,1),Q(e,1)===i&&t>0&&(he(e,t),C(e,1),h(e,2)),L(e)},ve=function(e,t,n){return t!==a&&t!==_?(N(e,0),C(e,-2),2):b(e)-n},Ee=function(e,t,n){return t===a?(0!==n&&(C(e,n),Y(e,-2,1)||U(e,1)),1):(M(e),x(e,-2),2)},me=function(e,t){return ae(e,2,"too many nested functions"),C(e,1),p(e,0,1),O(e,-1)?(U(e,1),null):(v(e,-1)||le(e,ge("reader function must return a string")),j(e,5),W(e,5))},Re=function(e,t,n){return b(e)-1},Ue={assert:function(e){return q(e,1)?b(e):(te(e,1),K(e,1),I(e,"assertion failed!"),z(e,1),ke(e))},collectgarbage:function(e){re(e,1,"collect",be),fe(e,2,0),le(e,ge("lua_gc not implemented"))},dofile:function(e){let t=_e(e,1,null);return z(e,1),ie(e,t)!==a?L(e):(d(e,0,r,0,Re),Re(e))},error:ke,getmetatable:function(e){return te(e,1),T(e,1)?(se(e,1,ge("__metatable",!0)),1):(M(e),1)},ipairs:function(e){return te(e,1),w(e,Oe),C(e,1),y(e,0),3},load:function(e){let t,n=W(e,1),r=_e(e,3,"bt"),a=k(e,4)?0:4;if(null!==n){let a=_e(e,2,n);t=oe(e,n,n.length,a,r)}else{let n=_e(e,2,"=(load)");ue(e,1,u),z(e,5),t=E(e,me,null,n,r)}return Ee(e,t,a)},loadfile:function(e){let t=_e(e,1,null),n=_e(e,2,null),r=k(e,3)?0:3,a=ce(e,t,n);return Ee(e,a,r)},next:xe,pairs:function(e){return function(e,t,n,r){return te(e,1),se(e,1,t)===l?(w(e,r),C(e,1),M(e)):(C(e,1),p(e,1,3)),3}(e,ge("__pairs",!0),0,xe)},pcall:function(e){te(e,1),N(e,1),x(e,1);let t=R(e,b(e)-2,r,0,0,ve);return ve(e,t,0)},print:function(e){let t=b(e);g(e,ge("tostring",!0));for(let n=1;n<=t;n++){C(e,-1),C(e,n),p(e,1,1);let t=Z(e,-1);if(null===t)return le(e,ge("'tostring' must return a string to 'print'"));n>1&&Ae(ge("\t")),Ae(t),U(e,1)}return Te(),0},rawequal:function(e){return te(e,1),te(e,2),N(e,D(e,1,2)),1},rawget:function(e){return ue(e,1,c),te(e,2),z(e,2),V(e,1),1},rawlen:function(e){let t=Q(e,1);return ee(e,t===c||t===i,1,"table or string expected"),y(e,B(e,1)),1},rawset:function(e){return ue(e,1,c),te(e,2),te(e,3),z(e,3),G(e,1),1},select:function(e){let t=b(e);if(Q(e,1)===i&&35===W(e,1)[0])return y(e,t-1),1;{let n=ne(e,1);return n<0?n=t+n:n>t&&(n=t),ee(e,1<=n,1,"index out of range"),t-n}},setmetatable:function(e){let t=Q(e,2);return ue(e,1,c),ee(e,t===l||t===c,2,"nil or table expected"),se(e,1,ge("__metatable",!0))!==l?le(e,ge("cannot change a protected metatable")):(z(e,2),X(e,1),1)},tonumber:function(e){if(Q(e,2)<=0){if(te(e,1),Q(e,1)===o)return z(e,1),1;{let t=W(e,1);if(null!==t&&J(e,t)===t.length+1)return 1}}else{let t=ne(e,2);ue(e,1,i);let n=W(e,1);ee(e,2<=t&&t<=36,2,"base out of range");let r=function(e,t){try{e=Le(e)}catch(e){return null}let n=/^[\t\v\f \n\r]*([+-]?)0*([0-9A-Za-z]+)[\t\v\f \n\r]*$/.exec(e);if(!n)return null;let r=parseInt(n[1]+n[2],t);return isNaN(r)?null:0|r}(n,t);if(null!==r)return y(e,r),1}return M(e),1},tostring:function(e){return te(e,1),de(e,1),1},type:function(e){let t=Q(e,1);return ee(e,t!==s,1,"value expected"),P(e,$(e,t)),1},xpcall:function(e){let t=b(e);ue(e,2,u),N(e,1),C(e,1),F(e,3,2);let n=R(e,t-2,r,2,2,ve);return ve(e,n,2)}};e.exports.luaopen_base=function(e){return S(e),pe(e,Ue,0),C(e,-1),H(e,-2,ge("_G")),I(e,f),H(e,-2,ge("_VERSION")),1}},function(e,t,n){"use strict";const{LUA_OK:r,LUA_TFUNCTION:a,LUA_TSTRING:u,LUA_YIELD:l,lua_Debug:s,lua_checkstack:o,lua_concat:i,lua_error:c,lua_getstack:f,lua_gettop:_,lua_insert:p,lua_isyieldable:d,lua_newthread:h,lua_pop:L,lua_pushboolean:g,lua_pushcclosure:A,lua_pushliteral:T,lua_pushthread:b,lua_pushvalue:x,lua_resume:O,lua_status:k,lua_tothread:v,lua_type:E,lua_upvalueindex:m,lua_xmove:R,lua_yield:U}=n(2),{luaL_argcheck:N,luaL_checktype:w,luaL_newlib:S,luaL_where:y}=n(7),I=function(e){let t=v(e,1);return N(e,t,1,"thread expected"),t},M=function(e,t,n){if(!o(t,n))return T(e,"too many arguments to resume"),-1;if(k(t)===r&&0===_(t))return T(e,"cannot resume dead coroutine"),-1;R(e,t,n);let a=O(t,e,n);if(a===r||a===l){let n=_(t);return o(e,n+1)?(R(t,e,n),n):(L(t,n),T(e,"too many results to resume"),-1)}return R(t,e,1),-1},P=function(e){let t=v(e,m(1)),n=M(e,t,_(e));return n<0?(E(e,-1)===u&&(y(e,1),p(e,-2),i(e,2)),c(e)):n},C=function(e){w(e,1,a);let t=h(e);return x(e,1),R(e,t,1),1},D={create:C,isyieldable:function(e){return g(e,d(e)),1},resume:function(e){let t=I(e),n=M(e,t,_(e)-1);return n<0?(g(e,0),p(e,-2),2):(g(e,1),p(e,-(n+1)),n+1)},running:function(e){return g(e,b(e)),2},status:function(e){let t=I(e);if(e===t)T(e,"running");else switch(k(t)){case l:T(e,"suspended");break;case r:{let n=new s;f(t,0,n)>0?T(e,"normal"):0===_(t)?T(e,"dead"):T(e,"suspended");break}default:T(e,"dead")}return 1},wrap:function(e){return C(e),A(e,P,1),1},yield:function(e){return U(e,_(e))}};e.exports.luaopen_coroutine=function(e){return S(e,D),1}},function(e,t,n){"use strict";const{LUA_MAXINTEGER:r}=n(3),{LUA_OPEQ:a,LUA_OPLT:u,LUA_TFUNCTION:l,LUA_TNIL:s,LUA_TTABLE:o,lua_call:i,lua_checkstack:c,lua_compare:f,lua_createtable:_,lua_geti:p,lua_getmetatable:d,lua_gettop:h,lua_insert:L,lua_isnil:g,lua_isnoneornil:A,lua_isstring:T,lua_pop:b,lua_pushinteger:x,lua_pushnil:O,lua_pushstring:k,lua_pushvalue:v,lua_rawget:E,lua_setfield:m,lua_seti:R,lua_settop:U,lua_toboolean:N,lua_type:w}=n(2),{luaL_Buffer:S,luaL_addlstring:y,luaL_addvalue:I,luaL_argcheck:M,luaL_buffinit:P,luaL_checkinteger:C,luaL_checktype:D,luaL_error:V,luaL_len:B,luaL_newlib:G,luaL_opt:K,luaL_optinteger:j,luaL_optlstring:F,luaL_pushresult:H,luaL_typename:X}=n(7),z=n(17),{to_luastring:Y}=n(5),J=function(e,t,n){return k(e,t),E(e,-n)!==s},q=function(e,t,n){if(w(e,t)!==o){let r=1;!d(e,t)||1&n&&!J(e,Y("__index",!0),++r)||2&n&&!J(e,Y("__newindex",!0),++r)||4&n&&!J(e,Y("__len",!0),++r)?D(e,t,o):b(e,r)}},Z=function(e,t,n){return q(e,t,4|n),B(e,t)},W=function(e,t,n){p(e,1,n),T(e,-1)||V(e,Y("invalid value (%s) at index %d in table for 'concat'"),X(e,-1),n),I(t)},Q=function(e,t,n){R(e,1,t),R(e,1,n)},$=function(e,t,n){if(g(e,2))return f(e,t,n,u);{v(e,2),v(e,t-1),v(e,n-2),i(e,2,1);let r=N(e,-1);return b(e,1),r}},ee=function(e,t,n){let r=t,a=n-1;for(;;){for(;p(e,1,++r),$(e,-1,-2);)r==n-1&&V(e,Y("invalid order function for sorting")),b(e,1);for(;p(e,1,--a),$(e,-3,-1);)a<r&&V(e,Y("invalid order function for sorting")),b(e,1);if(a<r)return b(e,1),Q(e,n-1,r),r;Q(e,r,a)}},te=function(e,t,n){let r=Math.floor((t-e)/4),a=n%(2*r)+(e+r);return z.lua_assert(e+r<=a&&a<=t-r),a},ne=function(e,t,n,r){for(;t<n;){if(p(e,1,t),p(e,1,n),$(e,-1,-2)?Q(e,t,n):b(e,2),n-t==1)return;let a,u;if(a=n-t<100||0===r?Math.floor((t+n)/2):te(t,n,r),p(e,1,a),p(e,1,t),$(e,-2,-1)?Q(e,a,t):(b(e,1),p(e,1,n),$(e,-1,-2)?Q(e,a,n):b(e,2)),n-t==2)return;p(e,1,a),v(e,-1),p(e,1,n-1),Q(e,a,n-1),(a=ee(e,t,n))-t<n-a?(ne(e,t,a-1,r),u=a-t,t=a+1):(ne(e,a+1,n,r),u=n-a,n=a-1),(n-t)/128>u&&(r=Math.floor(4294967296*Math.random()))}},re={concat:function(e){let t=Z(e,1,1),n=F(e,2,""),r=n.length,a=j(e,3,1);t=j(e,4,t);let u=new S;for(P(e,u);a<t;a++)W(e,u,a),y(u,n,r);return a===t&&W(e,u,a),H(u),1},insert:function(e){let t,n=Z(e,1,3)+1;switch(h(e)){case 2:t=n;break;case 3:t=C(e,2),M(e,1<=t&&t<=n,2,"position out of bounds");for(let r=n;r>t;r--)p(e,1,r-1),R(e,1,r);break;default:return V(e,"wrong number of arguments to 'insert'")}return R(e,1,t),0},move:function(e){let t=C(e,2),n=C(e,3),u=C(e,4),l=A(e,5)?1:5;if(q(e,1,1),q(e,l,2),n>=t){M(e,t>0||n<r+t,3,"too many elements to move");let s=n-t+1;if(M(e,u<=r-s+1,4,"destination wrap around"),u>n||u<=t||1!==l&&1!==f(e,1,l,a))for(let n=0;n<s;n++)p(e,1,t+n),R(e,l,u+n);else for(let n=s-1;n>=0;n--)p(e,1,t+n),R(e,l,u+n)}return v(e,l),1},pack:function(e){let t=h(e);_(e,t,1),L(e,1);for(let n=t;n>=1;n--)R(e,1,n);return x(e,t),m(e,1,Y("n")),1},remove:function(e){let t=Z(e,1,3),n=j(e,2,t);for(n!==t&&M(e,1<=n&&n<=t+1,1,"position out of bounds"),p(e,1,n);n<t;n++)p(e,1,n+1),R(e,1,n);return O(e),R(e,1,n),1},sort:function(e){let t=Z(e,1,3);return t>1&&(M(e,t<r,1,"array too big"),A(e,2)||D(e,2,l),U(e,2),ne(e,1,t,0)),0},unpack:function(e){let t=j(e,2,1),n=K(e,C,3,B(e,1));if(t>n)return 0;let r=n-t;if(r>=Number.MAX_SAFE_INTEGER||!c(e,++r))return V(e,Y("too many results to unpack"));for(;t<n;t++)p(e,1,t);return p(e,1,n),r}};e.exports.luaopen_table=function(e){return G(e,re),1}},function(e,t,n){"use strict";const{LUA_TNIL:r,LUA_TTABLE:a,lua_close:u,lua_createtable:l,lua_getfield:s,lua_isboolean:o,lua_isnoneornil:i,lua_pop:c,lua_pushboolean:f,lua_pushfstring:_,lua_pushinteger:p,lua_pushliteral:d,lua_pushnil:h,lua_pushnumber:L,lua_pushstring:g,lua_setfield:A,lua_settop:T,lua_toboolean:b,lua_tointegerx:x}=n(2),{luaL_Buffer:O,luaL_addchar:k,luaL_addstring:v,luaL_argerror:E,luaL_buffinit:m,luaL_checkinteger:R,luaL_checkstring:U,luaL_checktype:N,luaL_error:w,luaL_execresult:S,luaL_fileresult:y,luaL_newlib:I,luaL_optinteger:M,luaL_optlstring:P,luaL_optstring:C,luaL_pushresult:D}=n(7),{luastring_eq:V,to_jsstring:B,to_luastring:G}=n(5),K=G("aAbBcCdDeFhHIjklmMnpPrRStTuUwWxXyYzZ%"),j=function(e,t,n){p(e,n),A(e,-2,G(t,!0))},F=function(e,t,n){j(e,"sec",n?t.getUTCSeconds():t.getSeconds()),j(e,"min",n?t.getUTCMinutes():t.getMinutes()),j(e,"hour",n?t.getUTCHours():t.getHours()),j(e,"day",n?t.getUTCDate():t.getDate()),j(e,"month",(n?t.getUTCMonth():t.getMonth())+1),j(e,"year",n?t.getUTCFullYear():t.getFullYear()),j(e,"wday",(n?t.getUTCDay():t.getDay())+1),j(e,"yday",Math.floor((t-new Date(t.getFullYear(),0,0))/864e5))},H=Number.MAX_SAFE_INTEGER/2,X=function(e,t,n,a){let u=s(e,-1,G(t,!0)),l=x(e,-1);if(!1===l){if(u!==r)return w(e,G("field '%s' is not an integer"),t);if(n<0)return w(e,G("field '%s' missing in date table"),t);l=n}else{if(!(-H<=l&&l<=H))return w(e,G("field '%s' is out-of-bound"),t);l-=a}return c(e,1),l},z={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map((e=>G(e))),shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((e=>G(e))),months:["January","February","March","April","May","June","July","August","September","October","November","December"].map((e=>G(e))),shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map((e=>G(e))),AM:G("AM"),PM:G("PM"),am:G("am"),pm:G("pm"),formats:{c:G("%a %b %e %H:%M:%S %Y"),D:G("%m/%d/%y"),F:G("%Y-%m-%d"),R:G("%H:%M"),r:G("%I:%M:%S %p"),T:G("%H:%M:%S"),X:G("%T"),x:G("%D")}},Y=function(e,t){let n=e.getDay();"monday"===t&&(0===n?n=6:n--);let r=(e-new Date(e.getFullYear(),0,1))/864e5;return Math.floor((r+7-n)/7)},J=function(e,t,n){t<10&&k(e,n),v(e,G(String(t)))},q=function(e,t,n,r){let a=0;for(;a<n.length;)if(37!==n[a])k(t,n[a++]);else{let u=Z(e,n,++a);switch(n[a]){case 37:k(t,37);break;case 65:v(t,z.days[r.getDay()]);break;case 66:v(t,z.months[r.getMonth()]);break;case 67:J(t,Math.floor(r.getFullYear()/100),48);break;case 68:q(e,t,z.formats.D,r);break;case 70:q(e,t,z.formats.F,r);break;case 72:J(t,r.getHours(),48);break;case 73:J(t,(r.getHours()+11)%12+1,48);break;case 77:J(t,r.getMinutes(),48);break;case 80:v(t,r.getHours()<12?z.am:z.pm);break;case 82:q(e,t,z.formats.R,r);break;case 83:J(t,r.getSeconds(),48);break;case 84:q(e,t,z.formats.T,r);break;case 85:J(t,Y(r,"sunday"),48);break;case 87:J(t,Y(r,"monday"),48);break;case 88:q(e,t,z.formats.X,r);break;case 89:v(t,G(String(r.getFullYear())));break;case 90:{let e=r.toString().match(/\(([\w\s]+)\)/);e&&v(t,G(e[1]));break}case 97:v(t,z.shortDays[r.getDay()]);break;case 98:case 104:v(t,z.shortMonths[r.getMonth()]);break;case 99:q(e,t,z.formats.c,r);break;case 100:J(t,r.getDate(),48);break;case 101:J(t,r.getDate(),32);break;case 106:{let e=Math.floor((r-new Date(r.getFullYear(),0,1))/864e5);e<100&&(e<10&&k(t,48),k(t,48)),v(t,G(String(e)));break}case 107:J(t,r.getHours(),32);break;case 108:J(t,(r.getHours()+11)%12+1,32);break;case 109:J(t,r.getMonth()+1,48);break;case 110:k(t,10);break;case 112:v(t,r.getHours()<12?z.AM:z.PM);break;case 114:q(e,t,z.formats.r,r);break;case 115:v(t,G(String(Math.floor(r/1e3))));break;case 116:k(t,8);break;case 117:{let e=r.getDay();v(t,G(String(0===e?7:e)));break}case 119:v(t,G(String(r.getDay())));break;case 120:q(e,t,z.formats.x,r);break;case 121:J(t,r.getFullYear()%100,48);break;case 122:{let e=r.getTimezoneOffset();e>0?k(t,45):(e=-e,k(t,43)),J(t,Math.floor(e/60),48),J(t,e%60,48);break}}a+=u}},Z=function(e,t,n){let r=K,a=0,u=1;for(;a<r.length&&u<=t.length-n;a+=u)if(r[a]==="|".charCodeAt(0))u++;else if(V(t.subarray(n,n+u),r.subarray(a,a+u)))return u;E(e,1,_(e,G("invalid conversion specifier '%%%s'"),t))},W=function(e,t){return R(e,t)},Q={date:function(e){let t=P(e,1,"%c"),n=i(e,2)?new Date:new Date(1e3*W(e,2)),r=!1,a=0;if(t[a]==="!".charCodeAt(0)&&(r=!0,a++),t[a]==="*".charCodeAt(0)&&t[a+1]==="t".charCodeAt(0))l(e,0,9),F(e,n,r);else{new Uint8Array(4)[0]="%".charCodeAt(0);let r=new O;m(e,r),q(e,r,t,n),D(r)}return 1},difftime:function(e){let t=W(e,1),n=W(e,2);return L(e,t-n),1},time:function(e){let t;return i(e,1)?t=new Date:(N(e,1,a),T(e,1),t=new Date(X(e,"year",-1,0),X(e,"month",-1,1),X(e,"day",-1,0),X(e,"hour",12,0),X(e,"min",0,0),X(e,"sec",0,0)),F(e,t)),p(e,Math.floor(t/1e3)),1},clock:function(e){return L(e,performance.now()/1e3),1}};e.exports.luaopen_os=function(e){return I(e,Q),1}},function(e,t,n){"use strict";const{sprintf:r}=n(38),{LUA_INTEGER_FMT:a,LUA_INTEGER_FRMLEN:u,LUA_MININTEGER:l,LUA_NUMBER_FMT:s,LUA_NUMBER_FRMLEN:o,frexp:i,lua_getlocaledecpoint:c}=n(3),{LUA_TBOOLEAN:f,LUA_TFUNCTION:_,LUA_TNIL:p,LUA_TNUMBER:d,LUA_TSTRING:h,LUA_TTABLE:L,lua_call:g,lua_createtable:A,lua_dump:T,lua_gettable:b,lua_gettop:x,lua_isinteger:O,lua_isstring:k,lua_pop:v,lua_pushcclosure:E,lua_pushinteger:m,lua_pushlightuserdata:R,lua_pushliteral:U,lua_pushlstring:N,lua_pushnil:w,lua_pushnumber:S,lua_pushstring:y,lua_pushvalue:I,lua_remove:M,lua_setfield:P,lua_setmetatable:C,lua_settop:D,lua_toboolean:V,lua_tointeger:B,lua_tonumber:G,lua_tostring:K,lua_touserdata:j,lua_type:F,lua_upvalueindex:H}=n(2),{luaL_Buffer:X,luaL_addchar:z,luaL_addlstring:Y,luaL_addsize:J,luaL_addstring:q,luaL_addvalue:Z,luaL_argcheck:W,luaL_argerror:Q,luaL_buffinit:$,luaL_buffinitsize:ee,luaL_checkinteger:te,luaL_checknumber:ne,luaL_checkstack:re,luaL_checkstring:ae,luaL_checktype:ue,luaL_error:le,luaL_newlib:se,luaL_optinteger:oe,luaL_optstring:ie,luaL_prepbuffsize:ce,luaL_pushresult:fe,luaL_pushresultsize:_e,luaL_tolstring:pe,luaL_typename:de}=n(7),he=n(17),{luastring_eq:Le,luastring_indexOf:ge,to_jsstring:Ae,to_luastring:Te}=n(5),be="%".charCodeAt(0),xe=function(e){let t=ge(e,0);return t>-1?t:e.length},Oe=function(e,t){return e>=0?e:0-e>t?0:t+e+1},ke=function(e,t,n,r){return Y(r,t,n),0},ve=o.length+1,Ee=function(e,t,n){let a=function(e){if(Object.is(e,1/0))return Te("inf");if(Object.is(e,-1/0))return Te("-inf");if(Number.isNaN(e))return Te("nan");if(0===e){let t=r(s+"x0p+0",e);return Object.is(e,-0)&&(t="-"+t),Te(t)}{let t="",n=i(e),a=n[0],u=n[1];return a<0&&(t+="-",a=-a),t+="0x",t+=(2*a).toString(16),t+=r("p%+d",u-=1),Te(t)}}(n);if(65===t[ve])for(let r=0;r<a.length;r++){let e=a[r];e>=97&&(a[r]=223&e)}else 97!==t[ve]&&le(e,Te("modifiers for format '%%a'/'%%A' not implemented"));return a},me=Te("-+ #0"),Re=e=>97<=e&&e<=122||65<=e&&e<=90,Ue=e=>48<=e&&e<=57,Ne=e=>0<=e&&e<=31||127===e,we=e=>33<=e&&e<=126,Se=e=>97<=e&&e<=122,ye=e=>65<=e&&e<=90,Ie=e=>97<=e&&e<=122||65<=e&&e<=90||48<=e&&e<=57,Me=e=>we(e)&&!Ie(e),Pe=e=>32===e||e>=9&&e<=13,Ce=e=>48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102,De=function(e,t,n){switch(F(e,n)){case h:{let r=K(e,n);!function(e,t,n){z(e,34);let r=0;for(;n--;){if(34===t[r]||92===t[r]||10===t[r])z(e,92),z(e,t[r]);else if(Ne(t[r])){let n=""+t[r];Ue(t[r+1])&&(n="0".repeat(3-n.length)+n),q(e,Te("\\"+n))}else z(e,t[r]);r++}z(e,34)}(t,r,r.length);break}case d:{let s;if(O(e,n)){let t=B(e,n);s=Te(r(t===l?"0x%"+u+"x":a,t))}else{let t=G(e,n);!function(e){if(ge(e,46)<0){let t=c(),n=ge(e,t);n&&(e[n]=46)}}(s=Ee(e,Te(`%${u}a`),t))}q(t,s);break}case p:case f:pe(e,n),Z(t);break;default:Q(e,n,Te("value has no literal form"))}},Ve=function(e,t,n,r){let a=n;for(;0!==t[a]&&ge(me,t[a])>=0;)a++;a-n>=me.length&&le(e,Te("invalid format (repeated flags)")),Ue(t[a])&&a++,Ue(t[a])&&a++,46===t[a]&&(Ue(t[++a])&&a++,Ue(t[a])&&a++),Ue(t[a])&&le(e,Te("invalid format (width or precision too long)")),r[0]=37;for(let u=0;u<a-n+1;u++)r[u+1]=t[n+u];return a},Be=function(e,t){let n=e.length,r=t.length,a=e[n-1];for(let u=0;u<r;u++)e[u+n-1]=t[u];e[n+r-1]=a};class Ge{constructor(e){this.L=e,this.islittle=!0,this.maxalign=1}}const Ke=Ue,je=function(e,t){if(e.off>=e.s.length||!Ke(e.s[e.off]))return t;{let t=0;do{t=10*t+(e.s[e.off++]-48)}while(e.off<e.s.length&&Ke(e.s[e.off])&&t<=214748363.8);return t}},Fe=function(e,t,n){let r=je(t,n);return(r>16||r<=0)&&le(e.L,Te("integral size (%d) out of limits [1,%d]"),r,16),r},He=function(e,t){let n={opt:t.s[t.off++],size:0};switch(n.opt){case 98:return n.size=1,n.opt=0,n;case 66:return n.size=1,n.opt=1,n;case 104:return n.size=2,n.opt=0,n;case 72:return n.size=2,n.opt=1,n;case 108:return n.size=4,n.opt=0,n;case 76:return n.size=4,n.opt=1,n;case 106:return n.size=4,n.opt=0,n;case 74:case 84:return n.size=4,n.opt=1,n;case 102:return n.size=4,n.opt=2,n;case 100:case 110:return n.size=8,n.opt=2,n;case 105:return n.size=Fe(e,t,4),n.opt=0,n;case 73:return n.size=Fe(e,t,4),n.opt=1,n;case 115:return n.size=Fe(e,t,4),n.opt=4,n;case 99:return n.size=je(t,-1),-1===n.size&&le(e.L,Te("missing size for format option 'c'")),n.opt=3,n;case 122:return n.opt=5,n;case 120:return n.size=1,n.opt=6,n;case 88:return n.opt=7,n;case 32:break;case 60:e.islittle=!0;break;case 62:e.islittle=!1;break;case 61:e.islittle=!0;break;case 33:e.maxalign=Fe(e,t,8);break;default:le(e.L,Te("invalid format option '%c'"),n.opt)}return n.opt=8,n},Xe=function(e,t,n){let r={opt:NaN,size:NaN,ntoalign:NaN},a=He(e,n);r.size=a.size,r.opt=a.opt;let u=r.size;if(7===r.opt)if(n.off>=n.s.length||0===n.s[n.off])Q(e.L,1,Te("invalid next option for option 'X'"));else{let t=He(e,n);u=t.size,3!==(t=t.opt)&&0!==u||Q(e.L,1,Te("invalid next option for option 'X'"))}return u<=1||3===r.opt?r.ntoalign=0:(u>e.maxalign&&(u=e.maxalign),0!=(u&u-1)&&Q(e.L,1,Te("format asks for alignment not power of 2")),r.ntoalign=u-(t&u-1)&u-1),r},ze=function(e,t,n,r,a){let u=ce(e,r);u[n?0:r-1]=255&t;for(let l=1;l<r;l++)t>>=8,u[n?l:r-1-l]=255&t;if(a&&r>4)for(let l=4;l<r;l++)u[n?l:r-1-l]=255;J(e,r)},Ye=function(e,t,n,r,a){let u=0,l=r<=4?r:4;for(let s=l-1;s>=0;s--)u<<=8,u|=t[n?s:r-1-s];if(r<4){if(a){let e=1<<8*r-1;u=(u^e)-e}}else if(r>4){let s=!a||u>=0?0:255;for(let a=l;a<r;a++)t[n?a:r-1-a]!==s&&le(e,Te("%d-byte integer does not fit into Lua Integer"),r)}return u},Je=function(e,t,n,r){he.lua_assert(t.length>=r);let a=new DataView(new ArrayBuffer(r));for(let u=0;u<r;u++)a.setUint8(u,t[u],n);return 4==r?a.getFloat32(0,n):a.getFloat64(0,n)},qe=Te("^$*+?.([%-");class Ze{constructor(e){this.src=null,this.src_init=null,this.src_end=null,this.p=null,this.p_end=null,this.L=e,this.matchdepth=NaN,this.level=NaN,this.capture=[]}}const We=function(e,t){switch(e.p[t++]){case be:return t===e.p_end&&le(e.L,Te("malformed pattern (ends with '%%')")),t+1;case 91:94===e.p[t]&&t++;do{t===e.p_end&&le(e.L,Te("malformed pattern (missing ']')")),e.p[t++]===be&&t<e.p_end&&t++}while(93!==e.p[t]);return t+1;default:return t}},Qe=function(e,t){switch(t){case 97:return Re(e);case 65:return!Re(e);case 99:return Ne(e);case 67:return!Ne(e);case 100:return Ue(e);case 68:return!Ue(e);case 103:return we(e);case 71:return!we(e);case 108:return Se(e);case 76:return!Se(e);case 112:return Me(e);case 80:return!Me(e);case 115:return Pe(e);case 83:return!Pe(e);case 117:return ye(e);case 85:return!ye(e);case 119:return Ie(e);case 87:return!Ie(e);case 120:return Ce(e);case 88:return!Ce(e);case 122:return 0===e;case 90:return 0!==e;default:return t===e}},$e=function(e,t,n,r){let a=!0;for(94===e.p[n+1]&&(a=!1,n++);++n<r;)if(e.p[n]===be){if(n++,Qe(t,e.p[n]))return a}else if(45===e.p[n+1]&&n+2<r){if(n+=2,e.p[n-2]<=t&&t<=e.p[n])return a}else if(e.p[n]===t)return a;return!a},et=function(e,t,n,r){if(t>=e.src_end)return!1;{let a=e.src[t];switch(e.p[n]){case 46:return!0;case be:return Qe(a,e.p[n+1]);case 91:return $e(e,a,n,r-1);default:return e.p[n]===a}}},tt=function(e,t,n){if(n>=e.p_end-1&&le(e.L,Te("malformed pattern (missing arguments to '%%b'")),e.src[t]!==e.p[n])return null;{let r=e.p[n],a=e.p[n+1],u=1;for(;++t<e.src_end;)if(e.src[t]===a){if(0==--u)return t+1}else e.src[t]===r&&u++}return null},nt=function(e,t,n,r){let a=0;for(;et(e,t+a,n,r);)a++;for(;a>=0;){let n=st(e,t+a,r+1);if(n)return n;a--}return null},rt=function(e,t,n,r){for(;;){let a=st(e,t,r+1);if(null!==a)return a;if(!et(e,t,n,r))return null;t++}},at=function(e,t,n,r){let a,u=e.level;return u>=32&&le(e.L,Te("too many captures")),e.capture[u]=e.capture[u]?e.capture[u]:{},e.capture[u].init=t,e.capture[u].len=r,e.level=u+1,null===(a=st(e,t,n))&&e.level--,a},ut=function(e,t,n){let r,a=function(e){let t=e.level;for(t--;t>=0;t--)if(-1===e.capture[t].len)return t;return le(e.L,Te("invalid pattern capture"))}(e);return e.capture[a].len=t-e.capture[a].init,null===(r=st(e,t,n))&&(e.capture[a].len=-1),r},lt=function(e,t,n){n=function(e,t){return(t-=49)<0||t>=e.level||-1===e.capture[t].len?le(e.L,Te("invalid capture index %%%d"),t+1):t}(e,n);let r=e.capture[n].len;return e.src_end-t>=r&&function(e,t,n,r,a){return Le(e.subarray(t,t+a),n.subarray(r,r+a))}(e.src,e.capture[n].init,e.src,t,r)?t+r:null},st=function(e,t,n){let r=!1,a=!0;for(0==e.matchdepth--&&le(e.L,Te("pattern too complex"));a||r;)if(a=!1,n!==e.p_end)switch(r?void 0:e.p[n]){case 40:t=41===e.p[n+1]?at(e,t,n+2,-2):at(e,t,n+1,-1);break;case 41:t=ut(e,t,n+1);break;case 36:if(n+1!==e.p_end){r=!0;break}t=e.src.length-t==0?t:null;break;case be:switch(e.p[n+1]){case 98:null!==(t=tt(e,t,n+2))&&(n+=4,a=!0);break;case 102:{n+=2,91!==e.p[n]&&le(e.L,Te("missing '[' after '%%f' in pattern"));let r=We(e,n),u=t===e.src_init?0:e.src[t-1];if(!$e(e,u,n,r-1)&&$e(e,t===e.src_end?0:e.src[t],n,r-1)){n=r,a=!0;break}t=null;break}case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:null!==(t=lt(e,t,e.p[n+1]))&&(n+=2,a=!0);break;default:r=!0}break;default:{r=!1;let u=We(e,n);if(et(e,t,n,u))switch(e.p[u]){case 63:{let r;null!==(r=st(e,t+1,u+1))?t=r:(n=u+1,a=!0);break}case 43:t++;case 42:t=nt(e,t,n,u);break;case 45:t=rt(e,t,n,u);break;default:t++,n=u,a=!0}else{if(42===e.p[u]||63===e.p[u]||45===e.p[u]){n=u+1,a=!0;break}t=null}break}}return e.matchdepth++,t},ot=function(e,t,n,r){if(t>=e.level)0===t?N(e.L,e.src.subarray(n,r),r-n):le(e.L,Te("invalid capture index %%%d"),t+1);else{let n=e.capture[t].len;-1===n&&le(e.L,Te("unfinished capture")),-2===n?m(e.L,e.capture[t].init-e.src_init+1):N(e.L,e.src.subarray(e.capture[t].init),n)}},it=function(e,t,n){let r=0===e.level&&e.src.subarray(t)?1:e.level;re(e.L,r,"too many captures");for(let a=0;a<r;a++)ot(e,a,t,n);return r},ct=function(e,t,n,r,a,u){e.L=t,e.matchdepth=200,e.src=n,e.src_init=0,e.src_end=r,e.p=a,e.p_end=u},ft=function(e){e.level=0,he.lua_assert(200===e.matchdepth)},_t=function(e,t){let n=ae(e,1),r=ae(e,2),a=n.length,u=r.length,l=Oe(oe(e,3,1),a);if(l<1)l=1;else if(l>a+1)return w(e),1;if(t&&(V(e,4)||function(e,t){for(let n=0;n<t;n++)if(-1!==ge(qe,e[n]))return!1;return!0}(r,u))){let t=function(e,t,n){var r=0,a=t.length;if(0===a)return r;for(;-1!==(r=e.indexOf(t[0],r));r++)if(Le(e.subarray(r,r+a),t))return r;return-1}(n.subarray(l-1),r);if(t>-1)return m(e,l+t),m(e,l+t+u-1),2}else{let s=new Ze(e),o=l-1,i=94===r[0];i&&(r=r.subarray(1),u--),ct(s,e,n,a,r,u);do{let n;if(ft(s),null!==(n=st(s,o,0)))return t?(m(e,o+1),m(e,n),it(s,null,0)+2):it(s,o,n)}while(o++<s.src_end&&!i)}return w(e),1},pt=function(e){let t=j(e,H(3));t.ms.L=e;for(let n=t.src;n<=t.ms.src_end;n++){let e;if(ft(t.ms),null!==(e=st(t.ms,n,t.p))&&e!==t.lastmatch)return t.src=t.lastmatch=e,it(t.ms,n,e)}return 0},dt=function(e,t,n,r,a){let u=e.L;switch(a){case _:{I(u,3);let t=it(e,n,r);g(u,t,1);break}case L:ot(e,0,n,r),b(u,3);break;default:return void function(e,t,n,r){let a=e.L,u=K(a,3),l=u.length;for(let s=0;s<l;s++)u[s]!==be?z(t,u[s]):Ue(u[++s])?48===u[s]?Y(t,e.src.subarray(n,r),r-n):(ot(e,u[s]-49,n,r),pe(a,-1),M(a,-2),Z(t)):(u[s]!==be&&le(a,Te("invalid use of '%c' in replacement string"),be),z(t,u[s]))}(e,t,n,r)}V(u,-1)?k(u,-1)||le(u,Te("invalid replacement value (a %s)"),de(u,-1)):(v(u,1),N(u,e.src.subarray(n,r),r-n)),Z(t)},ht={byte:function(e){let t=ae(e,1),n=t.length,r=Oe(oe(e,2,1),n),a=Oe(oe(e,3,r),n);if(r<1&&(r=1),a>n&&(a=n),r>a)return 0;if(a-r>=Number.MAX_SAFE_INTEGER)return le(e,"string slice too long");let u=a-r+1;re(e,u,"string slice too long");for(let l=0;l<u;l++)m(e,t[r+l-1]);return u},char:function(e){let t=x(e),n=new X,r=ee(e,n,t);for(let a=1;a<=t;a++){let t=te(e,a);W(e,t>=0&&t<=255,"value out of range"),r[a-1]=t}return _e(n,t),1},dump:function(e){let t=new X,n=V(e,2);return ue(e,1,_),D(e,1),$(e,t),0!==T(e,ke,t,n)?le(e,Te("unable to dump given function")):(fe(t),1)},find:function(e){return _t(e,1)},format:function(e){let t=x(e),n=1,a=ae(e,n),l=0,s=new X;for($(e,s);l<a.length;)if(a[l]!==be)z(s,a[l++]);else if(a[++l]===be)z(s,a[l++]);else{let o=[];switch(++n>t&&Q(e,n,Te("no value")),l=Ve(e,a,l,o),String.fromCharCode(a[l++])){case"c":z(s,te(e,n));break;case"d":case"i":case"o":case"u":case"x":case"X":{let t=te(e,n);Be(o,Te(u,!0)),q(s,Te(r(String.fromCharCode(...o),t)));break}case"a":case"A":Be(o,Te(u,!0)),q(s,Ee(e,o,ne(e,n)));break;case"e":case"E":case"f":case"g":case"G":{let t=ne(e,n);Be(o,Te(u,!0)),q(s,Te(r(String.fromCharCode(...o),t)));break}case"q":De(e,s,n);break;case"s":{let t=pe(e,n);o.length<=2||0===o[2]?Z(s):(W(e,t.length===xe(t),n,"string contains zeros"),ge(o,46)<0&&t.length>=100?Z(s):(q(s,Te(r(String.fromCharCode(...o),Ae(t)))),v(e,1)));break}default:return le(e,Te("invalid option '%%%c' to 'format'"),a[l-1])}}return fe(s),1},gmatch:function(e){let t=ae(e,1),n=ae(e,2),r=t.length,a=n.length;D(e,2);let u=new class{constructor(){this.src=NaN,this.p=NaN,this.lastmatch=NaN,this.ms=new Ze}};return R(e,u),ct(u.ms,e,t,r,n,a),u.src=0,u.p=0,u.lastmatch=null,E(e,pt,3),1},gsub:function(e){let t=ae(e,1),n=t.length,r=ae(e,2),a=r.length,u=null,l=F(e,3),s=oe(e,4,n+1),o=94===r[0],i=0,c=new Ze(e),f=new X;for(W(e,l===d||l===h||l===_||l===L,3,"string/function/table expected"),$(e,f),o&&(r=r.subarray(1),a--),ct(c,e,t,n,r,a),t=0,r=0;i<s;){let e;if(ft(c),null!==(e=st(c,t,r))&&e!==u)i++,dt(c,f,t,e,l),t=u=e;else{if(!(t<c.src_end))break;z(f,c.src[t++])}if(o)break}return Y(f,c.src.subarray(t,c.src_end),c.src_end-t),fe(f),m(e,i),2},len:function(e){return m(e,ae(e,1).length),1},lower:function(e){let t=ae(e,1),n=t.length,r=new Uint8Array(n);for(let a=0;a<n;a++){let e=t[a];ye(e)&&(e|=32),r[a]=e}return y(e,r),1},match:function(e){return _t(e,0)},pack:function(e){let t=new X,n=new Ge(e),r={s:ae(e,1),off:0},a=1,u=0;for(w(e),$(e,t);r.off<r.s.length;){let l=Xe(n,u,r),s=l.opt,o=l.size,i=l.ntoalign;for(u+=i+o;i-- >0;)z(t,0);switch(a++,s){case 0:{let r=te(e,a);if(o<4){let t=1<<8*o-1;W(e,-t<=r&&r<t,a,"integer overflow")}ze(t,r,n.islittle,o,r<0);break}case 1:{let r=te(e,a);o<4&&W(e,r>>>0<1<<8*o,a,"unsigned overflow"),ze(t,r>>>0,n.islittle,o,!1);break}case 2:{let r=ce(t,o),u=ne(e,a),l=new DataView(r.buffer,r.byteOffset,r.byteLength);4===o?l.setFloat32(0,u,n.islittle):l.setFloat64(0,u,n.islittle),J(t,o);break}case 3:{let n=ae(e,a),r=n.length;for(W(e,r<=o,a,"string longer than given size"),Y(t,n,r);r++<o;)z(t,0);break}case 4:{let r=ae(e,a),l=r.length;W(e,o>=4||l<1<<8*o,a,"string length does not fit in given size"),ze(t,l,n.islittle,o,0),Y(t,r,l),u+=l;break}case 5:{let n=ae(e,a),r=n.length;W(e,ge(n,0)<0,a,"strings contains zeros"),Y(t,n,r),z(t,0),u+=r+1;break}case 6:z(t,0);case 7:case 8:a--}}return fe(t),1},packsize:function(e){let t=new Ge(e),n={s:ae(e,1),off:0},r=0;for(;n.off<n.s.length;){let a=Xe(t,r,n),u=a.opt,l=a.size,s=a.ntoalign;switch(W(e,r<=2147483647-(l+=s),1,"format result too large"),r+=l,u){case 4:case 5:Q(e,1,"variable-length format")}}return m(e,r),1},rep:function(e){let t=ae(e,1),n=t.length,r=te(e,2),a=ie(e,3,""),u=a.length;if(r<=0)U(e,"");else{if(n+u<n||n+u>2147483647/r)return le(e,Te("resulting string too large"));{let l=r*n+(r-1)*u,s=new X,o=ee(e,s,l),i=0;for(;r-- >1;)o.set(t,i),i+=n,u>0&&(o.set(a,i),i+=u);o.set(t,i),_e(s,l)}}return 1},reverse:function(e){let t=ae(e,1),n=t.length,r=new Uint8Array(n);for(let a=0;a<n;a++)r[a]=t[n-1-a];return y(e,r),1},sub:function(e){let t=ae(e,1),n=t.length,r=Oe(te(e,2),n),a=Oe(oe(e,3,-1),n);return r<1&&(r=1),a>n&&(a=n),r<=a?y(e,t.subarray(r-1,r-1+(a-r+1))):U(e,""),1},unpack:function(e){let t=new Ge(e),n={s:ae(e,1),off:0},r=ae(e,2),a=r.length,u=Oe(oe(e,3,1),a)-1,l=0;for(W(e,u<=a&&u>=0,3,"initial position out of string");n.off<n.s.length;){let s=Xe(t,u,n),o=s.opt,i=s.size,c=s.ntoalign;switch(u+c+i>a&&Q(e,2,Te("data string too short")),u+=c,re(e,2,"too many results"),l++,o){case 0:case 1:{let n=Ye(e,r.subarray(u),t.islittle,i,0===o);m(e,n);break}case 2:{let n=Je(0,r.subarray(u),t.islittle,i);S(e,n);break}case 3:y(e,r.subarray(u,u+i));break;case 4:{let n=Ye(e,r.subarray(u),t.islittle,i,0);W(e,u+n+i<=a,2,"data string too short"),y(e,r.subarray(u+i,u+i+n)),u+=n;break}case 5:{let t=ge(r,0,u);-1===t&&(t=r.length-u),y(e,r.subarray(u,t)),u=t+1;break}case 7:case 6:case 8:l--}u+=i}return m(e,u+1),l+1},upper:function(e){let t=ae(e,1),n=t.length,r=new Uint8Array(n);for(let a=0;a<n;a++){let e=t[a];Se(e)&&(e&=223),r[a]=e}return y(e,r),1}};e.exports.luaopen_string=function(e){return se(e,ht),function(e){A(e,0,1),U(e,""),I(e,-2),C(e,-2),v(e,1),I(e,-2),P(e,-2,Te("__index",!0)),v(e,1)}(e),1}},function(e,t,n){"use strict";const{lua_gettop:r,lua_pushcfunction:a,lua_pushfstring:u,lua_pushinteger:l,lua_pushnil:s,lua_pushstring:o,lua_pushvalue:i,lua_setfield:c,lua_tointeger:f}=n(2),{luaL_Buffer:_,luaL_addvalue:p,luaL_argcheck:d,luaL_buffinit:h,luaL_checkinteger:L,luaL_checkstack:g,luaL_checkstring:A,luaL_error:T,luaL_newlib:b,luaL_optinteger:x,luaL_pushresult:O}=n(7),{luastring_of:k,to_luastring:v}=n(5),E=function(e){return 128==(192&e)},m=function(e,t){return e>=0?e:0-e>t?0:t+e+1},R=[255,127,2047,65535],U=function(e,t){let n=e[t],r=0;if(n<128)r=n;else{let a=0;for(;64&n;){let u=e[t+ ++a];if(128!=(192&u))return null;r=r<<6|63&u,n<<=1}if(r|=(127&n)<<5*a,a>3||r>1114111||r<=R[a])return null;t+=a}return{code:r,pos:t+1}},N=v("%U"),w=function(e,t){let n=L(e,t);d(e,0<=n&&n<=1114111,t,"value out of range"),u(e,N,n)},S=function(e){let t=A(e,1),n=t.length,r=f(e,2)-1;if(r<0)r=0;else if(r<n)for(r++;E(t[r]);)r++;if(r>=n)return 0;{let n=U(t,r);return null===n||E(t[n.pos])?T(e,v("invalid UTF-8 code")):(l(e,r+1),l(e,n.code),2)}},y={char:function(e){let t=r(e);if(1===t)w(e,1);else{let n=new _;h(e,n);for(let r=1;r<=t;r++)w(e,r),p(n);O(n)}return 1},codepoint:function(e){let t=A(e,1),n=m(x(e,2,1),t.length),r=m(x(e,3,n),t.length);if(d(e,n>=1,2,"out of range"),d(e,r<=t.length,3,"out of range"),n>r)return 0;if(r-n>=Number.MAX_SAFE_INTEGER)return T(e,"string slice too long");let a=r-n+1;for(g(e,a,"string slice too long"),a=0,n-=1;n<r;){let r=U(t,n);if(null===r)return T(e,"invalid UTF-8 code");l(e,r.code),n=r.pos,a++}return a},codes:function(e){return A(e,1),a(e,S),i(e,1),l(e,0),3},len:function(e){let t=0,n=A(e,1),r=n.length,a=m(x(e,2,1),r),u=m(x(e,3,-1),r);for(d(e,1<=a&&--a<=r,2,"initial position out of string"),d(e,--u<r,3,"final position out of string");a<=u;){let r=U(n,a);if(null===r)return s(e),l(e,a+1),2;a=r.pos,t++}return l(e,t),1},offset:function(e){let t=A(e,1),n=L(e,2),r=n>=0?1:t.length+1;if(r=m(x(e,3,r),t.length),d(e,1<=r&&--r<=t.length,3,"position out of range"),0===n)for(;r>0&&E(t[r]);)r--;else if(E(t[r])&&T(e,"initial position is a continuation byte"),n<0)for(;n<0&&r>0;){do{r--}while(r>0&&E(t[r]));n++}else for(n--;n>0&&r<t.length;){do{r++}while(E(t[r]));n--}return 0===n?l(e,r+1):s(e),1}},I=k(91,0,45,127,194,45,244,93,91,128,45,191,93,42);e.exports.luaopen_utf8=function(e){return b(e,y),o(e,I),c(e,-2,v("charpattern",!0)),1}},function(e,t,n){"use strict";const{LUA_OPLT:r,LUA_TNUMBER:a,lua_compare:u,lua_gettop:l,lua_isinteger:s,lua_isnoneornil:o,lua_pushboolean:i,lua_pushinteger:c,lua_pushliteral:f,lua_pushnil:_,lua_pushnumber:p,lua_pushvalue:d,lua_setfield:h,lua_settop:L,lua_tointeger:g,lua_tointegerx:A,lua_type:T}=n(2),{luaL_argcheck:b,luaL_argerror:x,luaL_checkany:O,luaL_checkinteger:k,luaL_checknumber:v,luaL_error:E,luaL_newlib:m,luaL_optnumber:R}=n(7),{LUA_MAXINTEGER:U,LUA_MININTEGER:N,lua_numbertointeger:w}=n(3),{to_luastring:S}=n(5);let y;const I=function(){return y=1103515245*y+12345&2147483647},M=function(e,t){let n=w(t);!1!==n?c(e,n):p(e,t)},P={abs:function(e){if(s(e,1)){let t=g(e,1);t<0&&(t=0|-t),c(e,t)}else p(e,Math.abs(v(e,1)));return 1},acos:function(e){return p(e,Math.acos(v(e,1))),1},asin:function(e){return p(e,Math.asin(v(e,1))),1},atan:function(e){let t=v(e,1),n=R(e,2,1);return p(e,Math.atan2(t,n)),1},ceil:function(e){return s(e,1)?L(e,1):M(e,Math.ceil(v(e,1))),1},cos:function(e){return p(e,Math.cos(v(e,1))),1},deg:function(e){return p(e,v(e,1)*(180/Math.PI)),1},exp:function(e){return p(e,Math.exp(v(e,1))),1},floor:function(e){return s(e,1)?L(e,1):M(e,Math.floor(v(e,1))),1},fmod:function(e){if(s(e,1)&&s(e,2)){let t=g(e,2);0===t?x(e,2,"zero"):c(e,g(e,1)%t|0)}else{let t=v(e,1),n=v(e,2);p(e,t%n)}return 1},log:function(e){let t,n=v(e,1);if(o(e,2))t=Math.log(n);else{let r=v(e,2);t=2===r?Math.log2(n):10===r?Math.log10(n):Math.log(n)/Math.log(r)}return p(e,t),1},max:function(e){let t=l(e),n=1;b(e,t>=1,1,"value expected");for(let a=2;a<=t;a++)u(e,n,a,r)&&(n=a);return d(e,n),1},min:function(e){let t=l(e),n=1;b(e,t>=1,1,"value expected");for(let a=2;a<=t;a++)u(e,a,n,r)&&(n=a);return d(e,n),1},modf:function(e){if(s(e,1))L(e,1),p(e,0);else{let t=v(e,1),n=t<0?Math.ceil(t):Math.floor(t);M(e,n),p(e,t===n?0:t-n)}return 2},rad:function(e){return p(e,v(e,1)*(Math.PI/180)),1},random:function(e){let t,n,r=void 0===y?Math.random():I()/2147483648;switch(l(e)){case 0:return p(e,r),1;case 1:t=1,n=k(e,1);break;case 2:t=k(e,1),n=k(e,2);break;default:return E(e,"wrong number of arguments")}return b(e,t<=n,1,"interval is empty"),b(e,t>=0||n<=U+t,1,"interval too large"),r*=n-t+1,c(e,Math.floor(r)+t),1},randomseed:function(e){return function(e){0==(y=0|e)&&(y=1)}(v(e,1)),I(),0},sin:function(e){return p(e,Math.sin(v(e,1))),1},sqrt:function(e){return p(e,Math.sqrt(v(e,1))),1},tan:function(e){return p(e,Math.tan(v(e,1))),1},tointeger:function(e){let t=A(e,1);return!1!==t?c(e,t):(O(e,1),_(e)),1},type:function(e){return T(e,1)===a?s(e,1)?f(e,"integer"):f(e,"float"):(O(e,1),_(e)),1},ult:function(e){let t=k(e,1),n=k(e,2);return i(e,t>=0?n<0||t<n:n<0&&t<n),1}};e.exports.luaopen_math=function(e){return m(e,P),p(e,Math.PI),h(e,-2,S("pi",!0)),p(e,1/0),h(e,-2,S("huge",!0)),c(e,U),h(e,-2,S("maxinteger",!0)),c(e,N),h(e,-2,S("mininteger",!0)),1}},function(e,t,n){"use strict";const{LUA_MASKCALL:r,LUA_MASKCOUNT:a,LUA_MASKLINE:u,LUA_MASKRET:l,LUA_REGISTRYINDEX:s,LUA_TFUNCTION:o,LUA_TNIL:i,LUA_TTABLE:c,LUA_TUSERDATA:f,lua_Debug:_,lua_call:p,lua_checkstack:d,lua_gethook:h,lua_gethookcount:L,lua_gethookmask:g,lua_getinfo:A,lua_getlocal:T,lua_getmetatable:b,lua_getstack:x,lua_getupvalue:O,lua_getuservalue:k,lua_insert:v,lua_iscfunction:E,lua_isfunction:m,lua_isnoneornil:R,lua_isthread:U,lua_newtable:N,lua_pcall:w,lua_pop:S,lua_pushboolean:y,lua_pushfstring:I,lua_pushinteger:M,lua_pushlightuserdata:P,lua_pushliteral:C,lua_pushnil:D,lua_pushstring:V,lua_pushvalue:B,lua_rawgetp:G,lua_rawsetp:K,lua_rotate:j,lua_setfield:F,lua_sethook:H,lua_setlocal:X,lua_setmetatable:z,lua_settop:Y,lua_setupvalue:J,lua_setuservalue:q,lua_tojsstring:Z,lua_toproxy:W,lua_tostring:Q,lua_tothread:$,lua_touserdata:ee,lua_type:te,lua_upvalueid:ne,lua_upvaluejoin:re,lua_xmove:ae}=n(2),{luaL_argcheck:ue,luaL_argerror:le,luaL_checkany:se,luaL_checkinteger:oe,luaL_checkstring:ie,luaL_checktype:ce,luaL_error:fe,luaL_loadbuffer:_e,luaL_newlib:pe,luaL_optinteger:de,luaL_optstring:he,luaL_traceback:Le,lua_writestringerror:ge}=n(7),Ae=n(17),{luastring_indexOf:Te,to_luastring:be}=n(5),xe=function(e,t,n){e===t||d(t,n)||fe(e,be("stack overflow",!0))},Oe=function(e){return U(e,1)?{arg:1,thread:$(e,1)}:{arg:0,thread:e}},ke=function(e,t,n){V(e,n),F(e,-2,t)},ve=function(e,t,n){M(e,n),F(e,-2,t)},Ee=function(e,t,n){y(e,n),F(e,-2,t)},me=function(e,t,n){e==t?j(e,-2,1):ae(t,e,1),F(e,-2,n)},Re=function(e,t){let n=oe(e,2);ce(e,1,o);let r=t?O(e,1,n):J(e,1,n);return null===r?0:(V(e,r),v(e,-(t+1)),t+1)},Ue=function(e,t,n){let r=oe(e,n);return ce(e,t,o),ue(e,null!==O(e,t,r),n,"invalid upvalue index"),r},Ne=be("__hooks__",!0),we=["call","return","line","count","tail call"].map((e=>be(e))),Se=function(e,t){G(e,s,Ne);let n=ee(e,-1).get(e);n&&(n(e),V(e,we[t.event]),t.currentline>=0?M(e,t.currentline):D(e),Ae.lua_assert(A(e,be("lS"),t)),p(e,2,0))},ye={gethook:function(e){let t=Oe(e).thread,n=new Uint8Array(5),a=g(t),o=h(t);return null===o?D(e):o!==Se?C(e,"external hook"):(G(e,s,Ne),ee(e,-1).get(t)(e)),V(e,function(e,t){let n=0;return e&r&&(t[n++]=99),e&l&&(t[n++]=114),e&u&&(t[n++]=108),t.subarray(0,n)}(a,n)),M(e,L(t)),3},getinfo:function(e){let t=new _,n=Oe(e),r=n.arg,a=n.thread,u=he(e,r+2,"flnStu");if(xe(e,a,3),m(e,r+1))u=I(e,be(">%s"),u),B(e,r+1),ae(e,a,1);else if(!x(a,oe(e,r+1),t))return D(e),1;return A(a,u,t)||le(e,r+2,"invalid option"),N(e),Te(u,83)>-1&&(ke(e,be("source",!0),t.source),ke(e,be("short_src",!0),t.short_src),ve(e,be("linedefined",!0),t.linedefined),ve(e,be("lastlinedefined",!0),t.lastlinedefined),ke(e,be("what",!0),t.what)),Te(u,108)>-1&&ve(e,be("currentline",!0),t.currentline),Te(u,117)>-1&&(ve(e,be("nups",!0),t.nups),ve(e,be("nparams",!0),t.nparams),Ee(e,be("isvararg",!0),t.isvararg)),Te(u,110)>-1&&(ke(e,be("name",!0),t.name),ke(e,be("namewhat",!0),t.namewhat)),Te(u,116)>-1&&Ee(e,be("istailcall",!0),t.istailcall),Te(u,76)>-1&&me(e,a,be("activelines",!0)),Te(u,102)>-1&&me(e,a,be("func",!0)),1},getlocal:function(e){let t=Oe(e),n=t.thread,r=t.arg,a=new _,u=oe(e,r+2);if(m(e,r+1))return B(e,r+1),V(e,T(e,null,u)),1;{let t=oe(e,r+1);if(!x(n,t,a))return le(e,r+1,"level out of range");xe(e,n,1);let l=T(n,a,u);return l?(ae(n,e,1),V(e,l),j(e,-2,1),2):(D(e),1)}},getmetatable:function(e){return se(e,1),b(e,1)||D(e),1},getregistry:function(e){return B(e,s),1},getupvalue:function(e){return Re(e,1)},getuservalue:function(e){return te(e,1)!==f?D(e):k(e,1),1},sethook:function(e){let t,n,c,f,_=Oe(e),p=_.thread,d=_.arg;if(R(e,d+1))Y(e,d+1),c=null,t=0,n=0;else{const s=ie(e,d+2);ce(e,d+1,o),n=de(e,d+3,0),c=Se,t=function(e,t){let n=0;return Te(e,99)>-1&&(n|=r),Te(e,114)>-1&&(n|=l),Te(e,108)>-1&&(n|=u),t>0&&(n|=a),n}(s,n)}G(e,s,Ne)===i?(f=new WeakMap,P(e,f),K(e,s,Ne)):f=ee(e,-1);let h=W(e,d+1);return f.set(p,h),H(p,c,t,n),0},setlocal:function(e){let t=Oe(e),n=t.thread,r=t.arg,a=new _,u=oe(e,r+1),l=oe(e,r+2);if(!x(n,u,a))return le(e,r+1,"level out of range");se(e,r+3),Y(e,r+3),xe(e,n,1),ae(e,n,1);let s=X(n,a,l);return null===s&&S(n,1),V(e,s),1},setmetatable:function(e){const t=te(e,2);return ue(e,t==i||t==c,2,"nil or table expected"),Y(e,2),z(e,1),1},setupvalue:function(e){return se(e,3),Re(e,0)},setuservalue:function(e){return ce(e,1,f),se(e,2),Y(e,2),q(e,1),1},traceback:function(e){let t=Oe(e),n=t.thread,r=t.arg,a=Q(e,r+1);if(null!==a||R(e,r+1)){let t=de(e,r+2,e===n?1:0);Le(e,n,a,t)}else B(e,r+1);return 1},upvalueid:function(e){let t=Ue(e,1,2);return P(e,ne(e,1,t)),1},upvaluejoin:function(e){let t=Ue(e,1,2),n=Ue(e,3,4);return ue(e,!E(e,1),1,"Lua function expected"),ue(e,!E(e,3),3,"Lua function expected"),re(e,1,t,3,n),0}};let Ie;"undefined"!=typeof window&&(Ie=function(){let e=prompt("lua_debug>","");return null!==e?e:""}),Ie&&(ye.debug=function(e){for(;;){let t=Ie();if("cont"===t)return 0;if(0===t.length)continue;let n=be(t);(_e(e,n,n.length,be("=(debug command)",!0))||w(e,0,0,0))&&ge(Z(e,-1),"\n"),Y(e,0)}}),e.exports.luaopen_debug=function(e){return pe(e,ye),1}},function(e,t,n){"use strict";const{LUA_DIRSEP:r,LUA_EXEC_DIR:a,LUA_JSPATH_DEFAULT:u,LUA_PATH_DEFAULT:l,LUA_PATH_MARK:s,LUA_PATH_SEP:o}=n(3),{LUA_OK:i,LUA_REGISTRYINDEX:c,LUA_TNIL:f,LUA_TTABLE:_,lua_callk:p,lua_createtable:d,lua_getfield:h,lua_insert:L,lua_isfunction:g,lua_isnil:A,lua_isstring:T,lua_newtable:b,lua_pop:x,lua_pushboolean:O,lua_pushcclosure:k,lua_pushcfunction:v,lua_pushfstring:E,lua_pushglobaltable:m,lua_pushlightuserdata:R,lua_pushliteral:U,lua_pushlstring:N,lua_pushnil:w,lua_pushstring:S,lua_pushvalue:y,lua_rawgeti:I,lua_rawgetp:M,lua_rawseti:P,lua_rawsetp:C,lua_remove:D,lua_setfield:V,lua_setmetatable:B,lua_settop:G,lua_toboolean:K,lua_tostring:j,lua_touserdata:F,lua_upvalueindex:H}=n(2),{LUA_LOADED_TABLE:X,LUA_PRELOAD_TABLE:z,luaL_Buffer:Y,luaL_addvalue:J,luaL_buffinit:q,luaL_checkstring:Z,luaL_error:W,luaL_getsubtable:Q,luaL_gsub:$,luaL_len:ee,luaL_loadfile:te,luaL_newlib:ne,luaL_optstring:re,luaL_pushresult:ae,luaL_setfuncs:ue}=n(7),le=n(17),{luastring_indexOf:se,to_jsstring:oe,to_luastring:ie,to_uristring:ce}=n(5),fe=n(0),_e="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this"),pe=ie("__JSLIBS__"),de=r,he=r,Le=ie("luaopen_"),ge=ie("_"),Ae=ie("\x01");let Te,be;Te=function(e,t,n){t=ce(t);let r=new XMLHttpRequest;if(r.open("GET",t,!1),r.send(),r.status<200||r.status>=300)return S(e,ie(`${r.status}: ${r.statusText}`)),null;let a,u=r.response;/\/\/[#@] sourceURL=/.test(u)||(u+=" //# sourceURL="+t);try{a=Function("fengari",u)}catch(t){return S(e,ie(`${t.name}: ${t.message}`)),null}let l=a(fe);return"function"==typeof l||"object"==typeof l&&null!==l?l:void 0===l?_e:(S(e,ie(`library returned unexpected type (${typeof l})`)),null)},be=function(e){e=ce(e);let t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t.status>=200&&t.status<=299};const xe=function(e,t,n){let r=ve(e,t);if(null===r){if(null===(r=Te(e,t,(n[0],"*".charCodeAt(0)))))return 1;Ee(e,t,r)}if(n[0]==="*".charCodeAt(0))return O(e,1),0;{let t=function(e,t,n){let r=t[oe(n)];return r&&"function"==typeof r?r:(E(e,ie("undefined symbol: %s"),n),null)}(e,r,n);return null===t?2:(v(e,t),0)}},Oe=_e,ke=function(e,t,n,r){let a=`${n}${le.LUA_VERSUFFIX}`;S(e,ie(a));let u=Oe[a];void 0===u&&(u=Oe[n]),void 0===u||function(e){h(e,c,ie("LUA_NOENV"));let t=K(e,-1);return x(e,1),t}(e)?S(e,r):(u=$(e,ie(u),ie(o+o,!0),ie(o+oe(Ae)+o,!0)),$(e,u,Ae,r),D(e,-2)),V(e,-3,t),x(e,1)},ve=function(e,t){M(e,c,pe),h(e,-1,t);let n=F(e,-1);return x(e,2),n},Ee=function(e,t,n){M(e,c,pe),R(e,n),y(e,-1),V(e,-3,t),P(e,-2,ee(e,-2)+1),x(e,1)},me=function(e,t){for(;t[0]===o.charCodeAt(0);)t=t.subarray(1);if(0===t.length)return null;let n=se(t,o.charCodeAt(0));return n<0&&(n=t.length),N(e,t,n),t.subarray(n)},Re=function(e,t,n,r,a){let u=new Y;for(q(e,u),0!==r[0]&&(t=$(e,t,r,a));null!==(n=me(e,n));){let n=$(e,j(e,-1),ie(s,!0),t);if(D(e,-2),be(n))return n;E(e,ie("\n\tno file '%s'"),n),D(e,-2),J(u)}return ae(u),null},Ue=function(e,t,n,r){h(e,H(1),n);let a=j(e,-1);return null===a&&W(e,ie("'package.%s' must be a string"),n),Re(e,t,a,ie("."),r)},Ne=function(e,t,n){return t?(S(e,n),2):W(e,ie("error loading module '%s' from file '%s':\n\t%s"),j(e,1),n,j(e,-1))},we=function(e){let t=Z(e,1),n=Ue(e,t,ie("path",!0),ie(he,!0));return null===n?1:Ne(e,te(e,n)===i,n)},Se=function(e,t,n){let r;n=$(e,n,ie("."),ge);let a=se(n,"-".charCodeAt(0));if(a>=0){r=N(e,n,a),r=E(e,ie("%s%s"),Le,r);let u=xe(e,t,r);if(2!==u)return u;n=a+1}return r=E(e,ie("%s%s"),Le,n),xe(e,t,r)},ye=function(e){let t=Z(e,1),n=Ue(e,t,ie("jspath",!0),ie(de,!0));return null===n?1:Ne(e,0===Se(e,n,t),n)},Ie=function(e){let t,n=Z(e,1),r=se(n,".".charCodeAt(0));if(r<0)return 0;N(e,n,r);let a=Ue(e,j(e,-1),ie("jspath",!0),ie(de,!0));return null===a?1:0!==(t=Se(e,a,n))?2!=t?Ne(e,0,a):(S(e,ie("\n\tno module '%s' in file '%s'"),n,a),1):(S(e,a),2)},Me=function(e){let t=Z(e,1);return h(e,c,z),h(e,-1,t)===f&&E(e,ie("\n\tno field package.preload['%s']"),t),1},Pe=function(e,t,n){for(;t===i?(I(e,3,n.i)===f&&(x(e,1),ae(n.msg),W(e,ie("module '%s' not found:%s"),n.name,j(e,-1))),S(e,n.name),p(e,1,2,n,Pe)):t=i,!g(e,-2);n.i++)T(e,-2)?(x(e,1),J(n.msg)):x(e,2);return n.k(e,i,n.ctx)},Ce=function(e,t,n){return S(e,n),L(e,-2),p(e,2,1,n,De),De(e,i,n)},De=function(e,t,n){let r=n;return A(e,-1)||V(e,2,r),h(e,2,r)==f&&(O(e,1),y(e,-1),V(e,2,r)),1},Ve={loadlib:function(e){let t=Z(e,1),n=Z(e,2),r=xe(e,t,n);return 0===r?1:(w(e),L(e,-2),U(e,1===r?"open":"init"),3)},searchpath:function(e){return null!==Re(e,Z(e,1),Z(e,2),re(e,3,"."),re(e,4,r))?1:(w(e),L(e,-2),2)}},Be={require:function(e){let t=Z(e,1);return G(e,1),h(e,c,X),h(e,2,t),K(e,-1)?1:(x(e,1),function(e,t,n,r){let a=new Y;return q(e,a),h(e,H(1),ie("searchers",!0))!==_&&W(e,ie("'package.searchers' must be a table")),Pe(e,i,{name:t,i:1,msg:a,ctx:n,k:r})}(e,t,t,Ce))}};e.exports.luaopen_package=function(e){return function(e){b(e),d(e,0,1),B(e,-2),C(e,c,pe)}(e),ne(e,Ve),function(e){let t=[Me,we,ye,Ie,null];d(e);for(let n=0;t[n];n++)y(e,-2),k(e,t[n],1),P(e,-2,n+1);V(e,-2,ie("searchers",!0))}(e),ke(e,ie("path",!0),"LUA_PATH",l),ke(e,ie("jspath",!0),"LUA_JSPATH",u),U(e,r+"\n"+o+"\n"+s+"\n"+a+"\n-\n"),V(e,-2,ie("config",!0)),Q(e,c,X),V(e,-2,ie("loaded",!0)),Q(e,c,z),V(e,-2,ie("preload",!0)),m(e),y(e,-2),ue(e,Be,1),x(e,1),1}},function(e,t,n){const{lua_pushinteger:r,lua_pushliteral:a,lua_setfield:u}=n(2),{luaL_newlib:l}=n(7),{FENGARI_AUTHORS:s,FENGARI_COPYRIGHT:o,FENGARI_RELEASE:i,FENGARI_VERSION:c,FENGARI_VERSION_MAJOR:f,FENGARI_VERSION_MINOR:_,FENGARI_VERSION_NUM:p,FENGARI_VERSION_RELEASE:d,to_luastring:h}=n(5);e.exports.luaopen_fengari=function(e){return l(e,{}),a(e,s),u(e,-2,h("AUTHORS")),a(e,o),u(e,-2,h("COPYRIGHT")),a(e,i),u(e,-2,h("RELEASE")),a(e,c),u(e,-2,h("VERSION")),a(e,f),u(e,-2,h("VERSION_MAJOR")),a(e,_),u(e,-2,h("VERSION_MINOR")),r(e,p),u(e,-2,h("VERSION_NUM")),a(e,d),u(e,-2,h("VERSION_RELEASE")),1}},function(e,t,n){"use strict";n.r(t),n.d(t,"L",(function(){return N})),n.d(t,"load",(function(){return w}));var r=n(0);n.d(t,"FENGARI_AUTHORS",(function(){return r.FENGARI_AUTHORS})),n.d(t,"FENGARI_COPYRIGHT",(function(){return r.FENGARI_COPYRIGHT})),n.d(t,"FENGARI_RELEASE",(function(){return r.FENGARI_RELEASE})),n.d(t,"FENGARI_VERSION",(function(){return r.FENGARI_VERSION})),n.d(t,"FENGARI_VERSION_MAJOR",(function(){return r.FENGARI_VERSION_MAJOR})),n.d(t,"FENGARI_VERSION_MINOR",(function(){return r.FENGARI_VERSION_MINOR})),n.d(t,"FENGARI_VERSION_NUM",(function(){return r.FENGARI_VERSION_NUM})),n.d(t,"FENGARI_VERSION_RELEASE",(function(){return r.FENGARI_VERSION_RELEASE})),n.d(t,"luastring_eq",(function(){return r.luastring_eq})),n.d(t,"luastring_indexOf",(function(){return r.luastring_indexOf})),n.d(t,"luastring_of",(function(){return r.luastring_of})),n.d(t,"to_jsstring",(function(){return r.to_jsstring})),n.d(t,"to_luastring",(function(){return r.to_luastring})),n.d(t,"to_uristring",(function(){return r.to_uristring})),n.d(t,"lua",(function(){return r.lua})),n.d(t,"lauxlib",(function(){return r.lauxlib})),n.d(t,"lualib",(function(){return r.lualib}));var a=n(21);n.d(t,"interop",(function(){return a}));const{LUA_ERRRUN:u,LUA_ERRSYNTAX:l,LUA_OK:s,LUA_VERSION_MAJOR:o,LUA_VERSION_MINOR:i,lua_Debug:c,lua_getinfo:f,lua_getstack:_,lua_gettop:p,lua_insert:d,lua_pcall:h,lua_pop:L,lua_pushcfunction:g,lua_pushstring:A,lua_remove:T,lua_setglobal:b,lua_tojsstring:x}=r.lua,{luaL_loadbuffer:O,luaL_newstate:k,luaL_requiref:v}=r.lauxlib,{checkjs:E,luaopen_js:m,push:R,tojs:U}=a,N=k();function w(e,t){if("string"==typeof e)e=Object(r.to_luastring)(e);else if(!(e instanceof Uint8Array))throw new TypeError("expects an array of bytes or javascript string");t=t?Object(r.to_luastring)(t):null;let n,a=O(N,e,null,t);if(n=a===l?new SyntaxError(x(N,-1)):U(N,-1),L(N,1),a!==s)throw n;return n}if(r.lualib.luaL_openlibs(N),v(N,Object(r.to_luastring)("js"),m,1),L(N,1),A(N,Object(r.to_luastring)(r.FENGARI_COPYRIGHT)),b(N,Object(r.to_luastring)("_COPYRIGHT")),"undefined"!=typeof document&&document instanceof HTMLDocument){const e=function(e){switch(e){case"anonymous":return"omit";case"use-credentials":return"include";default:return"same-origin"}},t=function(e){let t=new c;return _(e,2,t)&&f(e,Object(r.to_luastring)("Sl"),t),R(e,new ErrorEvent("error",{bubbles:!0,cancelable:!0,message:x(e,1),error:U(e,1),filename:t.short_src?Object(r.to_jsstring)(t.short_src):void 0,lineno:t.currentline>0?t.currentline:void 0})),1},n=function(e,n,r){let a,o=O(N,n,null,r);if(o===l){let t,n=x(N,-1),r=e.src?e.src:document.location,u=new SyntaxError(n,r,t);a=new ErrorEvent("error",{message:n,error:u,filename:r,lineno:t})}else if(o===s){let n=p(N);g(N,t),d(N,n),Object.defineProperty(document,"currentScript",{value:e,configurable:!0}),o=h(N,0,0,n),delete document.currentScript,T(N,n),o===u&&(a=E(N,-1))}o!==s&&(void 0===a&&(a=new ErrorEvent("error",{message:x(N,-1),error:U(N,-1)})),L(N,1),window.dispatchEvent(a)&&console.error("uncaught exception",a.error))},a=function(e,t,a){if(e.status>=200&&e.status<300){let u=e.response;u="string"==typeof u?Object(r.to_luastring)(e.response):new Uint8Array(u),n(t,u,a)}else t.dispatchEvent(new Event("error"))},A=function(t){if(t.src){let u=Object(r.to_luastring)("@"+t.src);if("complete"===document.readyState||t.async)if("function"==typeof fetch)fetch(t.src,{method:"GET",credentials:e(t.crossorigin),redirect:"follow",integrity:t.integrity}).then((function(e){if(e.ok)return e.arrayBuffer();throw new Error("unable to fetch")})).then((function(e){let r=new Uint8Array(e);n(t,r,u)})).catch((function(e){t.dispatchEvent(new Event("error"))}));else{let e=new XMLHttpRequest;e.open("GET",t.src,!0),e.responseType="arraybuffer",e.onreadystatechange=function(){4===e.readyState&&a(e,t,u)},e.send()}else{let e=new XMLHttpRequest;e.open("GET",t.src,!1),e.send(),a(e,t,u)}}else{let e=Object(r.to_luastring)(t.innerHTML),a=t.id?Object(r.to_luastring)("="+t.id):e;n(t,e,a)}},b=/^(.*?\/.*?)([\t ]*;.*)?$/,k=/^(\d+)\.(\d+)$/,v=function(e){if("SCRIPT"!==e.tagName)return;let t=b.exec(e.type);if(!t)return;let n=t[1];if("application/lua"===n||"text/lua"===n){if(e.hasAttribute("lua-version")){let t=k.exec(e.getAttribute("lua-version"));if(!t||t[1]!==o||t[2]!==i)return}A(e)}};"undefined"!=typeof MutationObserver?new MutationObserver((function(e,t){for(let n=0;n<e.length;n++){let t=e[n];for(let e=0;e<t.addedNodes.length;e++)v(t.addedNodes[e])}})).observe(document,{childList:!0,subtree:!0}):console.warn&&console.warn("fengari-web: MutationObserver not found; lua script tags will not be run when inserted");const m='script[type^="application/lua"], script[type^="text/lua"]';Array.prototype.forEach.call(document.querySelectorAll(m),v)}},function(e,t,n){"use strict";const{LUA_MULTRET:r,LUA_OPADD:a,LUA_OPBAND:u,LUA_OPBNOT:l,LUA_OPBOR:s,LUA_OPBXOR:o,LUA_OPDIV:i,LUA_OPIDIV:c,LUA_OPMOD:f,LUA_OPSHL:_,LUA_OPSHR:p,LUA_OPUNM:d,constant_types:{LUA_TBOOLEAN:h,LUA_TLIGHTUSERDATA:L,LUA_TLNGSTR:g,LUA_TNIL:A,LUA_TNUMFLT:T,LUA_TNUMINT:b,LUA_TTABLE:x},to_luastring:O}=n(1),{lua_assert:k}=n(4),v=n(20),E=n(6),m=n(16),R=n(23),U=n(9),N=n(15),w=m.OpCodesI,S=E.TValue,y={OPR_ADD:0,OPR_SUB:1,OPR_MUL:2,OPR_MOD:3,OPR_POW:4,OPR_DIV:5,OPR_IDIV:6,OPR_BAND:7,OPR_BOR:8,OPR_BXOR:9,OPR_SHL:10,OPR_SHR:11,OPR_CONCAT:12,OPR_EQ:13,OPR_LT:14,OPR_LE:15,OPR_NE:16,OPR_GT:17,OPR_GE:18,OPR_AND:19,OPR_OR:20,OPR_NOBINOPR:21},I={OPR_MINUS:0,OPR_BNOT:1,OPR_NOT:2,OPR_LEN:3,OPR_NOUNOPR:4},M=function(e){return e.t!==e.f},P=function(e,t){let n=R.expkind;if(M(e))return!1;switch(e.k){case n.VKINT:return!t||new S(b,e.u.ival);case n.VKFLT:return!t||new S(T,e.u.nval);default:return!1}},C=function(e,t,n){let r,a=t+n-1;if(e.pc>e.lasttarget&&(r=e.f.code[e.pc-1]).opcode===w.OP_LOADNIL){let e=r.A,n=e+r.B;if(e<=t&&t<=n+1||t<=e&&e<=a+1)return e<t&&(t=e),n>a&&(a=n),m.SETARG_A(r,t),void m.SETARG_B(r,a-t)}Q(e,w.OP_LOADNIL,t,n-1,0)},D=function(e,t){return e.f.code[t.u.info]},V=function(e,t){let n=e.f.code[t].sBx;return-1===n?-1:t+1+n},B=function(e,t,n){let r=e.f.code[t],a=n-(t+1);k(-1!==n),Math.abs(a)>m.MAXARG_sBx&&v.luaX_syntaxerror(e.ls,O("control structure too long",!0)),m.SETARG_sBx(r,a)},G=function(e,t,n){if(-1===n)return t;if(-1===t)t=n;else{let r=t,a=V(e,r);for(;-1!==a;)a=V(e,r=a);B(e,r,n)}return t},K=function(e){let t=e.jpc;e.jpc=-1;let n=ee(e,w.OP_JMP,0,-1);return G(e,n,t)},j=function(e,t,n,r,a){return Q(e,t,n,r,a),K(e)},F=function(e){return e.lasttarget=e.pc,e.pc},H=function(e,t){return t>=1&&m.testTMode(e.f.code[t-1].opcode)?t-1:t},X=function(e,t){return e.f.code[H(e,t)]},z=function(e,t,n){let r=H(e,t),a=e.f.code[r];return a.opcode===w.OP_TESTSET&&(n!==m.NO_REG&&n!==a.B?m.SETARG_A(a,n):e.f.code[r]=m.CREATE_ABC(w.OP_TEST,a.B,0,a.C),!0)},Y=function(e,t){for(;-1!==t;t=V(e,t))z(e,t,m.NO_REG)},J=function(e,t,n,r,a){for(;-1!==t;){let u=V(e,t);z(e,t,r)?B(e,t,n):B(e,t,a),t=u}},q=function(e,t){F(e),e.jpc=G(e,e.jpc,t)},Z=function(e,t,n){n===e.pc?q(e,t):(k(n<e.pc),J(e,t,n,m.NO_REG,n))},W=function(e,t){let n=e.f;return function(e){J(e,e.jpc,e.pc,m.NO_REG,e.pc),e.jpc=-1}(e),n.code[e.pc]=t,n.lineinfo[e.pc]=e.ls.lastline,e.pc++},Q=function(e,t,n,r,a){return k(m.getOpMode(t)===m.iABC),k(m.getBMode(t)!==m.OpArgN||0===r),k(m.getCMode(t)!==m.OpArgN||0===a),k(n<=m.MAXARG_A&&r<=m.MAXARG_B&&a<=m.MAXARG_C),W(e,m.CREATE_ABC(t,n,r,a))},$=function(e,t,n,r){return k(m.getOpMode(t)===m.iABx||m.getOpMode(t)===m.iAsBx),k(m.getCMode(t)===m.OpArgN),k(n<=m.MAXARG_A&&r<=m.MAXARG_Bx),W(e,m.CREATE_ABx(t,n,r))},ee=function(e,t,n,r){return $(e,t,n,r+m.MAXARG_sBx)},te=function(e,t){return k(t<=m.MAXARG_Ax),W(e,m.CREATE_Ax(w.OP_EXTRAARG,t))},ne=function(e,t,n){if(n<=m.MAXARG_Bx)return $(e,w.OP_LOADK,t,n);{let r=$(e,w.OP_LOADKX,t,0);return te(e,n),r}},re=function(e,t){let n=e.freereg+t;n>e.f.maxstacksize&&(n>=255&&v.luaX_syntaxerror(e.ls,O("function or expression needs too many registers",!0)),e.f.maxstacksize=n)},ae=function(e,t){re(e,t),e.freereg+=t},ue=function(e,t){!m.ISK(t)&&t>=e.nactvar&&(e.freereg--,k(t===e.freereg))},le=function(e,t){t.k===R.expkind.VNONRELOC&&ue(e,t.u.info)},se=function(e,t,n){let r=t.k===R.expkind.VNONRELOC?t.u.info:-1,a=n.k===R.expkind.VNONRELOC?n.u.info:-1;r>a?(ue(e,r),ue(e,a)):(ue(e,a),ue(e,r))},oe=function(e,t,n){let r=e.f,a=U.luaH_get(e.L,e.ls.h,t);if(a.ttisinteger()){let t=a.value;if(t<e.nk&&r.k[t].ttype()===n.ttype()&&r.k[t].value===n.value)return t}let u=e.nk;return U.luaH_setfrom(e.L,e.ls.h,t,new E.TValue(b,u)),r.k[u]=n,e.nk++,u},ie=function(e,t){let n=new S(L,t),r=new S(b,t);return oe(e,n,r)},ce=function(e,t){let n=new S(T,t);return oe(e,n,n)},fe=function(e,t){let n=new S(h,t);return oe(e,n,n)},_e=function(e,t,n){let a=R.expkind;if(t.k===a.VCALL)m.SETARG_C(D(e,t),n+1);else if(t.k===a.VVARARG){let r=D(e,t);m.SETARG_B(r,n+1),m.SETARG_A(r,e.freereg),ae(e,1)}else k(n===r)},pe=function(e,t){let n=R.expkind;t.k===n.VCALL?(k(2===D(e,t).C),t.k=n.VNONRELOC,t.u.info=D(e,t).A):t.k===n.VVARARG&&(m.SETARG_B(D(e,t),2),t.k=n.VRELOCABLE)},de=function(e,t){let n=R.expkind;switch(t.k){case n.VLOCAL:t.k=n.VNONRELOC;break;case n.VUPVAL:t.u.info=Q(e,w.OP_GETUPVAL,0,t.u.info,0),t.k=n.VRELOCABLE;break;case n.VINDEXED:{let r;ue(e,t.u.ind.idx),t.u.ind.vt===n.VLOCAL?(ue(e,t.u.ind.t),r=w.OP_GETTABLE):(k(t.u.ind.vt===n.VUPVAL),r=w.OP_GETTABUP),t.u.info=Q(e,r,0,t.u.ind.t,t.u.ind.idx),t.k=n.VRELOCABLE;break}case n.VVARARG:case n.VCALL:pe(e,t)}},he=function(e,t,n,r){return F(e),Q(e,w.OP_LOADBOOL,t,n,r)},Le=function(e,t,n){let r=R.expkind;switch(de(e,t),t.k){case r.VNIL:C(e,n,1);break;case r.VFALSE:case r.VTRUE:Q(e,w.OP_LOADBOOL,n,t.k===r.VTRUE,0);break;case r.VK:ne(e,n,t.u.info);break;case r.VKFLT:ne(e,n,ce(e,t.u.nval));break;case r.VKINT:ne(e,n,ie(e,t.u.ival));break;case r.VRELOCABLE:{let r=D(e,t);m.SETARG_A(r,n);break}case r.VNONRELOC:n!==t.u.info&&Q(e,w.OP_MOVE,n,t.u.info,0);break;default:return void k(t.k===r.VJMP)}t.u.info=n,t.k=r.VNONRELOC},ge=function(e,t){t.k!==R.expkind.VNONRELOC&&(ae(e,1),Le(e,t,e.freereg-1))},Ae=function(e,t){for(;-1!==t;t=V(e,t))if(X(e,t).opcode!==w.OP_TESTSET)return!0;return!1},Te=function(e,t,n){let r=R.expkind;if(Le(e,t,n),t.k===r.VJMP&&(t.t=G(e,t.t,t.u.info)),M(t)){let a,u=-1,l=-1;if(Ae(e,t.t)||Ae(e,t.f)){let a=t.k===r.VJMP?-1:K(e);u=he(e,n,0,1),l=he(e,n,1,0),q(e,a)}a=F(e),J(e,t.f,a,n,u),J(e,t.t,a,n,l)}t.f=t.t=-1,t.u.info=n,t.k=r.VNONRELOC},be=function(e,t){de(e,t),le(e,t),ae(e,1),Te(e,t,e.freereg-1)},xe=function(e,t){if(de(e,t),t.k===R.expkind.VNONRELOC){if(!M(t))return t.u.info;if(t.u.info>=e.nactvar)return Te(e,t,t.u.info),t.u.info}return be(e,t),t.u.info},Oe=function(e,t){M(t)?xe(e,t):de(e,t)},ke=function(e,t){let n=R.expkind,r=!1;switch(Oe(e,t),t.k){case n.VTRUE:t.u.info=fe(e,!0),r=!0;break;case n.VFALSE:t.u.info=fe(e,!1),r=!0;break;case n.VNIL:t.u.info=function(e){let t=new S(A,null),n=new S(x,e.ls.h);return oe(e,n,t)}(e),r=!0;break;case n.VKINT:t.u.info=ie(e,t.u.ival),r=!0;break;case n.VKFLT:t.u.info=ce(e,t.u.nval),r=!0;break;case n.VK:r=!0}return r&&(t.k=n.VK,t.u.info<=m.MAXINDEXRK)?m.RKASK(t.u.info):xe(e,t)},ve=function(e,t){let n=X(e,t.u.info);k(m.testTMode(n.opcode)&&n.opcode!==w.OP_TESTSET&&n.opcode!==w.OP_TEST),m.SETARG_A(n,!n.A)},Ee=function(e,t,n){if(t.k===R.expkind.VRELOCABLE){let r=D(e,t);if(r.opcode===w.OP_NOT)return e.pc--,j(e,w.OP_TEST,r.B,0,!n)}return ge(e,t),le(e,t),j(e,w.OP_TESTSET,m.NO_REG,t.u.info,n)},me=function(e,t){let n,r=R.expkind;switch(de(e,t),t.k){case r.VJMP:ve(e,t),n=t.u.info;break;case r.VK:case r.VKFLT:case r.VKINT:case r.VTRUE:n=-1;break;default:n=Ee(e,t,0)}t.f=G(e,t.f,n),q(e,t.t),t.t=-1},Re=function(e,t){let n,r=R.expkind;switch(de(e,t),t.k){case r.VJMP:n=t.u.info;break;case r.VNIL:case r.VFALSE:n=-1;break;default:n=Ee(e,t,1)}t.t=G(e,t.t,n),q(e,t.f),t.f=-1},Ue=function(e,t,n){let r,a,d=R.expkind;if(!(r=P(t,!0))||!(a=P(n,!0))||!function(e,t,n){switch(e){case u:case s:case o:case _:case p:case l:return!1!==N.tointeger(t)&&!1!==N.tointeger(n);case i:case c:case f:return 0!==n.value;default:return 1}}(e,r,a))return 0;let h=new S;if(E.luaO_arith(null,e,r,a,h),h.ttisinteger())t.k=d.VKINT,t.u.ival=h.value;else{let e=h.value;if(isNaN(e)||0===e)return!1;t.k=d.VKFLT,t.u.nval=e}return!0},Ne=function(e,t,n,r,a){let u=ke(e,r),l=ke(e,n);se(e,n,r),n.u.info=Q(e,t,0,l,u),n.k=R.expkind.VRELOCABLE,we(e,a)},we=function(e,t){e.f.lineinfo[e.pc-1]=t};e.exports.BinOpr=y,e.exports.NO_JUMP=-1,e.exports.UnOpr=I,e.exports.getinstruction=D,e.exports.luaK_checkstack=re,e.exports.luaK_code=W,e.exports.luaK_codeABC=Q,e.exports.luaK_codeABx=$,e.exports.luaK_codeAsBx=ee,e.exports.luaK_codek=ne,e.exports.luaK_concat=G,e.exports.luaK_dischargevars=de,e.exports.luaK_exp2RK=ke,e.exports.luaK_exp2anyreg=xe,e.exports.luaK_exp2anyregup=function(e,t){(t.k!==R.expkind.VUPVAL||M(t))&&xe(e,t)},e.exports.luaK_exp2nextreg=be,e.exports.luaK_exp2val=Oe,e.exports.luaK_fixline=we,e.exports.luaK_getlabel=F,e.exports.luaK_goiffalse=Re,e.exports.luaK_goiftrue=me,e.exports.luaK_indexed=function(e,t,n){let r=R.expkind;k(!M(t)&&(R.vkisinreg(t.k)||t.k===r.VUPVAL)),t.u.ind.t=t.u.info,t.u.ind.idx=ke(e,n),t.u.ind.vt=t.k===r.VUPVAL?r.VUPVAL:r.VLOCAL,t.k=r.VINDEXED},e.exports.luaK_infix=function(e,t,n){switch(t){case y.OPR_AND:me(e,n);break;case y.OPR_OR:Re(e,n);break;case y.OPR_CONCAT:be(e,n);break;case y.OPR_ADD:case y.OPR_SUB:case y.OPR_MUL:case y.OPR_DIV:case y.OPR_IDIV:case y.OPR_MOD:case y.OPR_POW:case y.OPR_BAND:case y.OPR_BOR:case y.OPR_BXOR:case y.OPR_SHL:case y.OPR_SHR:P(n,!1)||ke(e,n);break;default:ke(e,n)}},e.exports.luaK_intK=ie,e.exports.luaK_jump=K,e.exports.luaK_jumpto=function(e,t){return Z(e,K(e),t)},e.exports.luaK_nil=C,e.exports.luaK_numberK=ce,e.exports.luaK_patchclose=function(e,t,n){for(n++;-1!==t;t=V(e,t)){let r=e.f.code[t];k(r.opcode===w.OP_JMP&&(0===r.A||r.A>=n)),m.SETARG_A(r,n)}},e.exports.luaK_patchlist=Z,e.exports.luaK_patchtohere=q,e.exports.luaK_posfix=function(e,t,n,r,u){let l=R.expkind;switch(t){case y.OPR_AND:k(-1===n.t),de(e,r),r.f=G(e,r.f,n.f),n.to(r);break;case y.OPR_OR:k(-1===n.f),de(e,r),r.t=G(e,r.t,n.t),n.to(r);break;case y.OPR_CONCAT:{Oe(e,r);let t=D(e,r);r.k===l.VRELOCABLE&&t.opcode===w.OP_CONCAT?(k(n.u.info===t.B-1),le(e,n),m.SETARG_B(t,n.u.info),n.k=l.VRELOCABLE,n.u.info=r.u.info):(be(e,r),Ne(e,w.OP_CONCAT,n,r,u));break}case y.OPR_ADD:case y.OPR_SUB:case y.OPR_MUL:case y.OPR_DIV:case y.OPR_IDIV:case y.OPR_MOD:case y.OPR_POW:case y.OPR_BAND:case y.OPR_BOR:case y.OPR_BXOR:case y.OPR_SHL:case y.OPR_SHR:Ue(t+a,n,r)||Ne(e,t+w.OP_ADD,n,r,u);break;case y.OPR_EQ:case y.OPR_LT:case y.OPR_LE:case y.OPR_NE:case y.OPR_GT:case y.OPR_GE:!function(e,t,n,r){let a,u=R.expkind;n.k===u.VK?a=m.RKASK(n.u.info):(k(n.k===u.VNONRELOC),a=n.u.info);let l=ke(e,r);switch(se(e,n,r),t){case y.OPR_NE:n.u.info=j(e,w.OP_EQ,0,a,l);break;case y.OPR_GT:case y.OPR_GE:{let r=t-y.OPR_NE+w.OP_EQ;n.u.info=j(e,r,1,l,a);break}default:{let r=t-y.OPR_EQ+w.OP_EQ;n.u.info=j(e,r,1,a,l);break}}n.k=u.VJMP}(e,t,n,r)}return n},e.exports.luaK_prefix=function(e,t,n,r){let a=new R.expdesc;switch(a.k=R.expkind.VKINT,a.u.ival=a.u.nval=a.u.info=0,a.t=-1,a.f=-1,t){case I.OPR_MINUS:case I.OPR_BNOT:if(Ue(t+d,n,a))break;case I.OPR_LEN:!function(e,t,n,r){let a=xe(e,n);le(e,n),n.u.info=Q(e,t,0,a,0),n.k=R.expkind.VRELOCABLE,we(e,r)}(e,t+w.OP_UNM,n,r);break;case I.OPR_NOT:!function(e,t){let n=R.expkind;switch(de(e,t),t.k){case n.VNIL:case n.VFALSE:t.k=n.VTRUE;break;case n.VK:case n.VKFLT:case n.VKINT:case n.VTRUE:t.k=n.VFALSE;break;case n.VJMP:ve(e,t);break;case n.VRELOCABLE:case n.VNONRELOC:ge(e,t),le(e,t),t.u.info=Q(e,w.OP_NOT,0,t.u.info,0),t.k=n.VRELOCABLE}{let e=t.f;t.f=t.t,t.t=e}Y(e,t.f),Y(e,t.t)}(e,n)}},e.exports.luaK_reserveregs=ae,e.exports.luaK_ret=function(e,t,n){Q(e,w.OP_RETURN,t,n+1,0)},e.exports.luaK_self=function(e,t,n){xe(e,t);let r=t.u.info;le(e,t),t.u.info=e.freereg,t.k=R.expkind.VNONRELOC,ae(e,2),Q(e,w.OP_SELF,t.u.info,r,ke(e,n)),le(e,n)},e.exports.luaK_setlist=function(e,t,n,a){let u=(n-1)/m.LFIELDS_PER_FLUSH+1,l=a===r?0:a;k(0!==a&&a<=m.LFIELDS_PER_FLUSH),u<=m.MAXARG_C?Q(e,w.OP_SETLIST,t,l,u):u<=m.MAXARG_Ax?(Q(e,w.OP_SETLIST,t,l,0),te(e,u)):v.luaX_syntaxerror(e.ls,O("constructor too long",!0)),e.freereg=t+1},e.exports.luaK_setmultret=function(e,t){_e(e,t,r)},e.exports.luaK_setoneret=pe,e.exports.luaK_setreturns=_e,e.exports.luaK_storevar=function(e,t,n){let r=R.expkind;switch(t.k){case r.VLOCAL:return le(e,n),void Te(e,n,t.u.info);case r.VUPVAL:{let r=xe(e,n);Q(e,w.OP_SETUPVAL,r,t.u.info,0);break}case r.VINDEXED:{let a=t.u.ind.vt===r.VLOCAL?w.OP_SETTABLE:w.OP_SETTABUP,u=ke(e,n);Q(e,a,t.u.ind.t,t.u.ind.idx,u);break}}le(e,n)},e.exports.luaK_stringK=function(e,t){let n=new S(g,t);return oe(e,n,n)}},function(e,t,n){"use strict";const{LUA_SIGNATURE:r,constant_types:{LUA_TBOOLEAN:a,LUA_TLNGSTR:u,LUA_TNIL:l,LUA_TNUMFLT:s,LUA_TNUMINT:o,LUA_TSHRSTR:i},thread_status:{LUA_ERRSYNTAX:c},is_luastring:f,luastring_eq:_,to_luastring:p}=n(1),d=n(8),h=n(13),L=n(6),{MAXARG_sBx:g,POS_A:A,POS_Ax:T,POS_B:b,POS_Bx:x,POS_C:O,POS_OP:k,SIZE_A:v,SIZE_Ax:E,SIZE_B:m,SIZE_Bx:R,SIZE_C:U,SIZE_OP:N}=n(16),{lua_assert:w}=n(4),{luaS_bless:S}=n(10),{luaZ_read:y,ZIO:I}=n(19);let M=[25,147,13,10,26,10];class P{constructor(e,t,n){this.intSize=4,this.size_tSize=4,this.instructionSize=4,this.integerSize=4,this.numberSize=8,w(t instanceof I,"BytecodeParser only operates on a ZIO"),w(f(n)),64===n[0]||61===n[0]?this.name=n.subarray(1):n[0]==r[0]?this.name=p("binary string",!0):this.name=n,this.L=e,this.Z=t,this.arraybuffer=new ArrayBuffer(Math.max(this.intSize,this.size_tSize,this.instructionSize,this.integerSize,this.numberSize)),this.dv=new DataView(this.arraybuffer),this.u8=new Uint8Array(this.arraybuffer)}read(e){let t=new Uint8Array(e);return 0!==y(this.Z,t,0,e)&&this.error("truncated"),t}LoadByte(){return 0!==y(this.Z,this.u8,0,1)&&this.error("truncated"),this.u8[0]}LoadInt(){return 0!==y(this.Z,this.u8,0,this.intSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadNumber(){return 0!==y(this.Z,this.u8,0,this.numberSize)&&this.error("truncated"),this.dv.getFloat64(0,!0)}LoadInteger(){return 0!==y(this.Z,this.u8,0,this.integerSize)&&this.error("truncated"),this.dv.getInt32(0,!0)}LoadSize_t(){return this.LoadInteger()}LoadString(){let e=this.LoadByte();return 255===e&&(e=this.LoadSize_t()),0===e?null:S(this.L,this.read(e-1))}static MASK1(e,t){return~(-1<<e)<<t}LoadCode(e){let t=this.LoadInt(),n=P;for(let r=0;r<t;r++){0!==y(this.Z,this.u8,0,this.instructionSize)&&this.error("truncated");let t=this.dv.getUint32(0,!0);e.code[r]={code:t,opcode:t>>k&n.MASK1(N,0),A:t>>A&n.MASK1(v,0),B:t>>b&n.MASK1(m,0),C:t>>O&n.MASK1(U,0),Bx:t>>x&n.MASK1(R,0),Ax:t>>T&n.MASK1(E,0),sBx:(t>>x&n.MASK1(R,0))-g}}}LoadConstants(e){let t=this.LoadInt();for(let n=0;n<t;n++){let t=this.LoadByte();switch(t){case l:e.k.push(new L.TValue(l,null));break;case a:e.k.push(new L.TValue(a,0!==this.LoadByte()));break;case s:e.k.push(new L.TValue(s,this.LoadNumber()));break;case o:e.k.push(new L.TValue(o,this.LoadInteger()));break;case i:case u:e.k.push(new L.TValue(u,this.LoadString()));break;default:this.error(`unrecognized constant '${t}'`)}}}LoadProtos(e){let t=this.LoadInt();for(let n=0;n<t;n++)e.p[n]=new h.Proto(this.L),this.LoadFunction(e.p[n],e.source)}LoadUpvalues(e){let t=this.LoadInt();for(let n=0;n<t;n++)e.upvalues[n]={name:null,instack:this.LoadByte(),idx:this.LoadByte()}}LoadDebug(e){let t=this.LoadInt();for(let n=0;n<t;n++)e.lineinfo[n]=this.LoadInt();t=this.LoadInt();for(let n=0;n<t;n++)e.locvars[n]={varname:this.LoadString(),startpc:this.LoadInt(),endpc:this.LoadInt()};t=this.LoadInt();for(let n=0;n<t;n++)e.upvalues[n].name=this.LoadString()}LoadFunction(e,t){e.source=this.LoadString(),null===e.source&&(e.source=t),e.linedefined=this.LoadInt(),e.lastlinedefined=this.LoadInt(),e.numparams=this.LoadByte(),e.is_vararg=0!==this.LoadByte(),e.maxstacksize=this.LoadByte(),this.LoadCode(e),this.LoadConstants(e),this.LoadUpvalues(e),this.LoadProtos(e),this.LoadDebug(e)}checkliteral(e,t){let n=this.read(e.length);_(n,e)||this.error(t)}checkHeader(){this.checkliteral(r.subarray(1),"not a"),83!==this.LoadByte()&&this.error("version mismatch in"),0!==this.LoadByte()&&this.error("format mismatch in"),this.checkliteral(M,"corrupted"),this.intSize=this.LoadByte(),this.size_tSize=this.LoadByte(),this.instructionSize=this.LoadByte(),this.integerSize=this.LoadByte(),this.numberSize=this.LoadByte(),this.checksize(this.intSize,4,"int"),this.checksize(this.size_tSize,4,"size_t"),this.checksize(this.instructionSize,4,"instruction"),this.checksize(this.integerSize,4,"integer"),this.checksize(this.numberSize,8,"number"),22136!==this.LoadInteger()&&this.error("endianness mismatch in"),370.5!==this.LoadNumber()&&this.error("float format mismatch in")}error(e){L.luaO_pushfstring(this.L,p("%s: %s precompiled chunk"),this.name,p(e)),d.luaD_throw(this.L,c)}checksize(e,t,n){e!==t&&this.error(`${n} size mismatch in`)}}e.exports.luaU_undump=function(e,t,n){let r=new P(e,t,n);r.checkHeader();let a=h.luaF_newLclosure(e,r.LoadByte());return d.luaD_inctop(e),e.stack[e.top-1].setclLvalue(a),a.p=new h.Proto(e),r.LoadFunction(a.p,null),w(a.nupvalues===a.p.upvalues.length),a}},function(e,t,n){"use strict";const{LUA_SIGNATURE:r,LUA_VERSION_MAJOR:a,LUA_VERSION_MINOR:u,constant_types:{LUA_TBOOLEAN:l,LUA_TLNGSTR:s,LUA_TNIL:o,LUA_TNUMFLT:i,LUA_TNUMINT:c,LUA_TSHRSTR:f},luastring_of:_}=n(1),p=_(25,147,13,10,26,10),d=16*Number(a)+Number(u),h=function(e,t,n){0===n.status&&t>0&&(n.status=n.writer(n.L,e,t,n.data))},L=function(e,t){h(_(e),1,t)},g=function(e,t){let n=new ArrayBuffer(4);new DataView(n).setInt32(0,e,!0);let r=new Uint8Array(n);h(r,4,t)},A=function(e,t){let n=new ArrayBuffer(4);new DataView(n).setInt32(0,e,!0);let r=new Uint8Array(n);h(r,4,t)},T=function(e,t){let n=new ArrayBuffer(8);new DataView(n).setFloat64(0,e,!0);let r=new Uint8Array(n);h(r,8,t)},b=function(e,t){if(null===e)L(0,t);else{let n=e.tsslen()+1,r=e.getstr();n<255?L(n,t):(L(255,t),A(n,t)),h(r,n-1,t)}},x=function(e,t,n){n.strip||e.source===t?b(null,n):b(e.source,n),g(e.linedefined,n),g(e.lastlinedefined,n),L(e.numparams,n),L(e.is_vararg?1:0,n),L(e.maxstacksize,n),function(e,t){let n=e.code.map((e=>e.code));g(n.length,t);for(let r=0;r<n.length;r++)g(n[r],t)}(e,n),function(e,t){let n=e.k.length;g(n,t);for(let r=0;r<n;r++){let n=e.k[r];switch(L(n.ttype(),t),n.ttype()){case o:break;case l:L(n.value?1:0,t);break;case i:T(n.value,t);break;case c:A(n.value,t);break;case f:case s:b(n.tsvalue(),t)}}}(e,n),function(e,t){let n=e.upvalues.length;g(n,t);for(let r=0;r<n;r++)L(e.upvalues[r].instack?1:0,t),L(e.upvalues[r].idx,t)}(e,n),function(e,t){let n=e.p.length;g(n,t);for(let r=0;r<n;r++)x(e.p[r],e.source,t)}(e,n),function(e,t){let n=t.strip?0:e.lineinfo.length;g(n,t);for(let r=0;r<n;r++)g(e.lineinfo[r],t);n=t.strip?0:e.locvars.length,g(n,t);for(let r=0;r<n;r++)b(e.locvars[r].varname,t),g(e.locvars[r].startpc,t),g(e.locvars[r].endpc,t);n=t.strip?0:e.upvalues.length,g(n,t);for(let r=0;r<n;r++)b(e.upvalues[r].name,t)}(e,n)};e.exports.luaU_dump=function(e,t,n,a,u){let l=new class{constructor(){this.L=null,this.write=null,this.data=null,this.strip=NaN,this.status=NaN}};return l.L=e,l.writer=n,l.data=a,l.strip=u,l.status=0,function(e){h(r,r.length,e),L(d,e),L(0,e),h(p,p.length,e),L(4,e),L(4,e),L(4,e),L(4,e),L(8,e),A(22136,e),T(370.5,e)}(l),L(t.upvalues.length,l),x(t,null,l),l.status}},function(e,t,n){var r;!function(){"use strict";var a={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function u(e){return function(e,t){var n,r,l,s,o,i,c,f,_,p=1,d=e.length,h="";for(r=0;r<d;r++)if("string"==typeof e[r])h+=e[r];else if(Array.isArray(e[r])){if((s=e[r])[2])for(n=t[p],l=0;l<s[2].length;l++){if(!n.hasOwnProperty(s[2][l]))throw new Error(u('[sprintf] property "%s" does not exist',s[2][l]));n=n[s[2][l]]}else n=s[1]?t[s[1]]:t[p++];if(a.not_type.test(s[8])&&a.not_primitive.test(s[8])&&n instanceof Function&&(n=n()),a.numeric_arg.test(s[8])&&"number"!=typeof n&&isNaN(n))throw new TypeError(u("[sprintf] expecting number but found %T",n));switch(a.number.test(s[8])&&(f=n>=0),s[8]){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,s[6]?parseInt(s[6]):0);break;case"e":n=s[7]?parseFloat(n).toExponential(s[7]):parseFloat(n).toExponential();break;case"f":n=s[7]?parseFloat(n).toFixed(s[7]):parseFloat(n);break;case"g":n=s[7]?String(Number(n.toPrecision(s[7]))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=s[7]?n.substring(0,s[7]):n;break;case"t":n=String(!!n),n=s[7]?n.substring(0,s[7]):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=s[7]?n.substring(0,s[7]):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=s[7]?n.substring(0,s[7]):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}a.json.test(s[8])?h+=n:(!a.number.test(s[8])||f&&!s[3]?_="":(_=f?"+":"-",n=n.toString().replace(a.sign,"")),i=s[4]?"0"===s[4]?"0":s[4].charAt(1):" ",c=s[6]-(_+n).length,o=s[6]&&c>0?i.repeat(c):"",h+=s[5]?_+n+o:"0"===i?_+o+n:o+_+n)}return h}(function(e){if(s[e])return s[e];for(var t,n=e,r=[],u=0;n;){if(null!==(t=a.text.exec(n)))r.push(t[0]);else if(null!==(t=a.modulo.exec(n)))r.push("%");else{if(null===(t=a.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){u|=1;var l=[],o=t[2],i=[];if(null===(i=a.key.exec(o)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(l.push(i[1]);""!==(o=o.substring(i[0].length));)if(null!==(i=a.key_access.exec(o)))l.push(i[1]);else{if(null===(i=a.index_access.exec(o)))throw new SyntaxError("[sprintf] failed to parse named argument key");l.push(i[1])}t[2]=l}else u|=2;if(3===u)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");r.push(t)}n=n.substring(t[0].length)}return s[e]=r}(e),arguments)}function l(e,t){return u.apply(null,[e].concat(t||[]))}var s=Object.create(null);t.sprintf=u,t.vsprintf=l,"undefined"!=typeof window&&(window.sprintf=u,window.vsprintf=l,void 0===(r=function(){return{sprintf:u,vsprintf:l}}.call(t,n,t,e))||(e.exports=r))}()},function(e,t,n){"use strict";const{lua_pop:r}=n(2),{luaL_requiref:a}=n(7),{to_luastring:u}=n(5),l={};e.exports.luaL_openlibs=function(e){for(let t in l)a(e,u(t),l[t],1),r(e,1)};const s=n(17),{luaopen_base:o}=n(24),{luaopen_coroutine:i}=n(25),{luaopen_debug:c}=n(31),{luaopen_math:f}=n(30),{luaopen_package:_}=n(32),{luaopen_os:p}=n(27),{luaopen_string:d}=n(28),{luaopen_table:h}=n(26),{luaopen_utf8:L}=n(29);l._G=o,l[s.LUA_LOADLIBNAME]=_,l[s.LUA_COLIBNAME]=i,l[s.LUA_TABLIBNAME]=h,l[s.LUA_OSLIBNAME]=p,l[s.LUA_STRLIBNAME]=d,l[s.LUA_MATHLIBNAME]=f,l[s.LUA_UTF8LIBNAME]=L,l[s.LUA_DBLIBNAME]=c;const{luaopen_fengari:g}=n(33);l[s.LUA_FENGARILIBNAME]=g}])}}]);